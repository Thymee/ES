/*! cornerstone-tools - 1.1.3 - 2018-02-08 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/cornerstoneTools */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstoneTools",[],t):"object"==typeof exports?exports.cornerstoneTools=t():e.cornerstoneTools=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(a){if(o[a])return o[a].exports;var n=o[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,a){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=65)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=window.cornerstone,n=window.cornerstoneMath,r=window.$,l=window.Hammer;t.default={set cornerstone(e){a=e},get cornerstone(){return a},set cornerstoneMath(e){n=e},get cornerstoneMath(){return n},set $(e){r=e},get $(){return r},set Hammer(e){l=e},get Hammer(){return l}}},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=c.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=f.globalImageIdSpecificToolStateManager),t.toolStateManager}function r(e,t,o){n(e).add(e,t,o);var a={toolType:t,element:e,measurementData:o};(0,v.default)(e,"CornerstoneToolsMeasurementAdded",a)}function l(e,t){return n(e).get(e,t)}function i(e,t,o){for(var a=n(e),r=a.get(e,t),l=-1,i=0;i<r.data.length;i++)r.data[i]===o&&(l=i);if(-1!==l){r.data.splice(l,1);var u={toolType:t,element:e,measurementData:o};(0,v.default)(e,"CornerstoneToolsMeasurementRemoved",u)}}function u(e,t){var o=n(e),a=o.get(e,t);void 0!==a&&(a.data=[])}function s(e,t){c.default.cornerstone.getEnabledElement(e).toolStateManager=t}Object.defineProperty(t,"__esModule",{value:!0}),t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=void 0;var d=o(0),c=a(d),f=o(17),g=o(3),v=a(g);t.addToolState=r,t.getToolState=l,t.removeToolState=i,t.clearToolState=u,t.setElementToolStateManager=s,t.getElementToolStateManager=n},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return 0!=(t&1<<e-1)}},function(e,t,o){"use strict";function a(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=void 0;"function"==typeof window.CustomEvent?a=new CustomEvent(t.toLocaleLowerCase(),{detail:o,cancelable:!0}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(t.toLocaleLowerCase(),!0,!0,o));var n=r.default.$.Event(t,o);return r.default.$(e).trigger(n,o),!n.isImmediatePropagationStopped()&&e.dispatchEvent(a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,o){"use strict";function a(e){f=e}function n(){return f}function r(e){d=e}function l(){return d}function i(e){c=e}function u(){return c}function s(e){return e?c:d}Object.defineProperty(t,"__esModule",{value:!0});var d="white",c="greenyellow",f="transparent",g={setFillColor:a,getFillColor:n,setToolColor:r,getToolColor:l,setActiveColor:i,getActiveColor:u,getColorIfActive:s};t.default=g},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r,l){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var i=n.default.getFont(),u=n.default.getFontSize(),s=n.default.getBackgroundColor();e.save(),e.font=i,e.textBaseline="top",e.strokeStyle=r;var d=0;t.forEach(function(t){var o=e.measureText(t).width;d=Math.max(d,o)}),e.fillStyle=s;var c={width:d+10,height:5+t.length*(u+5)};return l&&l.centering&&!0===l.centering.x&&(o-=c.width/2),l&&l.centering&&!0===l.centering.y&&(a-=c.height/2),c.left=o,c.top=a,l&&!0===l.debug&&(e.fillStyle="#FF0000"),e.fillRect(c.left,c.top,c.width,c.height),t.forEach(function(t,n){e.fillStyle=r,e.fillText(t,o+5,a+5+n*(u+5))}),e.restore(),c};var a=o(16),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){i=e}function n(){return i}function r(e){u=e}function l(){return u}Object.defineProperty(t,"__esModule",{value:!0});var i=1,u=2,s={setToolWidth:a,getToolWidth:n,setActiveWidth:r,getActiveWidth:l};t.default=s},function(e,t,o){"use strict";function a(e){s=e}function n(){return s}function r(e){d=e}function l(){return d}function i(e){c=e}function u(){return c}Object.defineProperty(t,"__esModule",{value:!0});var s=void 0,d=void 0,c=void 0,f={setStartLoadHandler:a,getStartLoadHandler:n,setEndLoadHandler:r,getEndLoadHandler:l,setErrorLoadingHandler:i,getErrorLoadingHandler:u};t.default=f},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){var l=r.default.cornerstone,i=t.element,u=e.createNewMeasurement(t);if(u){var s={mouseButtonMask:t.which};(0,b.addToolState)(t.element,e.toolType,u),r.default.$(i).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),r.default.$(i).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),r.default.$(i).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&r.default.$(i).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),l.updateImage(i);var d=void 0;d=1===Object.keys(u.handles).length?g.default:m.default;var c=void 0;c=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,d(t,e.toolType,u,u.handles.end,function(){u.active=!1,u.invalidated=!0,(0,C.default)(t,u.handles)&&(0,b.removeToolState)(i,e.toolType,u),r.default.$(i).on("CornerstoneToolsMouseMove",s,e.mouseMoveCallback||a),r.default.$(i).on("CornerstoneToolsMouseDown",s,e.mouseDownCallback||n),r.default.$(i).on("CornerstoneToolsMouseDownActivate",s,e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&r.default.$(i).on("CornerstoneToolsMouseDoubleClick",s,e.mouseDoubleClickCallback),l.updateImage(i)},c)}}function o(o,a){if((0,M.default)(a.which,o.data.mouseButtonMask))return e.addNewMeasurement?e.addNewMeasurement(a):t(a),!1}function a(t,o){if(i.default.setCoords(o),0===o.which){var a=(0,b.getToolState)(o.element,e.toolType);if(a){for(var n=!1,l=0;l<a.data.length;l++){var u=o.currentPoints.canvas,s=a.data[l];!0===(0,c.default)(o.element,s.handles,u)&&(n=!0),(e.pointNearTool(o.element,s,u)&&!s.active||!e.pointNearTool(o.element,s,u)&&s.active)&&(s.active=!s.active,n=!0)}!0===n&&r.default.cornerstone.updateImage(o.element)}}}function n(t,o){function n(){l.invalidated=!0,(0,C.default)(o,l.handles)&&(0,b.removeToolState)(i,e.toolType,l),r.default.cornerstone.updateImage(i),r.default.$(i).on("CornerstoneToolsMouseMove",o,e.mouseMoveCallback||a)}var l=void 0,i=o.element;if((0,M.default)(o.which,t.data.mouseButtonMask)){var u=o.startPoints.canvas,d=(0,b.getToolState)(t.currentTarget,e.toolType);if(d){var c=void 0,f=void 0;for(f=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,c=0;c<d.data.length;c++){l=d.data[c];var v=(0,s.default)(i,l.handles,u,6);if(v)return r.default.$(i).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),l.active=!0,(0,g.default)(o,e.toolType,l,v,n,f),t.stopImmediatePropagation(),!1}if(e.pointNearTool){var m=e.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(c=0;c<d.data.length;c++)if(l=d.data[c],l.active=!1,e.pointNearTool(i,l,u))return l.active=!0,r.default.$(i).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),(0,p.default)(t,l,d,e.toolType,m,n),t.stopImmediatePropagation(),!1}}}}function l(t){t.removeEventListener("cornerstoneimagerendered",u),r.default.$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),r.default.$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),r.default.$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&r.default.$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),r.default.cornerstone.updateImage(t)}function u(t){e.onImageRendered(t,t.detail)}function d(t){t.removeEventListener("cornerstoneimagerendered",u),r.default.$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),r.default.$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),r.default.$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&r.default.$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),t.addEventListener("cornerstoneimagerendered",u),r.default.cornerstone.updateImage(t)}function f(t,l){var i={mouseButtonMask:l};t.removeEventListener("cornerstoneimagerendered",u),r.default.$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),r.default.$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),r.default.$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),t.addEventListener("cornerstoneimagerendered",u),r.default.$(t).on("CornerstoneToolsMouseMove",i,e.mouseMoveCallback||a),r.default.$(t).on("CornerstoneToolsMouseDown",i,e.mouseDownCallback||n),r.default.$(t).on("CornerstoneToolsMouseDownActivate",i,e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&(r.default.$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),r.default.$(t).on("CornerstoneToolsMouseDoubleClick",i,e.mouseDoubleClickCallback)),r.default.cornerstone.updateImage(t)}function v(t,l){var i={mouseButtonMask:l},s="CornerstoneToolsToolDeactivated",d={mouseButtonMask:l,toolType:e.toolType,type:s};(0,P.default)(t,s,d),t.removeEventListener("cornerstoneimagerendered",u),r.default.$(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),r.default.$(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),r.default.$(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),t.addEventListener("cornerstoneimagerendered",u),r.default.$(t).on("CornerstoneToolsMouseMove",i,e.mouseMoveCallback||a),r.default.$(t).on("CornerstoneToolsMouseDown",i,e.mouseDownCallback||n),e.mouseDoubleClickCallback&&(r.default.$(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),r.default.$(t).on("CornerstoneToolsMouseDoubleClick",i,e.mouseDoubleClickCallback)),e.deactivate&&e.deactivate(t,l),r.default.cornerstone.updateImage(t)}function h(){return y}function T(e){y=e}var y={},x={enable:d,disable:l,activate:f,deactivate:v,getConfiguration:h,setConfiguration:T,mouseDownCallback:n,mouseMoveCallback:a,mouseDownActivateCallback:o};return e.pointNearTool&&(x.pointNearTool=e.pointNearTool),e.mouseDoubleClickCallback&&(x.mouseDoubleClickCallback=e.mouseDoubleClickCallback),e.addNewMeasurement&&(x.addNewMeasurement=e.addNewMeasurement),x};var n=o(0),r=a(n),l=o(36),i=a(l),u=o(20),s=a(u),d=o(37),c=a(d),f=o(24),g=a(f),v=o(25),m=a(v),h=o(38),p=a(h),T=o(14),C=a(T),y=o(2),M=a(y),b=o(1),x=o(3),P=a(x)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n){e.strokeStyle=a,Object.keys(o).forEach(function(a){var l=o[a];if(!0!==l.drawnIndependently&&(!n||!0!==n.drawHandlesIfActive||l.active)){e.beginPath(),l.active?e.lineWidth=i.default.getActiveWidth():e.lineWidth=i.default.getToolWidth();var s=r.default.cornerstone.pixelToCanvas(t.element,l);e.arc(s.x,s.y,u,0,2*Math.PI),n&&n.fill&&(e.fillStyle=n.fill,e.fill()),e.stroke()}})};var n=o(0),r=a(n),l=o(6),i=a(l),u=6},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.boundingBox)return n.default.cornerstoneMath.point.insideRect(t,e.boundingBox)};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){Object.keys(e).forEach(function(t){e[t].active=!1})}function r(e){if(e)for(var t=0;t<e.data.length;t++){var o=e.data[t];o.active=!1,o.handles&&n(o.handles)}}function l(e){function t(t){var r=u.default.cornerstone,l=t.element,i=e.createNewMeasurement(t);if(i){if((0,C.addToolState)(l,e.toolType,i),1===Object.keys(i.handles).length&&"CornerstoneToolsTap"===t.type)return i.active=!1,i.handles.end.active=!1,i.handles.end.highlight=!1,i.invalidated=!0,(0,d.default)(t,i.handles)&&(0,C.removeToolState)(l,e.toolType,i),void r.updateImage(l);u.default.$(l).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),u.default.$(l).off("CornerstoneToolsTap",e.tapCallback||a),u.default.$(l).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),r.updateImage(l),(0,h.default)(t,e.toolType,i,i.handles.end,function(){i.active=!1,i.invalidated=!0,(0,d.default)(t,i.handles)&&(0,C.removeToolState)(l,e.toolType,i),u.default.$(l).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),u.default.$(l).on("CornerstoneToolsTap",e.tapCallback||a),u.default.$(l).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),r.updateImage(l)})}}function o(o,a){e.addNewMeasurement?e.addNewMeasurement(a):t(a),o.stopImmediatePropagation(),o.preventDefault()}function a(t,l){function i(){r(m),(0,d.default)(l,h.handles)&&(0,C.removeToolState)(c,e.toolType,h),s.updateImage(c),u.default.$(c).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(c).on("CornerstoneToolsTap",e.tapCallback||a)}var s=u.default.cornerstone,c=l.element,g=l.currentPoints.canvas,m=(0,C.getToolState)(t.currentTarget,e.toolType),h=void 0,p=void 0;if(r(m),m)for(p=0;p<m.data.length;p++){h=m.data[p];var y=(0,f.default)(c,h.handles,g,25);if(y)return u.default.$(c).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(c).off("CornerstoneToolsTap",e.tapCallback||a),h.active=!0,y.active=!0,s.updateImage(c),(0,v.default)(t,e.toolType,h,y,i),t.stopImmediatePropagation(),void t.preventDefault()}if(m&&e.pointNearTool)for(p=0;p<m.data.length;p++)if(h=m.data[p],e.pointNearTool(c,h,g))return u.default.$(c).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(c).off("CornerstoneToolsTap",e.tapCallback||a),h.active=!0,s.updateImage(c),(0,T.default)(t,h,m,e.toolType,!0,i),t.stopImmediatePropagation(),void t.preventDefault();return e.touchDownActivateCallback?e.touchDownActivateCallback(t,l):o(t,l),!1}function n(t,o){function r(t,r){c.active=!1,c.invalidated=!0,(0,d.default)(o,c.handles)&&(0,C.removeToolState)(o.element,e.toolType,c),l.updateImage(o.element),u.default.$(i).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(i).on("CornerstoneToolsTap",e.tapCallback||a),e.pressCallback&&u.default.$(i).on("CornerstoneToolsTouchPress",e.pressCallback),t&&"CornerstoneToolsTouchPress"===t.type&&(0,M.default)(i,t.type,r)}var l=u.default.cornerstone,i=o.element,s=o.startPoints.canvas,c=void 0,g=(0,C.getToolState)(t.currentTarget,e.toolType),m=void 0;if(g){for(m=0;m<g.data.length;m++){c=g.data[m];var h=(0,f.default)(o.element,c.handles,s,28);if(h)return u.default.$(i).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(i).off("CornerstoneToolsTap",e.tapCallback||a),e.pressCallback&&u.default.$(i).off("CornerstoneToolsTouchPress",e.pressCallback),c.active=!0,(0,v.default)(t,e.toolType,c,h,r),t.stopImmediatePropagation(),void t.preventDefault()}if(e.pointNearTool)for(m=0;m<g.data.length;m++)if(c=g.data[m],e.pointNearTool(o.element,c,s))return u.default.$(i).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(i).off("CornerstoneToolsTap",e.tapCallback||a),e.pressCallback&&u.default.$(i).off("CornerstoneToolsTouchPress",e.pressCallback),(0,T.default)(t,c,g,e.toolType,!0,r),t.stopImmediatePropagation(),void t.preventDefault()}}function l(t){t.removeEventListener("cornerstoneimagerendered",c),u.default.$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),u.default.$(t).off("CornerstoneToolsTap",e.tapCallback||a),e.doubleTapCallback&&u.default.$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&u.default.$(t).off("CornerstoneToolsTouchPress",e.pressCallback),u.default.cornerstone.updateImage(t)}function i(t){t.removeEventListener("cornerstoneimagerendered",c),u.default.$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),u.default.$(t).off("CornerstoneToolsTap",e.tapCallback||a),t.addEventListener("cornerstoneimagerendered",c),e.doubleTapCallback&&u.default.$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&u.default.$(t).off("CornerstoneToolsTouchPress",e.pressCallback),u.default.cornerstone.updateImage(t)}function s(t){t.removeEventListener("cornerstoneimagerendered",c),u.default.$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),u.default.$(t).off("CornerstoneToolsTap",e.tapCallback||a),t.addEventListener("cornerstoneimagerendered",c),u.default.$(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(t).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),u.default.$(t).on("CornerstoneToolsTap",e.tapCallback||a),e.doubleTapCallback&&(u.default.$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),u.default.$(t).on("CornerstoneToolsDoubleTap",e.doubleTapCallback)),e.pressCallback&&(u.default.$(t).off("CornerstoneToolsTouchPress",e.pressCallback),u.default.$(t).on("CornerstoneToolsTouchPress",e.pressCallback)),u.default.cornerstone.updateImage(t)}function c(t){e.onImageRendered(t,t.detail)}function g(t){var r="CornerstoneToolsToolDeactivated",l={toolType:e.toolType,type:r};(0,M.default)(t,r,l),t.removeEventListener("cornerstoneimagerendered",c),u.default.$(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),u.default.$(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),u.default.$(t).off("CornerstoneToolsTap",e.tapCallback||a),t.addEventListener("cornerstoneimagerendered",c),u.default.$(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),e.doubleTapCallback&&u.default.$(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&u.default.$(t).off("CornerstoneToolsTouchPress",e.pressCallback),u.default.cornerstone.updateImage(t)}var m={enable:i,disable:l,activate:s,deactivate:g,touchStartCallback:e.touchStartCallback||n,touchDownActivateCallback:e.touchDownActivateCallback||o,tapCallback:e.tapCallback||a};return e.pointNearTool&&(m.pointNearTool=e.pointNearTool),e.doubleTapCallback&&(m.doubleTapCallback=e.doubleTapCallback),e.pressCallback&&(m.pressCallback=e.pressCallback),e.addNewMeasurement&&(m.addNewMeasurement=e.addNewMeasurement),m}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=a(i),s=o(14),d=a(s),c=o(20),f=a(c),g=o(57),v=a(g),m=o(27),h=a(m),p=o(56),T=a(p),C=o(1),y=o(3),M=a(y);t.default=l},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o="CornerstoneToolsTouchDrag";return t&&!0===t.fireOnTouchStart&&(o+=" CornerstoneToolsTouchStart"),{activate:function(a){n.default.$(a).off(o,e),t&&t.eventData?n.default.$(a).on(o,t.eventData,e):n.default.$(a).on(o,e),t&&t.activateCallback&&t.activateCallback(a)},disable:function(a){n.default.$(a).off(o,e),t&&t.disableCallback&&t.disableCallback(a)},enable:function(a){n.default.$(a).off(o,e),t&&t.enableCallback&&t.enableCallback(a)},deactivate:function(a){n.default.$(a).off(o,e),t&&t.deactivateCallback&&t.deactivateCallback(a)}}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t,o,a){n.default.$(t).off("CornerstoneToolsMouseDownActivate",e);var r={mouseButtonMask:o,options:a};n.default.$(t).on("CornerstoneToolsMouseDownActivate",r,e)},disable:function(t){n.default.$(t).off("CornerstoneToolsMouseDownActivate",e)},enable:function(t){n.default.$(t).off("CornerstoneToolsMouseDownActivate",e)},deactivate:function(t){n.default.$(t).off("CornerstoneToolsMouseDownActivate",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=e.image,a={left:0,top:0,width:o.width,height:o.height},r=!1;return Object.keys(t).forEach(function(e){var o=t[e];!0!==o.allowedOutsideImage&&!1===n.default.cornerstoneMath.point.insideRect(o,a)&&(r=!0)}),r};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){var t=r.default.cornerstoneMath;return e instanceof t.Vector3?e:new t.Vector3(e[0],e[1],e[2])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,o){"use strict";function a(e){d=e}function n(){return d}function r(e){s=e}function l(){return s}function i(e){c=e}function u(){return c}Object.defineProperty(t,"__esModule",{value:!0});var s=15,d=s+"px Arial",c="transparent",f={setFont:a,getFont:n,setFontSize:r,getFontSize:l,setBackgroundColor:i,getBackgroundColor:u};t.default=f},function(e,t,o){"use strict";function a(){function e(e){return u[e]}function t(e,t){u[e]=t}function o(){return u}function a(e){u=e}function n(e,t,o){var a=r.default.cornerstone.getEnabledElement(e);a.image&&!1!==u.hasOwnProperty(a.image.imageId)||(u[a.image.imageId]={});var n=u[a.image.imageId];!1===n.hasOwnProperty(t)&&(n[t]={data:[]}),n[t].data.push(o)}function l(e,t){var o=r.default.cornerstone.getEnabledElement(e);if(o.image&&!1!==u.hasOwnProperty(o.image.imageId)){var a=u[o.image.imageId];if(!1!==a.hasOwnProperty(t)){return a[t]}}}function i(e){var t=r.default.cornerstone.getEnabledElement(e);t.image&&!1!==u.hasOwnProperty(t.image.imageId)&&delete u[t.image.imageId]}var u={};return{get:l,add:n,clear:i,saveImageIdToolState:e,restoreImageIdToolState:t,saveToolState:o,restoreToolState:a,toolState:u}}Object.defineProperty(t,"__esModule",{value:!0}),t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=void 0;var n=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(n),l=a();t.newImageIdSpecificToolStateManager=a,t.globalImageIdSpecificToolStateManager=l},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){n.default.$(t).off("CornerstoneToolsMouseWheel",e);var o={};n.default.$(t).on("CornerstoneToolsMouseWheel",o,e)},disable:function(t){n.default.$(t).off("CornerstoneToolsMouseWheel",e)},enable:function(t){n.default.$(t).off("CornerstoneToolsMouseWheel",e)},deactivate:function(t){n.default.$(t).off("CornerstoneToolsMouseWheel",e)}}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return parseFloat("."+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=r.default.cornerstone,n=o.metaData.get("patientStudyModule",e.imageId),l=o.metaData.get("generalSeriesModule",e.imageId);if(n&&l){if("PT"===l.modality){var i=t*e.slope+e.intercept,u=n.patientWeight;if(u){var s=o.metaData.get("petIsotopeModule",e.imageId);if(s){var d=s.radiopharmaceuticalInfo,c=d.radiopharmaceuticalStartTime,f=d.radionuclideTotalDose,g=d.radionuclideHalfLife,v=l.seriesTime;if(c&&f&&g&&v){var m=a(v.fractionalSeconds||0)+v.seconds+60*v.minutes+60*v.hours*60,h=a(c.fractionalSeconds)+c.seconds+60*c.minutes+60*c.hours*60,p=m-h;return i*u/(f*Math.exp(-p*Math.log(2)/g))*1e3}}}}}};var n=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){var n=void 0;if(t)return Object.keys(t).forEach(function(l){var u=t[l];if(u.hasOwnProperty("pointNearHandle")){if(u.pointNearHandle(e,u,o))return void(n=u)}else if(!0===u.hasBoundingBox){if((0,i.default)(u,o))return void(n=u)}else{var s=r.default.cornerstone.pixelToCanvas(e,u),d=r.default.cornerstoneMath.point.distance(s,o);if(d<=a)return void(n=u)}}),n};var n=o(0),r=a(n),l=o(10),i=a(l)},function(e,t,o){"use strict";function a(e,t,o,a,n,r){if(!g.hasOwnProperty(o))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var l={type:o,imageId:t,preventCache:a,doneCallback:n,failCallback:r},i=c.default.cornerstone.imageCache.getImagePromise(t);if(i)return void i.then(function(e){n(e)},function(e){r(e)});g[o].push(l)}}function n(e){if(!g.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");g[e]=[]}function r(){h&&setTimeout(function(){i()},p)}function l(e){var t=c.default.cornerstone,o=e.type;v[o]++,h=!0;var a=e.imageId,n=e.doneCallback,l=e.failCallback,i=t.imageCache.getImagePromise(a);if(i)return void i.then(function(e){v[o]--,n(e),r()},function(e){v[o]--,l(e),r()});var u=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e),s=void 0;s=!0===e.preventCache?t.loadImage(a,{priority:u,type:e.type}):t.loadAndCacheImage(a,{priority:u,type:e.type}),s.then(function(e){v[o]--,n(e),r()},function(e){v[o]--,l(e),r()})}function i(){var e=(0,f.getMaxSimultaneousRequests)();m={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=v.interaction+v.thumbnail+v.prefetch,o=e-t,a=0;a<o;a++){var n=u();n&&l(n)}}function u(){return g.interaction.length&&v.interaction<m.interaction?g.interaction.shift():g.thumbnail.length&&v.thumbnail<m.thumbnail?g.thumbnail.shift():g.prefetch.length&&v.prefetch<m.prefetch?g.prefetch.shift():(g.interaction.length||g.thumbnail.length||g.prefetch.length||(h=!1),!1)}function s(){return g}Object.defineProperty(t,"__esModule",{value:!0});var d=o(0),c=function(e){return e&&e.__esModule?e:{default:e}}(d),f=o(22),g={interaction:[],thumbnail:[],prefetch:[]},v={interaction:0,thumbnail:0,prefetch:0},m={interaction:6,thumbnail:6,prefetch:5},h=!1,p=20;t.default={addRequest:a,clearRequestStack:n,startGrabbing:i,getRequestPool:s}},function(e,t,o){"use strict";function a(){var e=navigator.userAgent,t=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],o=void 0;return/trident/i.test(t[1])?(o=/\brv[ :]+(\d+)/g.exec(e)||[],"IE "+(o[1]||"")):"Chrome"===t[1]&&null!==(o=e.match(/\b(OPR|Edge)\/(\d+)/))?o.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(o=e.match(/version\/(\d+)/i))&&t.splice(1,1,o[1]),t.join(" "))}function n(e){u=e}function r(){return u||l()}function l(){var e=a(),t=e.split(" "),o=t[0],n=t[1],r=s[o];return r?r[n]?r[n]:r.default:s.default}function i(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}Object.defineProperty(t,"__esModule",{value:!0});var u=void 0,s={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};t.getDefaultSimultaneousRequests=l,t.getMaxSimultaneousRequests=r,t.setMaxSimultaneousRequests=n,t.getBrowserInfo=a,t.isMobileDevice=i},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o={},a="CornerstoneToolsMultiTouchDrag";return t&&!0===t.fireOnTouchStart&&(a+=" CornerstoneToolsMultiTouchStart"),{activate:function(o){n.default.$(o).off(a,e),t&&t.eventData?n.default.$(o).on(a,t.eventData,e):n.default.$(o).on(a,e),t&&t.activateCallback&&t.activateCallback(o)},disable:function(o){n.default.$(o).off(a,e),t&&t.disableCallback&&t.disableCallback(o)},enable:function(o){n.default.$(o).off(a,e),t&&t.enableCallback&&t.enableCallback(o)},deactivate:function(o){n.default.$(o).off(a,e),t&&t.deactivateCallback&&t.deactivateCallback(o)},getConfiguration:function(){return o},setConfiguration:function(e){o=e}}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n,l){function u(e,n){!1===a.hasMoved&&(a.hasMoved=!0),a.active=!0,a.x=n.currentPoints.image.x+f.x,a.y=n.currentPoints.image.y+f.y,l&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,n.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,n.image.height)),d.updateImage(c);var r={toolType:t,element:c,measurementData:o};(0,i.default)(c,"CornerstoneToolsMeasurementModified",r)}function s(){a.active=!1,r.default.$(c).off("CornerstoneToolsMouseDrag",u),r.default.$(c).off("CornerstoneToolsMouseUp",s),r.default.$(c).off("CornerstoneToolsMouseClick",s),d.updateImage(c),"function"==typeof n&&n()}var d=r.default.cornerstone,c=e.element,f={x:a.x-e.currentPoints.image.x,y:a.y-e.currentPoints.image.y};r.default.$(c).on("CornerstoneToolsMouseDrag",u),r.default.$(c).on("CornerstoneToolsMouseUp",s),r.default.$(c).on("CornerstoneToolsMouseClick",s)};var n=o(0),r=a(n),l=o(3),i=a(l)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n,l){function u(e,n){a.active=!0,a.x=n.currentPoints.image.x,a.y=n.currentPoints.image.y,l&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,n.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,n.image.height)),g.updateImage(v);var r={toolType:t,element:v,measurementData:o};(0,i.default)(v,"CornerstoneToolsMeasurementModified",r)}function s(e){r.default.$(v).off("CornerstoneToolsMouseMove",s),r.default.$(v).off("CornerstoneToolsMouseDrag",s),r.default.$(v).on("CornerstoneToolsMouseMove",u),r.default.$(v).on("CornerstoneToolsMouseDrag",u),r.default.$(v).on("CornerstoneToolsMouseClick",f),"CornerstoneToolsMouseDrag"===e.type&&r.default.$(v).on("CornerstoneToolsMouseUp",f)}function d(e,t){t.measurementData===o&&f()}function c(e,o){o.toolType===t&&(r.default.$(v).off("CornerstoneToolsMouseMove",u),r.default.$(v).off("CornerstoneToolsMouseDrag",u),r.default.$(v).off("CornerstoneToolsMouseClick",f),r.default.$(v).off("CornerstoneToolsMouseUp",f),r.default.$(v).off("CornerstoneToolsMeasurementRemoved",d),r.default.$(v).off("CornerstoneToolsToolDeactivated",c),a.active=!1,g.updateImage(v))}function f(){r.default.$(v).off("CornerstoneToolsMouseMove",u),r.default.$(v).off("CornerstoneToolsMouseDrag",u),r.default.$(v).off("CornerstoneToolsMouseClick",f),r.default.$(v).off("CornerstoneToolsMouseUp",f),r.default.$(v).off("CornerstoneToolsMeasurementRemoved",d),r.default.$(v).off("CornerstoneToolsToolDeactivated",c),a.active=!1,g.updateImage(v),"function"==typeof n&&n()}var g=r.default.cornerstone,v=e.element;r.default.$(v).on("CornerstoneToolsMouseDrag",s),r.default.$(v).on("CornerstoneToolsMouseMove",s),r.default.$(v).on("CornerstoneToolsMeasurementRemoved",d),r.default.$(v).on("CornerstoneToolsToolDeactivated",c)};var n=o(0),r=a(n),l=o(3),i=a(l)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){e(t,t.detail)}var o={};return{disable:function(e){e.removeEventListener("cornerstoneimagerendered",t)},enable:function(e){e.removeEventListener("cornerstoneimagerendered",t),e.addEventListener("cornerstoneimagerendered",t),n.default.cornerstone.updateImage(e)},getConfiguration:function(){return o},setConfiguration:function(e){o=e}}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n,l){function u(e,n){a.x=n.currentPoints.image.x+m.x,a.y=n.currentPoints.image.y+m.y,l&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,n.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,n.image.height)),f.updateImage(g);var r={toolType:t,element:g,measurementData:o};(0,i.default)(g,"CornerstoneToolsMeasurementModified",r)}function s(e,t){if(r.default.$(g).off("CornerstoneToolsTouchDrag",u),r.default.$(g).off("CornerstoneToolsTouchPinch",s),r.default.$(g).off("CornerstoneToolsTouchEnd",s),r.default.$(g).off("CornerstoneToolsTap",s),r.default.$(g).off("CornerstoneToolsTouchStart",d),r.default.$(g).off("CornerstoneToolsToolDeactivated",c),"CornerstoneToolsTouchPinch"===e.type||"CornerstoneToolsTouchPress"===e.type)return a.active=!1,f.updateImage(g),void n();a.active=!1,o.active=!1,a.x=t.currentPoints.image.x+m.x,a.y=t.currentPoints.image.y+m.y,l&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,t.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,t.image.height)),f.updateImage(g),"function"==typeof n&&n()}function d(e){return e.stopImmediatePropagation(),!1}function c(){r.default.$(g).off("CornerstoneToolsTouchDrag",u),r.default.$(g).off("CornerstoneToolsTouchPinch",s),r.default.$(g).off("CornerstoneToolsTouchEnd",s),r.default.$(g).off("CornerstoneToolsTap",s),r.default.$(g).off("CornerstoneToolsTouchStart",d),r.default.$(g).off("CornerstoneToolsToolDeactivated",c),a.active=!1,o.active=!1,a.x=e.currentPoints.image.x+m.x,a.y=e.currentPoints.image.y+m.y,l&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,e.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,e.image.height)),f.updateImage(g)}var f=r.default.cornerstone,g=e.element,v=f.pageToPixel(g,e.currentPoints.page.x,e.currentPoints.page.y+50),m={x:a.x-v.x,y:a.y-v.y};a.active=!0,o.active=!0,r.default.$(g).on("CornerstoneToolsTouchDrag",u),r.default.$(g).on("CornerstoneToolsTouchPinch",s),r.default.$(g).on("CornerstoneToolsTouchEnd",s),r.default.$(g).on("CornerstoneToolsTap",s),r.default.$(g).on("CornerstoneToolsTouchStart",d),r.default.$(g).on("CornerstoneToolsToolDeactivated",c)};var n=o(0),r=a(n),l=o(3),i=a(l)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=(0,f.default)(t.rowCosines),a=(0,f.default)(t.columnCosines),n=(0,f.default)(t.imagePositionPatient),r=e.clone().sub(n);return{x:o.dot(r)/t.columnPixelSpacing,y:a.dot(r)/t.rowPixelSpacing}}function r(e,t){var o=(0,f.default)(t.rowCosines),a=(0,f.default)(t.columnCosines),n=(0,f.default)(t.imagePositionPatient),r=o.clone().multiplyScalar(e.x);r.multiplyScalar(t.columnPixelSpacing);var l=a.clone().multiplyScalar(e.y);l.multiplyScalar(t.rowPixelSpacing);var i=r.add(l);return i.add(n),i}function l(e){var t=r({x:0,y:0},e),o=r({x:e.columns,y:0},e),a=r({x:0,y:e.rows},e),n=r({x:e.columns,y:e.rows},e);return{top:new d.default.cornerstoneMath.Line3(t,o),left:new d.default.cornerstoneMath.Line3(t,a),right:new d.default.cornerstoneMath.Line3(o,n),bottom:new d.default.cornerstoneMath.Line3(a,n)}}function i(e,t){var o=[];return Object.keys(t).forEach(function(a){var n=t[a],r=e.intersectLine(n);r&&o.push(r)}),o}function u(e,t){var o=(0,f.default)(e.rowCosines),a=(0,f.default)(e.columnCosines),n=(0,f.default)(e.imagePositionPatient),u=(0,f.default)(t.rowCosines),s=(0,f.default)(t.columnCosines),c=(0,f.default)(t.imagePositionPatient),g=o.clone().cross(a),v=new d.default.cornerstoneMath.Plane;v.setFromNormalAndCoplanarPoint(g,n);var m=u.clone().cross(s),h=new d.default.cornerstoneMath.Plane;h.setFromNormalAndCoplanarPoint(m,c);var p=h.clone().intersectPlane(v),T=p.origin,C=p.direction,y=r({x:t.columns,y:t.rows},t),M=c.distanceTo(y),b=new d.default.cornerstoneMath.Line3;b.start=T,b.end=T.clone().add(C.multiplyScalar(M));var x=l(t),P=i(b,x);if(2===P.length)return{start:P[0],end:P[1]}}Object.defineProperty(t,"__esModule",{value:!0}),t.projectPatientPointToImagePlane=n,t.imagePointToPatientPoint=r,t.planePlaneIntersection=u;var s=o(0),d=a(s),c=o(15),f=a(c)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){var n=r.default.cornerstone,l=n.getEnabledElement(o).image,u=n.getEnabledElement(a).image;if(l&&u){var d=n.metaData.get("imagePlaneModule",l.imageId),f=n.metaData.get("imagePlaneModule",u.imageId);if(d&&f&&d.rowCosines&&d.columnCosines&&d.imagePositionPatient&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&d.frameOfReferenceUID===f.frameOfReferenceUID){d.rowCosines=(0,g.default)(d.rowCosines),d.columnCosines=(0,g.default)(d.columnCosines),d.imagePositionPatient=(0,g.default)(d.imagePositionPatient),f.rowCosines=(0,g.default)(f.rowCosines),f.columnCosines=(0,g.default)(f.columnCosines),f.imagePositionPatient=(0,g.default)(f.imagePositionPatient);var v=d.rowCosines.clone().cross(d.columnCosines),p=f.rowCosines.clone().cross(f.columnCosines),T=v.angleTo(p);if(!((T=Math.abs(T))<.5)){var C=(0,i.default)(d,f);if(C){var y=n.pixelToCanvas(t.element,C.start),M=n.pixelToCanvas(t.element,C.end);if(y.x>M.x){var b=y;y=M,M=b}var x=s.default.getActiveColor(),P=c.default.getToolWidth(),w=e.getContext("2d"),S=e.width,I=e.height;if(void 0!==S&&void 0!==I&&null!==S&&null!==I&&0!==S&&0!==I){w.setTransform(1,0,0,1,0,0),y.x>=e.width&&(D.x=e.width-5),M.y<=0&&(D.y=5),y.x=Math.min(Math.max(y.x,5),e.width-5),y.y=Math.min(Math.max(y.y,5),e.height-5),M.x=Math.min(Math.max(M.x,5),e.width-5),M.y=Math.min(Math.max(M.y,5),e.height-5),w.save(),w.beginPath(),w.strokeStyle="red",w.lineWidth=P,w.moveTo(y.x,y.y),w.lineTo(M.x,M.y),w.stroke(),w.restore();var k=(0,h.getToolState)(a,"stack");if(void 0!==k&&void 0!==k.data&&0!==k.data.length){var $=k.data[0],_=$.currentImageIdIndex+1,O=String(_),D={x:M.x+3,y:M.y-3};D.x=Math.min(Math.max(D.x,5),e.width-20),D.y=Math.min(Math.max(D.y,5),e.height-20),w.fillStyle="red",(0,m.default)(w,O,D.x,D.y,x)}}}}}}};var n=o(0),r=a(n),l=o(40),i=a(l),u=o(4),s=a(u),d=o(6),c=a(d),f=o(15),g=a(f),v=o(5),m=a(v),h=o(1)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o=o||!1;var a=(0,r.getToolState)(e,"stack");if(a&&a.data&&a.data.length){var l=a.data[0],i=l.currentImageIdIndex+t;if(o){i%=l.imageIds.length}else i=Math.min(l.imageIds.length-1,i),i=Math.max(0,i);(0,n.default)(e,i)}};var a=o(43),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r=o(1)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=Math.pow(10,t);return Math.round(e*o)/o}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=e.width/2,a=e.height/2;if(o<=0||a<=0)return!1;var n={x:e.left+o,y:e.top+a},r={x:t.x-n.x,y:t.y-n.y};return r.x*r.x/(o*o)+r.y*r.y/(a*a)<=1}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),o=Math.round(o);var l=n.default.cornerstone.getEnabledElement(e),i=[],u=0,s=l.image.getPixelData(),d=void 0,c=void 0,f=void 0;if(l.image.color)for(c=0;c<r;c++)for(f=0;f<a;f++){d=4*((c+o)*l.image.columns+(f+t));var g=s[d],v=s[d+1],m=s[d+2],h=s[d+3];i[u++]=g,i[u++]=v,i[u++]=m,i[u++]=h}return i};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{page:n.default.cornerstoneMath.point.copy(e.page),image:n.default.cornerstoneMath.point.copy(e.image),client:n.default.cornerstoneMath.point.copy(e.client),canvas:n.default.cornerstoneMath.point.copy(e.canvas)}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){r=e.currentPoints.canvas}function n(){return r}Object.defineProperty(t,"__esModule",{value:!0});var r=void 0,l={setCoords:a,getCoords:n};t.default=l},function(e,t,o){"use strict";function a(e){var t=void 0;return Object.keys(e).forEach(function(o){var a=e[o];if(!0===a.active)return void(t=a)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n){n||(n=6);var l=a(t),i=(0,r.default)(e,t,o,n);return l!==i&&(void 0!==i&&(i.active=!0),void 0!==l&&(l.active=!1),!0)};var n=o(20),r=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n,l){function s(e,o){t.active=!0,Object.keys(t.handles).forEach(function(e){var a=t.handles[e];!0!==a.movesIndependently&&(a.x+=o.deltaPoints.image.x,a.y+=o.deltaPoints.image.y,!0===n.preventHandleOutsideImage&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,o.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,o.image.height)))}),f.updateImage(g);var r={toolType:a,element:g,measurementData:t};return(0,d.default)(g,"CornerstoneToolsMeasurementModified",r),!1}function c(e,o){t.invalidated=!0,r.default.$(g).off("CornerstoneToolsMouseDrag",s),r.default.$(g).off("CornerstoneToolsMouseUp",c),r.default.$(g).off("CornerstoneToolsMouseClick",c),!0===n.deleteIfHandleOutsideImage&&(0,i.default)(o,t.handles)&&(0,u.removeToolState)(g,a,t),f.updateImage(g),"function"==typeof l&&l()}var f=r.default.cornerstone,g=e.element;return r.default.$(g).on("CornerstoneToolsMouseDrag",s),r.default.$(g).on("CornerstoneToolsMouseUp",c),r.default.$(g).on("CornerstoneToolsMouseClick",c),!0};var n=o(0),r=a(n),l=o(14),i=a(l),u=o(1),s=o(3),d=a(s)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var a=(0,l.getToolState)(e,"timeSeries");if(a&&a.data&&a.data.length){var n=r.default.cornerstone,i=a.data[0],s=i.stacks[i.currentStackIndex],d=s.currentImageIdIndex,c=i.currentStackIndex+t;if(o?(c>=i.stacks.length&&(c=0),c<0&&(c=i.stacks.length-1)):(c=Math.min(i.stacks.length-1,c),c=Math.max(0,c)),c!==i.currentStackIndex){var f=n.getViewport(e),g=i.stacks[c],v=u.default.getStartLoadHandler(),m=u.default.getEndLoadHandler(),h=u.default.getErrorLoadingHandler();v&&v(e);var p=void 0;p=!0===g.preventCache?n.loadImage(g.imageIds[d]):n.loadAndCacheImage(g.imageIds[d]),p.then(function(t){i.currentImageIdIndex!==d&&(g.currentImageIdIndex=d,i.currentStackIndex=c,n.displayImage(e,t,f),m&&m(e,t))},function(t){var o=g.imageIds[d];h&&h(e,o,t)})}}};var n=o(0),r=a(n),l=o(1),i=o(7),u=a(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=(0,a.planePlaneIntersection)(e,t);if(o)return{start:(0,a.projectPatientPointToImagePlane)(o.start,e),end:(0,a.projectPatientPointToImagePlane)(o.end,e)}};var a=o(28)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(69),r=a(n),l=o(70),i=a(l),u={getOrientationString:r.default,invertOrientationString:i.default};t.default=u},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){return n.default.cornerstone.setToPixelCoordinateSystem(e,t,.1),{fontSize:o/e.viewport.scale/.1,lineHeight:o/e.viewport.scale/.1,fontScale:.1}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function o(o){if(v.currentImageIdIndex===t){try{i.getEnabledElement(e)}catch(e){return}s?(s.currentImageIdIndex=t,s.render(e,n.data)):i.displayImage(e,o),h&&h(e,o)}}function a(o){var a=v.imageIds[t];p&&p(e,a,o)}var n=(0,l.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var i=r.default.cornerstone,s=void 0;if(n.data.length>1){var f=(0,l.getToolState)(e,"stackRenderer");f&&f.data&&f.data.length&&(s=f.data[0])}var v=n.data[0];t<0&&(t+=v.imageIds.length);var m=d.default.getStartLoadHandler(),h=d.default.getEndLoadHandler(),p=d.default.getErrorLoadingHandler();if(t!==v.currentImageIdIndex){m&&m(e);var T={newImageIdIndex:t,direction:t-v.currentImageIdIndex};v.currentImageIdIndex=t;var C=v.imageIds[t],y=c.stackScroll.getConfiguration();if(y&&!0===y.retryLoadOnScroll){var M=i.imageCache.getImagePromise(C);M&&"rejected"===M.state()&&i.imageCache.removeImagePromise(C)}var b=Boolean(v.preventCache),x=void 0;x=b?i.loadImage(C):i.loadAndCacheImage(C),x.then(o,a),u.default.startGrabbing(),(0,g.default)(e,"CornerstoneStackScroll",T)}}};var n=o(0),r=a(n),l=o(1),i=o(21),u=a(i),s=o(7),d=a(s),c=o(44),f=o(3),g=a(f)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){d.default.$(t.element).off("CornerstoneToolsMouseDrag",i),d.default.$(t.element).off("CornerstoneToolsMouseUp",n),d.default.$(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask)){var o={deltaY:0};return d.default.$(t.element).on("CornerstoneToolsMouseDrag",o,i),d.default.$(t.element).on("CornerstoneToolsMouseUp",n),d.default.$(t.element).on("CornerstoneToolsMouseClick",n),e.stopImmediatePropagation(),!1}}function l(e,t){var o=-t.direction,a=P.getConfiguration(),n=!1;a&&a.loop&&(n=a.loop),(0,b.default)(t.element,o,n)}function i(e,t){var o=t.element,a=(0,x.getToolState)(o,"stack");if(a&&a.data&&a.data.length){var n=a.data[0],r=P.getConfiguration(),l=Math.max(2,d.default.$(o).height()/Math.max(n.imageIds.length,8));if(r&&r.stackScrollSpeed&&(l=r.stackScrollSpeed),e.data.deltaY=e.data.deltaY||0,e.data.deltaY+=t.deltaPoints.page.y,Math.abs(e.data.deltaY)>=l){var i=e.data.deltaY/l,u=Math.round(i),s=e.data.deltaY%l;e.data.deltaY=s,(0,b.default)(o,u)}return!1}}function u(e,t){var o=$.getConfiguration();o&&o.testPointers(t)&&i(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=void 0;var s=o(0),d=a(s),c=o(12),f=a(c),g=o(23),v=a(g),m=o(13),h=a(m),p=o(18),T=a(p),C=o(2),y=a(C),M=o(30),b=a(M),x=o(1),P=(0,h.default)(r),w=(0,T.default)(l),S={eventData:{deltaY:0}},I=(0,f.default)(i,S),k={testPointers:function(e){return e.numPointers>=3}},$=(0,v.default)(u,S);$.setConfiguration(k),t.stackScroll=P,t.stackScrollWheel=w,t.stackScrollTouchDrag=I,t.stackScrollMultiTouch=$},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function o(o){if(n(e).data("layoutIndex")===t){try{s.getEnabledElement(e)}catch(e){return}f?(n(e).data("layoutIndex",t),f.render(e,i.data)):s.displayImage(e,o),y&&y(e,o)}}function a(o){var a=h.imageIds[t];M&&M(e,a,o)}var n=r.default.$,i=(0,l.getToolState)(e,"stack");if(i&&i.data&&i.data.length){var s=r.default.cornerstone,f=void 0;if(i.data.length>1){var v=(0,l.getToolState)(e,"stackRenderer");v&&v.data&&v.data.length&&(f=v.data[0])}var h=i.data[0],T=n(e).data("layoutIndex"),C=d.default.getStartLoadHandler(),y=d.default.getEndLoadHandler(),M=d.default.getErrorLoadingHandler(),b=new m.default("CornerstoneStackScroll",p.default);if(t!==T){C&&C(e);var x={direction:t-T};n(e).data("layoutIndex",t),t=Math.min(Math.max(t,0),h.imageIds.length-1);var P=h.imageIds[t];n(e).parents(".imageViewer").find(".viewport").each(function(e,t){b.add(t)});var w=c.layoutStackScroll.getConfiguration();if(w&&!0===w.retryLoadOnScroll){var S=s.imageCache.getImagePromise(P);S&&"rejected"===S.state()&&s.imageCache.removeImagePromise(P)}var I=Boolean(h.preventCache),k=void 0;k=I?s.loadImage(P):s.loadAndCacheImage(P),k.then(o,a),u.default.startGrabbing(),(0,g.default)(e,"CornerstoneStackScroll",x)}}};var n=o(0),r=a(n),l=o(1),i=o(21),u=a(i),s=o(7),d=a(s),c=o(46),f=o(3),g=a(f),v=o(48),m=a(v),h=o(49),p=a(h)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){d.default.$(t.element).off("CornerstoneToolsMouseDrag",i),d.default.$(t.element).off("CornerstoneToolsMouseUp",n),d.default.$(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask)){var o={deltaY:0};return d.default.$(t.element).on("CornerstoneToolsMouseDrag",o,i),d.default.$(t.element).on("CornerstoneToolsMouseUp",n),d.default.$(t.element).on("CornerstoneToolsMouseClick",n),e.stopImmediatePropagation(),!1}}function l(e,t){var o=-t.direction,a=P.getConfiguration(),n=!1;a&&a.loop&&(n=a.loop),(0,b.default)(t.element,o,n)}function i(e,t){var o=t.element,a=(0,x.getToolState)(o,"stack");if(a&&a.data&&a.data.length){var n=a.data[0],r=P.getConfiguration(),l=Math.max(2,d.default.$(o).height()/Math.max(n.imageIds.length,8));if(r&&r.stackScrollSpeed&&(l=r.stackScrollSpeed),e.data.deltaY=e.data.deltaY||0,e.data.deltaY+=t.deltaPoints.page.y,Math.abs(e.data.deltaY)>=l){var i=e.data.deltaY/l,u=Math.round(i),s=e.data.deltaY%l;e.data.deltaY=s,(0,b.default)(o,u)}return!1}}function u(e,t){var o=I.getConfiguration();o&&o.testPointers(t)&&i(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.layoutStackScrollMultiTouch=t.layoutStackScrollTouchDrag=t.layoutStackScrollWheel=t.layoutStackScroll=void 0;var s=o(0),d=a(s),c=o(12),f=a(c),g=o(23),v=a(g),m=o(13),h=a(m),p=o(18),T=a(p),C=o(2),y=a(C),M=o(47),b=a(M),x=o(1),P=(0,h.default)(r),w=(0,T.default)(l),S={eventData:{deltaY:0}},I=(0,f.default)(i,S),k={testPointers:function(e){return e.numPointers>=3}},$=(0,v.default)(u,S);$.setConfiguration(k),t.layoutStackScroll=P,t.layoutStackScrollWheel=w,t.layoutStackScrollTouchDrag=I,t.layoutStackScrollMultiTouch=$},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){o=o||!1;var a=r.default.$,n=(0,u.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var l=n.data[0],s=void 0;if(s=a(e).data("layoutIndex")===a(e).data("imageIndex")&&t<0?a(e).data("layoutIndex"):a(e).data("layoutIndex")+t,o){s%=l.imageIds.length}else s=Math.min(l.imageIds.length-1,s),s=Math.max(0,s);(0,i.default)(e,s)}};var n=o(0),r=a(n),l=o(45),i=a(l),u=o(1)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){function o(e,t){d.length&&c.length&&(f=!0,c.forEach(function(o){var a=c.indexOf(o);if(-1!==a){var n=g.imageIds.targetElements[a],r=d.indexOf(e);if(-1!==r){var l=g.imageIds.sourceElements[r],i=void 0;l===n?i=0:void 0!==g.distances[l]&&(i=g.distances[l][n]),v(s,e,o,t,i)}}}),f=!1)}function a(e,t){!0!==f&&(r(e.currentTarget).data("mouseWheel",!0),o(e.currentTarget,t))}function n(e){var t=e.detail.element;s.remove(t)}var r=l.default.$,i=l.default.cornerstone,s=this,d=[],c=[],f=!1,g={},v=t;this.setHandler=function(e){v=e},this.getHandler=function(){return v},this.getDistances=function(){d.length&&c.length&&(g.distances={},g.imageIds={sourceElements:[],targetElements:[]},d.forEach(function(e){var t=i.getEnabledElement(e);if(t&&t.image){var o=t.image.imageId,a=i.metaData.get("imagePlaneModule",o);if(a&&a.imagePositionPatient){var n=(0,u.default)(a.imagePositionPatient);g.hasOwnProperty(t)||(g.distances[o]={},g.imageIds.sourceElements.push(o),c.forEach(function(t){var a=i.getEnabledElement(t);if(a&&a.image){var r=a.image.imageId;if(g.imageIds.targetElements.push(r),e!==t&&o!==r&&!g.distances[o].hasOwnProperty(r)){var l=i.metaData.get("imagePlaneModule",r);if(l&&l.imagePositionPatient){var s=(0,u.default)(l.imagePositionPatient);g.distances[o][r]=s.clone().sub(n)}}}}),Object.keys(g.distances[o]).length||delete g.distances[o])}}}))},this.addSource=function(t){-1===d.indexOf(t)&&(d.push(t),l.default.$(t).on(e,a),s.getDistances(),s.updateDisableHandlers())},this.addTarget=function(e){-1===c.indexOf(e)&&(c.push(e),s.getDistances(),v(s,e,e,0),s.updateDisableHandlers())},this.add=function(e){s.addSource(e),s.addTarget(e)},this.removeSource=function(t){var n=d.indexOf(t);-1!==n&&(d.splice(n,1),l.default.$(t).off(e,a),s.getDistances(),o(t),s.updateDisableHandlers())},this.removeTarget=function(e){var t=c.indexOf(e);-1!==t&&(c.splice(t,1),s.getDistances(),v(s,e,e,0),s.updateDisableHandlers())},this.remove=function(e){s.removeTarget(e),s.removeSource(e)},this.getSourceElements=function(){return d},this.getTargetElements=function(){return c},this.displayImage=function(e,t,o){f=!0,i.displayImage(e,t,o),f=!1},this.setViewport=function(e,t){f=!0,i.setViewport(e,t),f=!1},this.updateDisableHandlers=function(){l.default.$.unique(d.concat(c)).forEach(function(e){e.removeEventListener("cornerstoneelementdisabled",n),e.addEventListener("cornerstoneelementdisabled",n)})},this.destroy=function(){l.default.$.unique(d.concat(c)).forEach(function(e){s.remove(e)})}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),l=a(r),i=o(15),u=a(i);t.default=n},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){if(t!==o&&a&&a.direction){var n=r.default.$,i=r.default.cornerstone,s=(0,l.getToolState)(o,"stack"),d=s.data[0],c=n(o).data("layoutIndex"),f=c+a.direction,g=n(o).parent(),v=n(g).find(".overlay"),m=n(v[0]).find("div"),h=n(v[1]).find("div"),p=n(v[2]).find("div"),T=n(v[3]).find("div");if(f>d.imageIds.length-1){n(o).data("layoutIndex",f),n(o).hide(),v.text().length>0&&(m.hide(),h.hide(),p.hide(),T.hide());var C=n(o).parent().find(".overlay-text");C.length<1&&(C=n('<div class="overlay overlay-text">NO IMAGE</div>').appendTo(n(o).parent()).show());var y=n(o).parent().width()/2,M=n(o).parent().height()/2;return void C.css({top:M,left:y-C.width()/2})}if(n(o).show(),n(o).parent().find(".overlay-text").remove(),m.show(),h.show(),p.show(),T.show(),c!==f&&d.imageIds[f]){var b=u.default.getStartLoadHandler(),x=u.default.getEndLoadHandler(),P=u.default.getErrorLoadingHandler();b&&b(o);var w=void 0;w=!0===d.preventCache?i.loadImage(d.imageIds[f]):i.loadAndCacheImage(d.imageIds[f]),w.then(function(t){var a=i.getViewport(o);n(o).data("layoutIndex",f),e.displayImage(o,t,a),x&&x(o,t)},function(e){var t=d.imageIds[f];P&&P(o,t,e)})}}};var n=o(0),r=a(n),l=o(1),i=o(7),u=a(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),o=Math.round(o);var l=n.default.cornerstone.getEnabledElement(e),i=l.image,u=[],s=0,d=i.getPixelData(),c=void 0,f=void 0,g=void 0;if(i.color)for(f=0;f<r;f++)for(g=0;g<a;g++){c=4*((f+o)*i.columns+(g+t));var v=d[c],m=d[c+1],h=d[c+2];u[s++]=.2126*v+.7152*m+.0722*h}else for(f=0;f<r;f++)for(g=0;g<a;g++)c=(f+o)*i.columns+(g+t),u[s++]=d[c]*i.slope+i.intercept;return u};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n){var r=a/2*.5522848,l=n/2*.5522848,i=t+a,u=o+n,s=t+a/2,d=o+n/2;e.beginPath(),e.moveTo(t,d),e.bezierCurveTo(t,d-l,s-r,o,s,o),e.bezierCurveTo(s+r,o,i,d-l,i,d),e.bezierCurveTo(i,d+l,s+r,u,s,u),e.bezierCurveTo(s-r,u,t,d+l,t,d),e.closePath(),e.stroke()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){e.beginPath(),e.strokeStyle=o,e.lineWidth=a,e.arc(t.x,t.y,6,0,2*Math.PI),e.stroke()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n){var r=Math.atan2(o.y-t.y,o.x-t.x);e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(o.x,o.y),e.strokeStyle=a,e.lineWidth=n,e.stroke(),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(o.x-10*Math.cos(r-Math.PI/7),o.y-10*Math.sin(r-Math.PI/7)),e.lineTo(o.x-10*Math.cos(r+Math.PI/7),o.y-10*Math.sin(r+Math.PI/7)),e.lineTo(o.x,o.y),e.lineTo(o.x-10*Math.cos(r-Math.PI/7),o.y-10*Math.sin(r-Math.PI/7)),e.strokeStyle=a,e.lineWidth=n,e.stroke(),e.fillStyle=a,e.fill()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var o=0,a=0,r=0,l=0,i=t.top;i<t.top+t.height;i++)for(var u=t.left;u<t.left+t.width;u++){var s={x:u,y:i};(0,n.default)(t,s)&&(o+=e[l],a+=e[l]*e[l],r++),l++}if(0===r)return{count:r,mean:0,variance:0,stdDev:0};var d=o/r,c=a/r-d*d;return{count:r,mean:d,variance:c,stdDev:Math.sqrt(c)}};var a=o(32),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t){n.default.$(t).off("CornerstoneToolsKeyDown",e),n.default.$(t).on("CornerstoneToolsKeyDown",e)},disable:function(t){n.default.$(t).off("CornerstoneToolsKeyDown",e)},enable:function(t){n.default.$(t).off("CornerstoneToolsKeyDown",e)},deactivate:function(t){n.default.$(t).off("CornerstoneToolsKeyDown",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n,l){function s(e,o){t.active=!0,Object.keys(t.handles).forEach(function(e){var a=t.handles[e];!0!==a.movesIndependently&&(a.x+=o.deltaPoints.image.x,a.y+=o.deltaPoints.image.y)}),g.updateImage(f);var n={toolType:a,element:f,measurementData:t};return(0,d.default)(f,"CornerstoneToolsMeasurementModified",n),!1}function c(e,o){t.active=!1,t.invalidated=!1,r.default.$(f).off("CornerstoneToolsTouchDrag",s),r.default.$(f).off("CornerstoneToolsTouchPinch",c),r.default.$(f).off("CornerstoneToolsTouchPress",c),r.default.$(f).off("CornerstoneToolsTouchEnd",c),r.default.$(f).off("CornerstoneToolsDragEnd",c),r.default.$(f).off("CornerstoneToolsTap",c),!0===n&&(0,i.default)(o,t.handles)&&(0,u.removeToolState)(f,a,t),g.updateImage(f),"function"==typeof l&&l(e,o)}var f=e.element,g=r.default.cornerstone;return r.default.$(f).on("CornerstoneToolsTouchDrag",s),r.default.$(f).on("CornerstoneToolsTouchPinch",c),r.default.$(f).on("CornerstoneToolsTouchPress",c),r.default.$(f).on("CornerstoneToolsTouchEnd",c),r.default.$(f).on("CornerstoneToolsDragEnd",c),r.default.$(f).on("CornerstoneToolsTap",c),!0};var n=o(0),r=a(n),l=o(14),i=a(l),u=o(1),s=o(3),d=a(s)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o,a,r){if(o.value){var i=l.default.cornerstone,u=(new Date).getTime(),s=Math.abs(t.y-r.y),d=s/10;if(console.log("distanceRemaining: "+s),s<1)return t.y=r.y,void(o.value=!1);t.y>r.y?t.y-=d:t.y<r.y&&(t.y+=d),i.updateImage(a.element),i.requestAnimationFrame(function(){n(u,t,o,a,r)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r){function i(e,n){s.value=!1,!1===a.hasMoved&&(a.hasMoved=!0),a.active=!0;var r=n.currentPoints,l={x:r.page.x,y:r.page.y+h};T=f.pageToPixel(g,l.x,l.y),a.x=T.x,a.y=T.y,f.updateImage(g);var i={toolType:t,element:g,measurementData:o};(0,u.default)(g,"CornerstoneToolsMeasurementModified",i)}function c(t,n){s.value=!1,a.active=!1,l.default.$(g).off("CornerstoneToolsTouchDrag",i),l.default.$(g).off(d,c),f.updateImage(g),"CornerstoneToolsTouchPress"===t.type&&(n.handlePressed=o,a.x=e.currentPoints.image.x,a.y=e.currentPoints.image.y),"function"==typeof r&&r(t,n)}s.value=!0;var f=l.default.cornerstone,g=e.element,v=f.getEnabledElement(g),m=(new Date).getTime(),h=-57,p={x:e.currentPoints.page.x,y:e.currentPoints.page.y+h},T=f.pageToPixel(g,p.x,p.y);l.default.$(g).on("CornerstoneToolsTouchDrag",i),l.default.$(g).on(d,c),n(m,a,s,v,T)};var r=o(0),l=a(r),i=o(3),u=a(i),s={value:!1},d=["CornerstoneToolsTouchEnd","CornerstoneToolsDragEnd","CornerstoneToolsTouchPinch","CornerstoneToolsTouchPress","CornerstoneToolsTap"].join(" ")},function(e,t,o){"use strict";function a(e,t){var o=Date.now();if(e!==f){if(o-g<=d)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;f=e}g=o}function n(e,t,o){var a=o?v:m;t.forEach(function(t){s.default.$(e).on(t,a)})}function r(e,t,o){var a=o?v:m;t.forEach(function(t){s.default.$(e).off(t,a)})}function l(e){r(e,h,c.mouse),r(e,p,c.touch)}function i(e){l(e),n(e,h,c.mouse),n(e,p,c.touch)}Object.defineProperty(t,"__esModule",{value:!0});var u=o(0),s=function(e){return e&&e.__esModule?e:{default:e}}(u),d=2e3,c={mouse:0,touch:1},f=void 0,g=void 0,v=a.bind(null,c.mouse),m=a.bind(null,c.touch),h=["mousedown","mouseup"],p=["touchstart","touchend"],T={enable:i,disable:l};t.default=T},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){n.default.$(t).off("CornerstoneToolsDoubleTap",e);var o={};n.default.$(t).on("CornerstoneToolsDoubleTap",o,e)},disable:function(t){n.default.$(t).off("CornerstoneToolsDoubleTap",e)},enable:function(t){n.default.$(t).off("CornerstoneToolsDoubleTap",e)},deactivate:function(t){n.default.$(t).off("CornerstoneToolsDoubleTap",e)}}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function o(o){var a=e.createNewMeasurement(o);a&&((0,y.addToolState)(o.element,e.toolType,a),r.default.$(o.element).off("CornerstoneToolsMouseMove",n),(0,g.default)(o,e.toolType,a,a.handles.end,function(){a.active=!1,(0,p.default)(o,a.handles)&&(0,y.removeToolState)(o.element,e.toolType,a),r.default.$(o.element).on("CornerstoneToolsMouseMove",n)},t))}function a(e,t){if((0,C.default)(t.which,e.data.mouseButtonMask))return o(t),!1}function n(t,o){if(i.default.setCoords(o),0===o.which){var a=(0,y.getToolState)(o.element,e.toolType);if(void 0!==a){for(var n=!1,l=o.currentPoints.canvas,u=0;u<a.data.length;u++){var s=a.data[u];!0===(0,c.default)(o.element,s.handles,l)&&(n=!0),(e.pointInsideRect(o.element,s,l)&&!s.active||!e.pointInsideRect(o.element,s,l)&&s.active)&&(s.active=!s.active,n=!0)}!0===n&&r.default.cornerstone.updateImage(o.element)}}}function l(o,a){function l(){u.active=!1,(0,p.default)(a,u.handles)&&(0,y.removeToolState)(a.element,e.toolType,u),i.updateImage(a.element),r.default.$(a.element).on("CornerstoneToolsMouseMove",n)}var i=r.default.cornerstone,u=void 0;if((0,C.default)(a.which,o.data.mouseButtonMask)){var d=a.startPoints.canvas,c=(0,y.getToolState)(o.currentTarget,e.toolType),f=void 0;if(void 0!==c)for(f=0;f<c.data.length;f++){u=c.data[f];var v=(0,s.default)(a.element,u.handles,d,25);if(void 0!==v)return r.default.$(a.element).off("CornerstoneToolsMouseMove",n),u.active=!0,(0,g.default)(a,e.toolType,u,v,l,t),o.stopImmediatePropagation(),!1}var h={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:t};if(void 0!==c&&void 0!==e.pointInsideRect)for(f=0;f<c.data.length;f++)if(u=c.data[f],e.pointInsideRect(a.element,u,d))return r.default.$(a.element).off("CornerstoneToolsMouseMove",n),(0,m.default)(o,u,c,e.toolType,h,l),r.default.$(a.element).on("CornerstoneToolsMouseMove",n),o.stopImmediatePropagation(),!1}}function u(t){e.onImageRendered(t,t.detail)}function d(e){e.removeEventListener("cornerstoneimagerendered",u),r.default.$(e).off("CornerstoneToolsMouseMove",n),r.default.$(e).off("CornerstoneToolsMouseDown",l),r.default.$(e).off("CornerstoneToolsMouseDownActivate",a),r.default.cornerstone.updateImage(e)}function f(e){e.removeEventListener("cornerstoneimagerendered",u),r.default.$(e).off("CornerstoneToolsMouseMove",n),r.default.$(e).off("CornerstoneToolsMouseDown",l),r.default.$(e).off("CornerstoneToolsMouseDownActivate",a),e.addEventListener("cornerstoneimagerendered",u),r.default.cornerstone.updateImage(e)}function v(e,t){var o={mouseButtonMask:t};e.removeEventListener("cornerstoneimagerendered",u),r.default.$(e).off("CornerstoneToolsMouseMove",n),r.default.$(e).off("CornerstoneToolsMouseDown",l),r.default.$(e).off("CornerstoneToolsMouseDownActivate",a),e.addEventListener("cornerstoneimagerendered",u),r.default.$(e).on("CornerstoneToolsMouseMove",o,n),r.default.$(e).on("CornerstoneToolsMouseDown",o,l),r.default.$(e).on("CornerstoneToolsMouseDownActivate",o,a),r.default.cornerstone.updateImage(e)}function h(e,t){var o={mouseButtonMask:t};e.removeEventListener("cornerstoneimagerendered",u),r.default.$(e).off("CornerstoneToolsMouseMove",n),r.default.$(e).off("CornerstoneToolsMouseDown",l),r.default.$(e).off("CornerstoneToolsMouseDownActivate",a),e.addEventListener("cornerstoneimagerendered",u),r.default.$(e).on("CornerstoneToolsMouseMove",o,n),r.default.$(e).on("CornerstoneToolsMouseDown",o,l),r.default.cornerstone.updateImage(e)}return{enable:f,disable:d,activate:v,deactivate:h}};var n=o(0),r=a(n),l=o(36),i=a(l),u=o(20),s=a(u),d=o(37),c=a(d),f=o(24),g=a(f),v=o(38),m=a(v),h=o(14),p=a(h),T=o(2),C=a(T),y=o(1)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){n.default.$(t).off("CornerstoneToolsTouchPinch",e);var o={};n.default.$(t).on("CornerstoneToolsTouchPinch",o,e)},disable:function(t){n.default.$(t).off("CornerstoneToolsTouchPinch",e)},enable:function(t){n.default.$(t).off("CornerstoneToolsTouchPinch",e)},deactivate:function(t){n.default.$(t).off("CornerstoneToolsTouchPinch",e)}}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t,o){e.onMouseMove(t,o)}function o(n,l){e.onMouseUp(n,l),r.default.$(l.element).off("CornerstoneToolsMouseDrag",t),r.default.$(l.element).off("CornerstoneToolsMouseDrag",a),r.default.$(l.element).off("CornerstoneToolsMouseUp",o),r.default.$(l.element).off("CornerstoneToolsMouseClick",o)}function a(t,o){return e.onDrag(t,o),!1}function n(n,l){if((0,d.default)(l.which,n.data.mouseButtonMask))return r.default.$(l.element).on("CornerstoneToolsMouseDrag",a),r.default.$(l.element).on("CornerstoneToolsMouseUp",o),r.default.$(l.element).on("CornerstoneToolsMouseClick",o),e.onMouseDown(n,l),!1;r.default.$(l.element).on("CornerstoneToolsMouseDrag",t),r.default.$(l.element).on("CornerstoneToolsMouseUp",o)}function i(t){var o=t.detail,a=o.element,n=(0,l.getToolState)(a,c),i=void 0;n?i=n.data[0].pixelData:(i=new Uint8ClampedArray(o.image.width*o.image.height),(0,l.addToolState)(a,c,{pixelData:i}));var u=r.default.cornerstone.getLayer(o.element,f);u.image.setPixelData(i),u.invalid=!0,r.default.cornerstone.updateImage(a),e.onImageRendered(t,o)}function s(e,o){e.removeEventListener("cornerstoneimagerendered",i),e.addEventListener("cornerstoneimagerendered",i);var a={mouseButtonMask:o};r.default.$(e).off("CornerstoneToolsMouseDownActivate",n),r.default.$(e).on("CornerstoneToolsMouseDownActivate",a,n),r.default.$(e).off("CornerstoneToolsMouseMove",t),r.default.$(e).on("CornerstoneToolsMouseMove",t);var u=r.default.cornerstone.getEnabledElement(e),s=u.image,d=s.width,g=s.height,m=new Uint8ClampedArray(d*g),h=v.getConfiguration(),p=h.colormapId;if(!p){p="BrushColorMap";var T=r.default.cornerstone.colors.getColormap(p);T.setNumberOfColors(2),T.setColor(0,[0,0,0,0]),T.setColor(1,[255,0,0,255])}var C={minPixelValue:0,maxPixelValue:1,slope:1,intercept:0,getPixelData:function(){return m},rows:u.image.height,columns:u.image.width,height:g,width:d,pixelData:m,setPixelData:function(e){m=e},colormap:p,color:!1,rgba:!1,labelmap:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:u.image.width*u.image.height},y=void 0,M={viewport:{pixelReplication:!0}};f&&(y=r.default.cornerstone.getLayer(e,f)),y||(f=r.default.cornerstone.addLayer(e,C,M)),(0,l.addToolState)(e,c,{pixelData:m}),h.brushLayerId=f,v.setConfiguration(h),r.default.cornerstone.updateImage(e)}function g(e){e.removeEventListener("cornerstoneimagerendered",i),r.default.$(e).off("CornerstoneToolsMouseDownActivate",n),r.default.$(e).off("CornerstoneToolsMouseMove",t)}var v=(0,u.default)({mouseMoveCallback:t,mouseDownActivateCallback:n,onImageRendered:i,deactivate:g});return v.activate=s,v};var n=o(0),r=a(n),l=o(1),i=o(8),u=a(i),s=o(2),d=a(s),c="brush",f=void 0},function(e,t,o){"use strict";function a(e,t,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=Math.round(a),l=Math.round(n);if(1===e)return[[r,l]];for(var i=[],u=0,s=-e;s<=e;s++){var d=l+s;if(!(d>t||d<0))for(var c=-e;c<=e;c++){var f=r+c;f>o||f<0||c*c+s*s<e*e&&(i[u++]=[r+c,l+s])}}return i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,o){"use strict";function a(e,t,o,a){var n=function(e,t){return t*a+e};e.forEach(function(e){var a=n(e[0],e[1]);t[a]=o})}function n(e,t,o,a){var n=l.default.cornerstone.pixelToCanvas(a,{x:0,y:0}),r=l.default.cornerstone.pixelToCanvas(a,{x:1,y:1}),i=r.x-n.x,u=r.y-n.y;t.save(),t.fillStyle=o,e.forEach(function(e){var o=l.default.cornerstone.pixelToCanvas(a,{x:e[0],y:e[1]});t.fillRect(o.x,o.y,i,u)}),t.restore()}Object.defineProperty(t,"__esModule",{value:!0}),t.drawBrushOnCanvas=t.drawBrushPixels=void 0;var r=o(0),l=function(e){return e&&e.__esModule?e:{default:e}}(r);t.drawBrushPixels=a,t.drawBrushOnCanvas=n},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0);Object.defineProperty(t,"external",{enumerable:!0,get:function(){return a(n).default}});var r=o(66);Object.defineProperty(t,"referenceLines",{enumerable:!0,get:function(){return r.referenceLines}}),Object.defineProperty(t,"automaticPlanePositioning",{enumerable:!0,get:function(){return r.automaticPlanePositioning}});var l=o(41);Object.defineProperty(t,"orientation",{enumerable:!0,get:function(){return a(l).default}});var i=o(21);Object.defineProperty(t,"requestPoolManager",{enumerable:!0,get:function(){return a(i).default}});var u=o(42);Object.defineProperty(t,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return a(u).default}});var s=o(43);Object.defineProperty(t,"scrollToIndex",{enumerable:!0,get:function(){return a(s).default}});var d=o(30);Object.defineProperty(t,"scroll",{enumerable:!0,get:function(){return a(d).default}});var c=o(45);Object.defineProperty(t,"layoutScrollToIndex",{enumerable:!0,get:function(){return a(c).default}});var f=o(47);Object.defineProperty(t,"layoutScroll",{enumerable:!0,get:function(){return a(f).default}});var g=o(31);Object.defineProperty(t,"roundToDecimal",{enumerable:!0,get:function(){return a(g).default}});var v=o(28);Object.defineProperty(t,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return v.projectPatientPointToImagePlane}}),Object.defineProperty(t,"imagePointToPatientPoint",{enumerable:!0,get:function(){return v.imagePointToPatientPoint}}),Object.defineProperty(t,"planePlaneIntersection",{enumerable:!0,get:function(){return v.planePlaneIntersection}});var m=o(10);Object.defineProperty(t,"pointInsideBoundingBox",{enumerable:!0,get:function(){return a(m).default}});var h=o(32);Object.defineProperty(t,"pointInEllipse",{enumerable:!0,get:function(){return a(h).default}});var p=o(33);Object.defineProperty(t,"pauseEvent",{enumerable:!0,get:function(){return a(p).default}});var T=o(2);Object.defineProperty(t,"isMouseButtonEnabled",{enumerable:!0,get:function(){return a(T).default}});var C=o(34);Object.defineProperty(t,"getRGBPixels",{enumerable:!0,get:function(){return a(C).default}});var y=o(22);Object.defineProperty(t,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return y.getDefaultSimultaneousRequests}}),Object.defineProperty(t,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return y.getMaxSimultaneousRequests}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return y.getBrowserInfo}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return y.isMobileDevice}});var M=o(50);Object.defineProperty(t,"getLuminance",{enumerable:!0,get:function(){return a(M).default}});var b=o(5);Object.defineProperty(t,"drawTextBox",{enumerable:!0,get:function(){return a(b).default}});var x=o(51);Object.defineProperty(t,"drawEllipse",{enumerable:!0,get:function(){return a(x).default}});var P=o(52);Object.defineProperty(t,"drawCircle",{enumerable:!0,get:function(){return a(P).default}});var w=o(53);Object.defineProperty(t,"drawArrow",{enumerable:!0,get:function(){return a(w).default}});var S=o(35);Object.defineProperty(t,"copyPoints",{enumerable:!0,get:function(){return a(S).default}});var I=o(19);Object.defineProperty(t,"calculateSUV",{enumerable:!0,get:function(){return a(I).default}});var k=o(54);Object.defineProperty(t,"calculateEllipseStatistics",{enumerable:!0,get:function(){return a(k).default}});var $=o(71);Object.defineProperty(t,"probeTool4D",{enumerable:!0,get:function(){return a($).default}});var _=o(39);Object.defineProperty(t,"incrementTimePoint",{enumerable:!0,get:function(){return a(_).default}});var O=o(74);Object.defineProperty(t,"timeSeriesPlayer",{enumerable:!0,get:function(){return a(O).default}});var D=o(75);Object.defineProperty(t,"timeSeriesScroll",{enumerable:!0,get:function(){return D.timeSeriesScroll}}),Object.defineProperty(t,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return D.timeSeriesScrollWheel}}),Object.defineProperty(t,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return D.timeSeriesScrollTouchDrag}});var E=o(76);Object.defineProperty(t,"wwwcSynchronizer",{enumerable:!0,get:function(){return a(E).default}});var j=o(77);Object.defineProperty(t,"updateImageSynchronizer",{enumerable:!0,get:function(){return a(j).default}});var A=o(48);Object.defineProperty(t,"Synchronizer",{enumerable:!0,get:function(){return a(A).default}});var L=o(78);Object.defineProperty(t,"stackScrollSynchronizer",{enumerable:!0,get:function(){return a(L).default}});var B=o(79);Object.defineProperty(t,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return a(B).default}});var R=o(80);Object.defineProperty(t,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return a(R).default}});var H=o(81);Object.defineProperty(t,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return a(H).default}});var N=o(82);Object.defineProperty(t,"panZoomSynchronizer",{enumerable:!0,get:function(){return a(N).default}});var V=o(83);Object.defineProperty(t,"rotationSynchronizer",{enumerable:!0,get:function(){return a(V).default}});var W=o(84);Object.defineProperty(t,"automaticPlanePositioningSynchronizer",{enumerable:!0,get:function(){return a(W).default}});var Y=o(49);Object.defineProperty(t,"layoutStackScrollSynchronizer",{enumerable:!0,get:function(){return a(Y).default}});var z=o(6);Object.defineProperty(t,"toolStyle",{enumerable:!0,get:function(){return a(z).default}});var F=o(1);Object.defineProperty(t,"addToolState",{enumerable:!0,get:function(){return F.addToolState}}),Object.defineProperty(t,"getToolState",{enumerable:!0,get:function(){return F.getToolState}}),Object.defineProperty(t,"removeToolState",{enumerable:!0,get:function(){return F.removeToolState}}),Object.defineProperty(t,"clearToolState",{enumerable:!0,get:function(){return F.clearToolState}}),Object.defineProperty(t,"setElementToolStateManager",{enumerable:!0,get:function(){return F.setElementToolStateManager}}),Object.defineProperty(t,"getElementToolStateManager",{enumerable:!0,get:function(){return F.getElementToolStateManager}});var U=o(36);Object.defineProperty(t,"toolCoordinates",{enumerable:!0,get:function(){return a(U).default}});var X=o(4);Object.defineProperty(t,"toolColors",{enumerable:!0,get:function(){return a(X).default}});var q=o(86);Object.defineProperty(t,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return q.addTimeSeriesStateManager}}),Object.defineProperty(t,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return q.newTimeSeriesSpecificToolStateManager}});var K=o(16);Object.defineProperty(t,"textStyle",{enumerable:!0,get:function(){return a(K).default}});var G=o(87);Object.defineProperty(t,"stackSpecificStateManager",{enumerable:!0,get:function(){return G.stackSpecificStateManager}}),Object.defineProperty(t,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return G.newStackSpecificToolStateManager}}),Object.defineProperty(t,"addStackStateManager",{enumerable:!0,get:function(){return G.addStackStateManager}});var Z=o(7);Object.defineProperty(t,"loadHandlerManager",{enumerable:!0,get:function(){return a(Z).default}});var J=o(17);Object.defineProperty(t,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return J.newImageIdSpecificToolStateManager}}),Object.defineProperty(t,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return J.globalImageIdSpecificToolStateManager}});var Q=o(88);Object.defineProperty(t,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return Q.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(t,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return Q.globalFrameOfReferenceSpecificToolStateManager}});var ee=o(89);Object.defineProperty(t,"appState",{enumerable:!0,get:function(){return a(ee).default}});var te=o(90);Object.defineProperty(t,"stackScrollKeyboard",{enumerable:!0,get:function(){return a(te).default}});var oe=o(44);Object.defineProperty(t,"stackScroll",{enumerable:!0,get:function(){return oe.stackScroll}}),Object.defineProperty(t,"stackScrollWheel",{enumerable:!0,get:function(){return oe.stackScrollWheel}}),Object.defineProperty(t,"stackScrollTouchDrag",{enumerable:!0,get:function(){return oe.stackScrollTouchDrag}}),Object.defineProperty(t,"stackScrollMultiTouch",{enumerable:!0,get:function(){return oe.stackScrollMultiTouch}});var ae=o(46);Object.defineProperty(t,"layoutStackScroll",{enumerable:!0,get:function(){return ae.layoutStackScroll}}),Object.defineProperty(t,"layoutStackScrollWheel",{enumerable:!0,get:function(){return ae.layoutStackScrollWheel}}),Object.defineProperty(t,"layoutStackScrollTouchDrag",{enumerable:!0,get:function(){return ae.layoutStackScrollTouchDrag}}),Object.defineProperty(t,"layoutStackScrollMultiTouch",{enumerable:!0,get:function(){return ae.layoutStackScrollMultiTouch}});var ne=o(91);Object.defineProperty(t,"stackPrefetch",{enumerable:!0,get:function(){return a(ne).default}});var re=o(92);Object.defineProperty(t,"scrollIndicator",{enumerable:!0,get:function(){return a(re).default}});var le=o(93);Object.defineProperty(t,"stackRenderers",{enumerable:!0,get:function(){return a(le).default}});var ie=o(95);Object.defineProperty(t,"playClip",{enumerable:!0,get:function(){return ie.playClip}}),Object.defineProperty(t,"stopClip",{enumerable:!0,get:function(){return ie.stopClip}});var ue=o(14);Object.defineProperty(t,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return a(ue).default}});var se=o(9);Object.defineProperty(t,"drawHandles",{enumerable:!0,get:function(){return a(se).default}});var de=o(20);Object.defineProperty(t,"getHandleNearImagePoint",{enumerable:!0,get:function(){return a(de).default}});var ce=o(37);Object.defineProperty(t,"handleActivator",{enumerable:!0,get:function(){return a(ce).default}});var fe=o(38);Object.defineProperty(t,"moveAllHandles",{enumerable:!0,get:function(){return a(fe).default}});var ge=o(24);Object.defineProperty(t,"moveHandle",{enumerable:!0,get:function(){return a(ge).default}});var ve=o(25);Object.defineProperty(t,"moveNewHandle",{enumerable:!0,get:function(){return a(ve).default}});var me=o(27);Object.defineProperty(t,"moveNewHandleTouch",{enumerable:!0,get:function(){return a(me).default}});var he=o(56);Object.defineProperty(t,"touchMoveAllHandles",{enumerable:!0,get:function(){return a(he).default}});var pe=o(57);Object.defineProperty(t,"touchMoveHandle",{enumerable:!0,get:function(){return a(pe).default}});var Te=o(96);Object.defineProperty(t,"keyboardInput",{enumerable:!0,get:function(){return a(Te).default}});var Ce=o(97);Object.defineProperty(t,"mouseInput",{enumerable:!0,get:function(){return a(Ce).default}});var ye=o(98);Object.defineProperty(t,"mouseWheelInput",{enumerable:!0,get:function(){return a(ye).default}});var Me=o(58);Object.defineProperty(t,"preventGhostClick",{enumerable:!0,get:function(){return a(Me).default}});var be=o(99);Object.defineProperty(t,"touchInput",{enumerable:!0,get:function(){return a(be).default}});var xe=o(100);Object.defineProperty(t,"angle",{enumerable:!0,get:function(){return xe.angle}}),Object.defineProperty(t,"angleTouch",{enumerable:!0,get:function(){return xe.angleTouch}});var Pe=o(101);Object.defineProperty(t,"arrowAnnotate",{enumerable:!0,get:function(){return Pe.arrowAnnotate}}),Object.defineProperty(t,"arrowAnnotateTouch",{enumerable:!0,get:function(){return Pe.arrowAnnotateTouch}});var we=o(102);Object.defineProperty(t,"crosshairs",{enumerable:!0,get:function(){return we.crosshairs}}),Object.defineProperty(t,"crosshairsTouch",{enumerable:!0,get:function(){return we.crosshairsTouch}});var Se=o(26);Object.defineProperty(t,"displayTool",{enumerable:!0,get:function(){return a(Se).default}});var Ie=o(59);Object.defineProperty(t,"doubleTapTool",{enumerable:!0,get:function(){return a(Ie).default}});var ke=o(103);Object.defineProperty(t,"doubleTapZoom",{enumerable:!0,get:function(){return a(ke).default}});var $e=o(104);Object.defineProperty(t,"dragProbe",{enumerable:!0,get:function(){return $e.dragProbe}}),Object.defineProperty(t,"dragProbeTouch",{enumerable:!0,get:function(){return $e.dragProbeTouch}});var _e=o(105);Object.defineProperty(t,"ellipticalRoi",{enumerable:!0,get:function(){return _e.ellipticalRoi}}),Object.defineProperty(t,"ellipticalRoiTouch",{enumerable:!0,get:function(){return _e.ellipticalRoiTouch}});var Oe=o(106);Object.defineProperty(t,"freehand",{enumerable:!0,get:function(){return Oe.freehand}});var De=o(107);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return De.highlight}}),Object.defineProperty(t,"highlightTouch",{enumerable:!0,get:function(){return De.highlightTouch}});var Ee=o(108);Object.defineProperty(t,"imageStats",{enumerable:!0,get:function(){return a(Ee).default}});var je=o(55);Object.defineProperty(t,"keyboardTool",{enumerable:!0,get:function(){return a(je).default}});var Ae=o(109);Object.defineProperty(t,"length",{enumerable:!0,get:function(){return Ae.length}}),Object.defineProperty(t,"lengthTouch",{enumerable:!0,get:function(){return Ae.lengthTouch}});var Le=o(110);Object.defineProperty(t,"magnify",{enumerable:!0,get:function(){return Le.magnify}}),Object.defineProperty(t,"magnifyTouchDrag",{enumerable:!0,get:function(){return Le.magnifyTouchDrag}});var Be=o(60);Object.defineProperty(t,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return a(Be).default}});var Re=o(8);Object.defineProperty(t,"mouseButtonTool",{enumerable:!0,get:function(){return a(Re).default}});var He=o(18);Object.defineProperty(t,"mouseWheelTool",{enumerable:!0,get:function(){return a(He).default}});var Ne=o(23);Object.defineProperty(t,"multiTouchDragTool",{enumerable:!0,get:function(){return a(Ne).default}});var Ve=o(111);Object.defineProperty(t,"orientationMarkers",{enumerable:!0,get:function(){return a(Ve).default}});var We=o(112);Object.defineProperty(t,"pan",{enumerable:!0,get:function(){return We.pan}}),Object.defineProperty(t,"panTouchDrag",{enumerable:!0,get:function(){return We.panTouchDrag}});var Ye=o(113);Object.defineProperty(t,"panMultiTouch",{enumerable:!0,get:function(){return a(Ye).default}});var ze=o(114);Object.defineProperty(t,"probe",{enumerable:!0,get:function(){return ze.probe}}),Object.defineProperty(t,"probeTouch",{enumerable:!0,get:function(){return ze.probeTouch}});var Fe=o(115);Object.defineProperty(t,"rectangleRoi",{enumerable:!0,get:function(){return Fe.rectangleRoi}}),Object.defineProperty(t,"rectangleRoiTouch",{enumerable:!0,get:function(){return Fe.rectangleRoiTouch}});var Ue=o(116);Object.defineProperty(t,"rotate",{enumerable:!0,get:function(){return Ue.rotate}}),Object.defineProperty(t,"rotateTouchDrag",{enumerable:!0,get:function(){return Ue.rotateTouchDrag}});var Xe=o(117);Object.defineProperty(t,"rotateTouch",{enumerable:!0,get:function(){return a(Xe).default}});var qe=o(118);Object.defineProperty(t,"saveAs",{enumerable:!0,get:function(){return a(qe).default}});var Ke=o(119);Object.defineProperty(t,"seedAnnotate",{enumerable:!0,get:function(){return Ke.seedAnnotate}}),Object.defineProperty(t,"seedAnnotateTouch",{enumerable:!0,get:function(){return Ke.seedAnnotateTouch}});var Ge=o(120);Object.defineProperty(t,"simpleAngle",{enumerable:!0,get:function(){return Ge.simpleAngle}}),Object.defineProperty(t,"simpleAngleTouch",{enumerable:!0,get:function(){return Ge.simpleAngleTouch}});var Ze=o(13);Object.defineProperty(t,"simpleMouseButtonTool",{enumerable:!0,get:function(){return a(Ze).default}});var Je=o(121);Object.defineProperty(t,"textMarker",{enumerable:!0,get:function(){return Je.textMarker}}),Object.defineProperty(t,"textMarkerTouch",{enumerable:!0,get:function(){return Je.textMarkerTouch}});var Qe=o(12);Object.defineProperty(t,"touchDragTool",{enumerable:!0,get:function(){return a(Qe).default}});var et=o(61);Object.defineProperty(t,"touchPinchTool",{enumerable:!0,get:function(){return a(et).default}});var tt=o(11);Object.defineProperty(t,"touchTool",{enumerable:!0,get:function(){return a(tt).default}});var ot=o(122);Object.defineProperty(t,"wwwc",{enumerable:!0,get:function(){return ot.wwwc}}),Object.defineProperty(t,"wwwcTouchDrag",{enumerable:!0,get:function(){return ot.wwwcTouchDrag}});var at=o(123);Object.defineProperty(t,"wwwcRegion",{enumerable:!0,get:function(){return at.wwwcRegion}}),Object.defineProperty(t,"wwwcRegionTouch",{enumerable:!0,get:function(){return at.wwwcRegionTouch}});var nt=o(124);Object.defineProperty(t,"zoom",{enumerable:!0,get:function(){return nt.zoom}}),Object.defineProperty(t,"zoomWheel",{enumerable:!0,get:function(){return nt.zoomWheel}}),Object.defineProperty(t,"zoomTouchPinch",{enumerable:!0,get:function(){return nt.zoomTouchPinch}}),Object.defineProperty(t,"zoomTouchDrag",{enumerable:!0,get:function(){return nt.zoomTouchDrag}});var rt=o(125);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return rt.brush}});var lt=o(126);Object.defineProperty(t,"adaptiveBrush",{enumerable:!0,get:function(){return lt.adaptiveBrush}});var it=o(127);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return a(it).default}})},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.automaticPlanePositioning=t.referenceLines=void 0;var n=o(40),r=a(n),l=o(67),i=a(l),u=o(68),s=a(u),d=o(29),c=a(d),f={calculateReferenceLine:r.default,tools:i.default,renderActiveReferenceLine:c.default},g={calculateReferenceLine:r.default,tool:s.default,renderActiveReferenceLine:c.default};t.referenceLines=f,t.automaticPlanePositioning=g},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=u.default.$,o=e.detail,a=(0,s.getToolState)(e.currentTarget,f);if(void 0!==a){var n=a.data[0].synchronizationContext,r=n.getSourceElements(),l=a.data[0].renderer,i=o.canvasContext.canvas;u.default.cornerstone.setToPixelCoordinateSystem(o.enabledElement,i.getContext("2d")),t(e.currentTarget).data("mouseWheel")||r.forEach(function(a){a!==e.currentTarget&&t(a).data("mouseWheel")&&l(i,o,e.currentTarget,a)})}}function r(e,t,o){o=o||c.default,(0,s.addToolState)(e,f,{synchronizationContext:t,renderer:o}),e.removeEventListener("cornerstoneimagerendered",n),e.addEventListener("cornerstoneimagerendered",n),u.default.cornerstone.updateImage(e)}function l(e){e.removeEventListener("cornerstoneimagerendered",n),u.default.cornerstone.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=a(i),s=o(1),d=o(29),c=a(d),f="referenceLines",g={enable:r,disable:l};t.default=g},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=u.default.$,o=e.detail,a=(0,s.getToolState)(e.currentTarget,f);if(void 0!==a){var n=a.data[0].synchronizationContext,r=n.getSourceElements(),l=a.data[0].renderer,i=o.canvasContext.canvas;u.default.cornerstone.setToPixelCoordinateSystem(o.enabledElement,i.getContext("2d")),r.forEach(function(a){if(a!==e.currentTarget)return t(a).data("autoPlanePosition")?void t(a).data("autoPlanePosition",!1):void(t(a).data("mouseWheel")&&(l(i,o,e.currentTarget,a),t(a).data("mouseWheel",!1)))})}}function r(e,t,o){o=o||c.default,(0,s.addToolState)(e,f,{synchronizationContext:t,renderer:o}),e.removeEventListener("cornerstoneimagerendered",n),e.addEventListener("cornerstoneimagerendered",n),u.default.cornerstone.updateImage(e)}function l(e){e.removeEventListener("cornerstoneimagerendered",n),u.default.cornerstone.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=a(i),s=o(1),d=o(29),c=a(d),f="automaticPlanePositioning",g={enable:r,disable:l};t.default=g},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=(0,i.default)(e),o="",a=t.x<0?"R":"L",n=t.y<0?"A":"P",l=t.z<0?"F":"H",u=new r.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),s=0;s<3;s++)if(u.x>1e-4&&u.x>u.y&&u.x>u.z)o+=a,u.x=0;else if(u.y>1e-4&&u.y>u.x&&u.y>u.z)o+=n,u.y=0;else{if(!(u.z>1e-4&&u.z>u.x&&u.z>u.y))break;o+=l,u.z=0}return o};var n=o(0),r=a(n),l=o(15),i=a(l)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace("H","f");return t=t.replace("F","h"),t=t.replace("R","l"),t=t.replace("L","r"),t=t.replace("A","p"),t=t.replace("P","a"),t=t.toUpperCase()}},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=u.default.cornerstone,o=[];e.timeSeries.stacks.forEach(function(a){var n=void 0;n=!0===a.preventCache?t.loadImage(a.imageIds[e.imageIdIndex]):t.loadAndCacheImage(a.imageIds[e.imageIdIndex]),n.then(function(t){var a=Math.round(e.handles.end.x)+Math.round(e.handles.end.y)*t.width,n=t.getPixelData()[a];o.push(n)})}),e.lineSample.set(o)}function r(e){var t=(0,m.getToolState)(e.element,"timeSeries");if(void 0!==t&&void 0!==t.data&&0!==t.data.length){var o=t.data[0],a={timeSeries:o,lineSample:new C.default,imageIdIndex:o.stacks[o.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};return n(a),p.default.add(a),a}}function l(e,t){var o=(0,m.getToolState)(e.currentTarget,y);if(o){var a=t.canvasContext.canvas.getContext("2d");u.default.cornerstone.setToPixelCoordinateSystem(t.enabledElement,a);for(var n=0;n<o.data.length;n++){a.save();var r=o.data[n];a.beginPath(),(0,f.default)(a,t,r.handles,"white"),a.stroke();var l=(0,v.default)(t.enabledElement,t.canvasContext,15);a.font=l.fontSize+"px Arial";var i=Math.round(r.handles.end.x),s=Math.round(r.handles.end.y),d=r.handles.end.x+3,c=r.handles.end.y-3;a.fillStyle="white",a.fillText(i+","+s,d,c),a.restore()}}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=a(i),s=o(8),d=a(s),c=o(9),f=a(c),g=o(42),v=a(g),m=o(1),h=o(72),p=a(h),T=o(73),C=a(T),y="probe4D",M=(0,d.default)({createNewMeasurement:r,onImageRendered:l,toolType:y});t.default=M},function(e,t,o){"use strict";function a(){var e=this;e.measurements=[],this.add=function(t){var o=e.measurements.push(t),a={index:o,measurement:t};(0,r.default)(e,"CornerstoneMeasurementAdded",a)},this.remove=function(t){var o=e.measurements[t];e.measurements.splice(t,1);var a={index:t,measurement:o};(0,r.default)(e,"CornerstoneMeasurementRemoved",a)}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(3),r=function(e){return e&&e.__esModule?e:{default:e}}(n),l=new a;t.default=l},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=this;e.samples=[],this.set=function(t){e.samples=t,(0,n.default)(e,"CornerstoneLineSampleUpdated")}};var a=o(3),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e,t){if(void 0===e)throw new Error("playClip: element must not be undefined");void 0===t&&(t=30);var o=(0,r.getToolState)(e,"timeSeries");if(void 0!==o&&void 0!==o.data&&0!==o.data.length){var a=(0,r.getToolState)(e,u),n=void 0;void 0===a||0===a.data.length?(n={intervalId:void 0,framesPerSecond:t,lastFrameTimeStamp:void 0,frameRate:0},(0,r.addToolState)(e,u,n)):(n=a.data[0],n.framesPerSecond=t),void 0===n.intervalId&&(n.intervalId=setInterval(function(){n.framesPerSecond>0?(0,i.default)(e,1,!0):(0,i.default)(e,-1,!0)},1e3/Math.abs(n.framesPerSecond)))}}function n(e){var t=(0,r.getToolState)(e,u);if(t&&t.data&&t.data.length){var o=t.data[0];clearInterval(o.intervalId),o.intervalId=void 0}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),l=o(39),i=function(e){return e&&e.__esModule?e:{default:e}}(l),u="timeSeriesPlayer",s={start:a,stop:n};t.default=s},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){d.default.$(t.element).off("CornerstoneToolsMouseDrag",l),d.default.$(t.element).off("CornerstoneToolsMouseUp",n),d.default.$(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask)){var o={deltaY:0,options:e.data.options};return d.default.$(t.element).on("CornerstoneToolsMouseDrag",o,l),d.default.$(t.element).on("CornerstoneToolsMouseUp",n),d.default.$(t.element).on("CornerstoneToolsMouseClick",n),e.stopImmediatePropagation(),!1}}function l(e,t){e.data.deltaY+=t.deltaPoints.page.y;var o=(0,M.getToolState)(t.element,"timeSeries");if(void 0!==o&&void 0!==o.data&&0!==o.data.length){var a=o.data[0],n=d.default.$(t.element).height()/a.stacks.length;if(void 0!==e.data.options&&void 0!==e.data.options.timeSeriesScrollSpeed&&(n=e.data.options.timeSeriesScrollSpeed),e.data.deltaY>=n||e.data.deltaY<=-n){var r=Math.round(e.data.deltaY/n),l=e.data.deltaY%n;(0,T.default)(t.element,r),e.data.deltaY=l}return!1}}function i(e,t){var o=-t.direction;(0,T.default)(t.element,o)}function u(e){var t=e.originalEvent.detail,o={deltaY:0};o.deltaY+=t.deltaPoints.page.y;var a=(0,M.getToolState)(t.element,"stack");if(void 0!==a&&void 0!==a.data&&0!==a.data.length){if(o.deltaY>=3||o.deltaY<=-3){var n=o.deltaY/3,r=o.deltaY%3;(0,T.default)(o.element,n),o.deltaY=r}return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=void 0;var s=o(0),d=a(s),c=o(13),f=a(c),g=o(12),v=a(g),m=o(18),h=a(m),p=o(39),T=a(p),C=o(2),y=a(C),M=o(1),b=(0,f.default)(r),x=(0,h.default)(i),P=(0,v.default)(u);t.timeSeriesScroll=b,t.timeSeriesScrollWheel=x,t.timeSeriesScrollTouchDrag=P},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var a=n.default.cornerstone,r=a.getViewport(t),l=a.getViewport(o);void 0!=l&&(l.voi.windowWidth===r.voi.windowWidth&&l.voi.windowCenter===r.voi.windowCenter&&l.invert===r.invert||(l.voi.windowWidth=r.voi.windowWidth,l.voi.windowCenter=r.voi.windowCenter,l.invert=r.invert,e.setViewport(o,l)))}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var a=n.default.$;o!==t&&(n.default.cornerstone.updateImage(o),a(o).data("mouseWheel")&&a(o).data("mouseWheel",!1))};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){if(t!==o&&a&&a.direction){var n=r.default.cornerstone,i=(0,l.getToolState)(o,"stack"),s=i.data[0],d=s.currentImageIdIndex+a.direction;if(d=Math.min(Math.max(d,0),s.imageIds.length-1),s.currentImageIdIndex!==d){var c=u.default.getStartLoadHandler(),f=u.default.getEndLoadHandler(),g=u.default.getErrorLoadingHandler();c&&c(o);var v=void 0;v=!0===s.preventCache?n.loadImage(s.imageIds[d]):n.loadAndCacheImage(s.imageIds[d]),v.then(function(t){var a=n.getViewport(o);s.currentImageIdIndex=d,e.displayImage(o,t,a),f&&f(o,t)},function(e){var t=s.imageIds[d];g&&g(o,t,e)})}}};var n=o(0),r=a(n),l=o(1),i=o(7),u=a(i)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var a=r.default.cornerstone,n=a.getEnabledElement(t).image,i=a.metaData.get("imagePlaneModule",n.imageId);if(void 0!==i&&void 0!==i.imagePositionPatient){var s=(0,d.default)(i.imagePositionPatient),c=(0,l.getToolState)(o,"stack"),f=c.data[0],g=Number.MAX_VALUE,v=-1;if(f.imageIds.forEach(function(e,t){var o=a.metaData.get("imagePlaneModule",e);if(void 0!==o&&void 0!==o.imagePositionPatient){var n=(0,d.default)(o.imagePositionPatient),r=n.distanceToSquared(s);r<g&&(g=r,v=t)}}),v!==f.currentImageIdIndex){var m=u.default.getStartLoadHandler(),h=u.default.getEndLoadHandler(),p=u.default.getErrorLoadingHandler();if(m&&m(o),-1!==v){var T=void 0;T=!0===f.preventCache?a.loadImage(f.imageIds[v]):a.loadAndCacheImage(f.imageIds[v]),T.then(function(t){var n=a.getViewport(o);f.currentImageIdIndex=v,e.displayImage(o,t,n),h&&h(o,t)},function(e){var t=f.imageIds[v];p&&p(o,t,e)})}}}}};var n=o(0),r=a(n),l=o(1),i=o(7),u=a(i),s=o(15),d=a(s)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n){if(o!==t){var i=r.default.cornerstone,s=i.getEnabledElement(t),c=i.metaData.get("imagePlaneModule",s.image.imageId),f=(0,d.default)(c.imagePositionPatient),g=(0,l.getToolState)(o,"stack"),v=g.data[0],m=Number.MAX_VALUE,h=-1;if(n){var p=f.clone().add(n);if(v.imageIds.forEach(function(e,t){var o=i.metaData.get("imagePlaneModule",e),a=(0,d.default)(o.imagePositionPatient),n=p.distanceToSquared(a);n<m&&(m=n,h=t)}),h!==v.currentImageIdIndex&&-1!==h){var T=u.default.getStartLoadHandler(),C=u.default.getEndLoadHandler(),y=u.default.getErrorLoadingHandler();T&&T(o);var M=void 0;M=!0===v.preventCache?i.loadImage(v.imageIds[h]):i.loadAndCacheImage(v.imageIds[h]),M.then(function(t){var a=i.getViewport(o);v.currentImageIdIndex=h,e.displayImage(o,t,a),C&&C(o,t)},function(e){var t=v.imageIds[h];y&&y(o,t,e)})}}}};var n=o(0),r=a(n),l=o(1),i=o(7),u=a(i),s=o(15),d=a(s)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var a=r.default.cornerstone,n=(0,l.getToolState)(t,"stack"),i=n.data[0],s=(0,l.getToolState)(o,"stack"),d=s.data[0],c=i.currentImageIdIndex;if((c=Math.min(Math.max(c,0),d.imageIds.length-1))!==d.currentImageIdIndex){var f=u.default.getStartLoadHandler(),g=u.default.getEndLoadHandler(),v=u.default.getErrorLoadingHandler();f&&f(o);var m=void 0;m=!0===d.preventCache?a.loadImage(d.imageIds[c]):a.loadAndCacheImage(d.imageIds[c]),m.then(function(t){var n=a.getViewport(o);d.currentImageIdIndex=c,e.displayImage(o,t,n),g&&g(o,t)},function(e){var t=d.imageIds[c];v&&v(o,t,e)})}}};var n=o(0),r=a(n),l=o(1),i=o(7),u=a(i)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var a=n.default.cornerstone,r=a.getViewport(t),l=a.getViewport(o);void 0!=l&&(l.scale===r.scale&&l.translation.x===r.translation.x&&l.translation.y===r.translation.y||(0!=r.scale&&(l.scale=r.scale),l.scale=r.scale,l.translation.x=r.translation.x,l.translation.y=r.translation.y,e.setViewport(o,l)))}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var a=n.default.cornerstone;if(o!==t){var r=a.getViewport(t),l=a.getViewport(o);void 0!==l&&l.rotation!==r.rotation&&(l.rotation=r.rotation,e.setViewport(o,l))}};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){if(t!==o&&a&&a.direction){var n=r.default.$,i=r.default.cornerstone,s=(0,l.getToolState)(o,"stack"),c=s.data[0];if(!(void 0===s||void 0===s.data||0===s.data.length||c.imageIds.length<=1)){var f=i.getEnabledElement(t).image,g=i.getEnabledElement(o).image;if(f&&g){var v=i.metaData.get("imagePlaneModule",f.imageId),m=i.metaData.get("imagePlaneModule",g.imageId);if(v&&m&&v.pixelSpacing&&m.pixelSpacing&&v.rows&&v.columns&&v.rowCosines&&v.columnCosines&&v.imagePositionPatient&&m.rowCosines&&m.columnCosines&&m.imagePositionPatient&&v.frameOfReferenceUID===m.frameOfReferenceUID){var h=(0,d.default)(c,v,m);if(null===h||void 0===h)return void i.updateImage(o);var p=h;if(p=Math.min(Math.max(p,0),c.imageIds.length-1),c.currentImageIdIndex!==p){var T=u.default.getStartLoadHandler(),C=u.default.getEndLoadHandler(),y=u.default.getErrorLoadingHandler();T&&T(o);var M=void 0;M=!0===c.preventCache?i.loadImage(c.imageIds[p]):i.loadAndCacheImage(c.imageIds[p]),M.then(function(t){var a=i.getViewport(o);c.currentImageIdIndex=p,e.displayImage(o,t,a),n(o).data("autoPlanePosition",!0),C&&C(o,t)},function(e){var t=c.imageIds[p];y&&y(o,t,e)})}}}}}};var n=o(0),r=a(n),l=o(1),i=o(7),u=a(i),s=o(85),d=a(s)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var a=r.default.cornerstone;t.rowCosines=(0,i.default)(t.rowCosines),t.columnCosines=(0,i.default)(t.columnCosines),t.imagePositionPatient=(0,i.default)(t.imagePositionPatient),o.rowCosines=(0,i.default)(o.rowCosines),o.columnCosines=(0,i.default)(o.columnCosines),o.imagePositionPatient=(0,i.default)(o.imagePositionPatient);var n=t.rowCosines.clone().cross(t.columnCosines),l=o.rowCosines.clone().cross(o.columnCosines),u={},s={},d=void 0,c=t.columnPixelSpacing*(t.columns/2),f=t.rowPixelSpacing*(t.rows/2),g={};if(g.x=t.imagePositionPatient.x+t.rowCosines.x*c+t.columnCosines.x*f,g.y=t.imagePositionPatient.y+t.rowCosines.y*c+t.columnCosines.y*f,g.z=t.imagePositionPatient.z+t.rowCosines.z*c+t.columnCosines.z*f,n&&l){return function(e,t){var o=Math.sqrt((e.x*e.x+e.y*e.y+e.z*e.z)*(t.x*t.x+t.y*t.y+t.z*t.z));return o<1e-5?o<1e-5:Math.abs(e.x*t.x+e.y*t.y+e.z*t.z)/o>.99}(n,l)?(e.imageIds.forEach(function(e,o){var n=a.metaData.get("imagePlaneModule",e);if(n&&n.pixelSpacing&&n.rowCosines&&n.columnCosines&&n.imagePositionPatient){n.rowCosines=(0,i.default)(n.rowCosines),n.columnCosines=(0,i.default)(n.columnCosines),n.imagePositionPatient=(0,i.default)(n.imagePositionPatient);var r=Math.abs(t.imagePositionPatient.x-n.imagePositionPatient.x),l=Math.abs(t.imagePositionPatient.y-n.imagePositionPatient.y),c=Math.abs(t.imagePositionPatient.z-n.imagePositionPatient.z);Math.max(r,l,c)<=.001&&(d=o);var f=n.rowCosines.clone().cross(n.columnCosines),v=Math.abs(f.x*(g.x-n.imagePositionPatient.x)+f.y*(g.y-n.imagePositionPatient.y)+f.z*(g.z-n.imagePositionPatient.z));s.distance=v,s.index=o,(!u.distance||s.distance<u.distance)&&(u.distance=s.distance,u.index=o)}}),void 0===d&&u.distance<10?d=u.index:d):void 0}};var n=o(0),r=a(n),l=o(15),i=a(l)},function(e,t,o){"use strict";function a(e,t){function o(o,a,r){if(!(e.indexOf(a)>=0))return t.add(o,a,r);!1===n.hasOwnProperty(a)&&(n[a]={data:[]}),n[a].data.push(r)}function a(o,a){return e.indexOf(a)>=0?(!1===n.hasOwnProperty(a)&&(n[a]={data:[]}),n[a]):t.get(o,a)}var n={};return{get:a,add:o}}function n(e,t){t=t||["timeSeries"];var o=(0,l.getElementToolStateManager)(e);void 0===o&&(o=r.globalImageIdSpecificToolStateManager);var n=a(t,o);i.push(n),(0,l.setElementToolStateManager)(e,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=void 0;var r=o(17),l=o(1),i=[];t.addTimeSeriesStateManager=n,t.newTimeSeriesSpecificToolStateManager=a},function(e,t,o){"use strict";function a(e,t){function o(){return l}function a(e){l=e}function n(o,a,n){if(!(e.indexOf(a)>=0))return t.add(o,a,n);!1===l.hasOwnProperty(a)&&(l[a]={data:[]}),l[a].data.push(n)}function r(o,a){return e.indexOf(a)>=0?(!1===l.hasOwnProperty(a)&&(l[a]={data:[]}),l[a]):t.get(o,a)}var l={};return{get:r,add:n,saveToolState:o,restoreToolState:a,toolState:l}}function n(e,t){var o=(0,l.getElementToolStateManager)(e);o||(o=r.globalImageIdSpecificToolStateManager);var n=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(n=n.concat(t));var u=a(n,o);i.push(u),(0,l.setElementToolStateManager)(e,u)}Object.defineProperty(t,"__esModule",{value:!0}),t.addStackStateManager=t.newStackSpecificToolStateManager=t.stackSpecificStateManager=void 0;var r=o(17),l=o(1),i=[],u={newStackSpecificToolStateManager:a,addStackStateManager:n};t.stackSpecificStateManager=u,t.newStackSpecificToolStateManager=a,t.addStackStateManager=n},function(e,t,o){"use strict";function a(){function e(e,t,o){!1===a.hasOwnProperty(e)&&(a[e]={});var n=a[e];!1===n.hasOwnProperty(t)&&(n[t]={data:[]}),n[t].data.push(o)}function t(e,t){if(!1!==a.hasOwnProperty(e)){var o=a[e];if(!1!==o.hasOwnProperty(t)){return o[t]}}}function o(e,t,o){if(!1!==a.hasOwnProperty(e)){var n=a[e];if(!1!==n.hasOwnProperty(t)){for(var r=n[t],l=-1,i=0;i<r.data.length;i++)r.data[i]===o&&(l=i);-1!==l&&r.data.splice(l,1)}}}var a={};return{get:t,add:e,remove:o}}Object.defineProperty(t,"__esModule",{value:!0});var n=a();t.newFrameOfReferenceSpecificToolStateManager=a,t.globalFrameOfReferenceSpecificToolStateManager=n},function(e,t,o){"use strict";function a(e){var t={imageIdToolState:i.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return e.forEach(function(e){var o=(0,u.getElementToolStateManager)(e);o!==i.globalImageIdSpecificToolStateManager&&(t.elementToolState[e.id]=o.saveToolState(),t.elementViewport[e.id]=l.default.cornerstone.getViewport(e))}),t}function n(e){if(e.hasOwnProperty("imageIdToolState")&&e.hasOwnProperty("elementToolState")&&e.hasOwnProperty("elementViewport")){var t=l.default.cornerstone;return i.globalImageIdSpecificToolStateManager.restoreToolState(e.imageIdToolState),Object.keys(e.elementViewport).forEach(function(o){var a=document.getElementById(o);if(a&&e.elementToolState.hasOwnProperty(o)){var n=(0,u.getElementToolStateManager)(a);if(n!==i.globalImageIdSpecificToolStateManager){n.restoreToolState(e.elementToolState[o]);var r=e.elementViewport[o];t.setViewport(a,r),t.updateImage(a)}}}),e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),l=function(e){return e&&e.__esModule?e:{default:e}}(r),i=o(17),u=o(1),s={save:a,restore:n};t.default=s},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=t.keyCode;if(o===s.UP||o===s.DOWN){var a=1;o===s.DOWN&&(a=-1),(0,l.default)(t.element,a)}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(30),l=a(r),i=o(55),u=a(i),s={UP:38,DOWN:40},d=(0,u.default)(n);t.default=d},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){e=Math.round(e)||0,t=Math.round(t)||0;var o=[],a=t-e+1;if(a<=0)return o;for(;a--;)o[a]=t--;return o}function r(e,t){var o=[],a=[];return e.forEach(function(e){e<t?o.push(e):e>t&&a.push(e)}),{low:e.indexOf(S(o)),high:e.indexOf(I(a))}}function l(e){function t(e){var t=u.indicesToRequest.indexOf(e);t>-1&&u.indicesToRequest.splice(t,1)}function o(e){t(l.imageIds.indexOf(e.imageId))}function a(t){console.log("prefetch errored: "+t),f&&f(e,d,t,"stackPrefetch")}var n=(0,C.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var l=n.data[0],i=(0,C.getToolState)(e,M);if(i){var u=i.data[0]||{};if(u.indicesToRequest&&u.indicesToRequest.length||(u.enabled=!1),!1!==u.enabled){i.data[0].indicesToRequest.sort(function(e,t){return e-t});if(u.indicesToRequest.slice().forEach(function(e){var o=l.imageIds[e];if(o){var a=v.default.cornerstone.imageCache.getImagePromise(o);a&&"resolved"===a.state()&&t(e)}}),u.indicesToRequest.length){h.default.clearRequestStack(b);for(var s=r(u.indicesToRequest,l.currentImageIdIndex),d=void 0,c=void 0,f=T.default.getErrorLoadingHandler(),g=s.low,m=s.high;g>=0||m<u.indicesToRequest.length;){var p=l.currentImageIdIndex,y=p-u.indicesToRequest[g]>x.maxImagesToPrefetch,P=u.indicesToRequest[m]-p>x.maxImagesToPrefetch,w=!y&&g>=0,S=!P&&m<u.indicesToRequest.length;if(!S&&!w)break;w&&(c=u.indicesToRequest[g--],d=l.imageIds[c],h.default.addRequest(e,d,b,!1,o,a)),S&&(c=u.indicesToRequest[m++],d=l.imageIds[c],h.default.addRequest(e,d,b,!1,o,a))}h.default.startGrabbing()}}}}}function i(e){return function(t){var o=t.detail,a=void 0;try{a=(0,C.getToolState)(e,"stack")}catch(e){return}if(a&&a.data&&a.data.length){var n=a.data[0],r=n.imageIds.indexOf(o.imageId);if(!(r<0)){var l=(0,C.getToolState)(e,M);l&&l.data&&l.data.length&&l.data[0].indicesToRequest.push(r)}}}}function u(e){clearTimeout(P),P=setTimeout(function(){var t=e.target;try{l(t)}catch(e){return}},w)}function s(e){(0,C.getToolState)(e,M).data=[];var t=(0,C.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var o=t.data[0];if(!0===o.preventCache)return void console.warn("A stack that should not be cached was given the stackPrefetch");var a={indicesToRequest:n(0,o.imageIds.length-1),enabled:!0,direction:1},r=a.indicesToRequest.indexOf(o.currentImageIdIndex);a.indicesToRequest.splice(r,1),(0,C.addToolState)(e,M,a),l(e),e.removeEventListener("cornerstonenewimage",u),e.addEventListener("cornerstonenewimage",u);var s=i(e);v.default.cornerstone.events.removeEventListener("cornerstoneimagecachepromiseremoved",s),v.default.cornerstone.events.addEventListener("cornerstoneimagecachepromiseremoved",s)}}function d(e){clearTimeout(P),e.removeEventListener("cornerstonenewimage",u);var t=i(e);v.default.cornerstone.events.removeEventListener("cornerstoneimagecachepromiseremoved",t);var o=(0,C.getToolState)(e,M);o&&o.data.length&&(o.data[0].enabled=!1,h.default.clearRequestStack(b))}function c(){return x}function f(e){x=e,e.maxSimultaneousRequests&&(0,y.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}Object.defineProperty(t,"__esModule",{value:!0});var g=o(0),v=a(g),m=o(21),h=a(m),p=o(7),T=a(p),C=o(1),y=o(22),M="stackPrefetch",b="prefetch",x={maxImagesToPrefetch:1/0},P=void 0,w=10,S=function(e){return Math.max.apply(null,e)},I=function(e){return Math.min.apply(null,e)},k={enable:s,disable:d,getConfiguration:c,setConfiguration:f};t.default=k},function(e,t,o){"use strict";function a(e,t){var o=t.element,a=t.enabledElement.canvas.width,n=t.enabledElement.canvas.height;if(!a||!n)return!1;var r=t.enabledElement.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.save();var u=s.getConfiguration();r.fillStyle=u.backgroundColor,"horizontal"===u.orientation?r.fillRect(0,n-i,a,i):r.fillRect(0,0,i,n);var d=(0,l.getToolState)(o,"stack");if(d&&d.data&&d.data.length){var c=d.data[0].imageIds,f=d.data[0].currentImageIdIndex,g=a/c.length,v=n/c.length,m=g*f,h=v*f;r.fillStyle=u.fillColor,"horizontal"===u.orientation?r.fillRect(m,n-i,g,i):r.fillRect(0,h,i,v),r.restore()}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(26),r=function(e){return e&&e.__esModule?e:{default:e}}(n),l=o(1),i=6,u={backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"},s=(0,r.default)(a);s.setConfiguration(u),t.default=s},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(94),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r={};r.FusionRenderer=n.default,t.default=r},function(e,t,o){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),r=o(0),l=function(e){return e&&e.__esModule?e:{default:e}}(r),i=o(1),u=function(){function e(){a(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return n(e,[{key:"render",value:function(e,t){var o=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");if(!t){t=(0,i.getToolState)(e,"stack").data}var a=l.default.cornerstone,n=t[0],r=n.imageIds[this.currentImageIdIndex],u=t.slice(1,t.length);a.loadAndCacheImage(r).then(function(t){var l=o.layerIds[0];l?a.setLayerImage(e,t,l):(l=a.addLayer(e,t,n.options),o.layerIds.push(l)),a.displayImage(e,t),u.forEach(function(t,n){var i=o.findImageFn(t.imageIds,r),u=n+1,s=o.layerIds[u];s||(s=a.addLayer(e,void 0,t.options),o.layerIds.push(s)),i?a.loadAndCacheImage(i).then(function(t){a.setLayerImage(e,t,s),a.updateImage(e)}):(a.setLayerImage(e,void 0,s),a.setActiveLayer(e,l),a.updateImage(e))})})}}]),e}();t.default=u},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=void 0,a=void 0,n=void 0,r=0,l=e.length,i=[];for(i.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),o=1;o<l;o++)n=Number(e[o])/t|0,i.push(n),1===o?a=n:n!==a&&(i.isTimeVarying=!0),r+=n;return i.length>0&&(n=i.isTimeVarying?r/i.length|0:i[0],i.push(n)),i}function r(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function l(e){var t={element:e};(0,m.default)(e,"CornerstoneToolsClipStopped",t)}function i(e,t){var o=void 0,a=void 0;if(void 0===e)throw new Error("playClip: element must not be undefined");var i=(0,g.getToolState)(e,"stack");if(i&&i.data&&i.data.length){var u=d.default.cornerstone,s=void 0;if(i.data.length>1){var c=(0,g.getToolState)(e,"stackRenderer");c&&c.data&&c.data.length&&(s=c.data[0])}var v=i.data[0],m=(0,g.getToolState)(e,h);m&&m.data&&m.data.length?(o=m.data[0],r(o)):(o={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,g.addToolState)(e,h,o)),(t<0||t>0)&&(o.framesPerSecond=Number(t),o.reverse=o.framesPerSecond<0,o.ignoreFrameTimeVector=!0),!0!==o.ignoreFrameTimeVector&&o.frameTimeVector&&o.frameTimeVector.length===v.imageIds.length&&(a=n(o.frameTimeVector,o.speed));var p=function(){var t=void 0,a=void 0,n=void 0,d=void 0,c=v.currentImageIdIndex,g=v.imageIds.length;if(o.reverse?c--:c++,!o.loop&&(c<0||c>=g)){r(o),l(e);var m=document.getElementsByClassName("tool-play")[0];return m.classList.remove("icon-play"),void m.classList.add("icon-stop")}c>=g&&(c=0),c<0&&(c=g-1),c!==v.currentImageIdIndex&&(a=f.default.getStartLoadHandler(),n=f.default.getEndLoadHandler(),d=f.default.getErrorLoadingHandler(),a&&a(e),t=!0===v.preventCache?u.loadImage(v.imageIds[c]):u.loadAndCacheImage(v.imageIds[c]),t.then(function(t){try{v.currentImageIdIndex=c,s?(s.currentImageIdIndex=c,s.render(e,i.data)):u.displayImage(e,t),n&&n(e,t)}catch(e){return}},function(t){var o=v.imageIds[c];d&&d(e,o,t)}))};a&&a.length>0&&a.isTimeVarying?(o.usingFrameTimeVector=!0,o.intervalId=setTimeout(function e(){o.intervalId=setTimeout(e,a[v.currentImageIdIndex]),p()},0)):(o.usingFrameTimeVector=!1,o.intervalId=setInterval(p,1e3/Math.abs(o.framesPerSecond)))}}function u(e){var t=(0,g.getToolState)(e,h);t&&t.data&&t.data.length&&r(t.data[0])}Object.defineProperty(t,"__esModule",{value:!0}),t.stopClip=t.playClip=void 0;var s=o(0),d=a(s),c=o(7),f=a(c),g=o(1),v=o(3),m=a(v),h="playClip";t.playClip=i,t.stopClip=u},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=s.default.cornerstone,o=e.currentTarget,a=t.getEnabledElement(o);if(a.image){var n={event:window.event||e,element:o,viewport:t.getViewport(o),image:a.image,currentPoints:{page:{x:f,y:g},image:t.pageToPixel(o,f,g)},keyCode:e.keyCode,which:e.which};n.currentPoints.canvas=t.pixelToCanvas(o,n.currentPoints.image);var r={keydown:"CornerstoneToolsKeyDown",keypress:"CornerstoneToolsKeyPress",keyup:"CornerstoneToolsKeyUp"};(0,c.default)(o,r[e.type],n)}}function r(e){f=e.pageX||e.originalEvent.pageX,g=e.pageY||e.originalEvent.pageY}function l(e){i(e),s.default.$(e).on(v,n),s.default.$(e).on("mousemove",r)}function i(e){s.default.$(e).off(v,n),s.default.$(e).off("mousemove",r)}Object.defineProperty(t,"__esModule",{value:!0});var u=o(0),s=a(u),d=o(3),c=a(d),f=void 0,g=void 0,v="keydown keypress keyup",m={enable:l,disable:i};t.default=m},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return"number"!=typeof e.buttons?e.which:0===e.buttons?0:e.buttons%2==1?1:e.buttons%4==2?3:e.buttons%8==4?2:0}function r(){C=!1}function l(e){var t=f.default.cornerstone,o=e.currentTarget,a="CornerstoneToolsMouseDoubleClick",r=t.getEnabledElement(o);if(r.image){var l={page:f.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(o,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=t.pixelToCanvas(o,l.image);var i=(0,v.default)(l),u={event:e,which:n(e),viewport:t.getViewport(o),image:r.image,element:o,startPoints:l,lastPoints:i,currentPoints:l,deltaPoints:{x:0,y:0},type:a};(0,T.default)(u.element,a,u)}}function i(e){function t(e){var t=f.default.cornerstone,o=t.getEnabledElement(l);if(o.image){var a={page:f.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(l,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};a.canvas=t.pixelToCanvas(l,a.image);var n={page:f.default.cornerstoneMath.point.subtract(a.page,d.page),image:f.default.cornerstoneMath.point.subtract(a.image,d.image),client:f.default.cornerstoneMath.point.subtract(a.client,d.client),canvas:f.default.cornerstoneMath.point.subtract(a.canvas,d.canvas)},r={which:g,viewport:t.getViewport(l),image:o.image,element:l,startPoints:s,lastPoints:d,currentPoints:a,deltaPoints:n,type:"CornerstoneToolsMouseDrag",ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};return(0,T.default)(r.element,"CornerstoneToolsMouseDrag",r),d=(0,v.default)(a),(0,h.default)(e)}}function o(e){var a=f.default.cornerstone,n=a.getEnabledElement(l);if(n.image){clearTimeout(y);var r="CornerstoneToolsMouseUp";C&&(r="CornerstoneToolsMouseClick");var i={page:f.default.cornerstoneMath.point.pageToPoint(e),image:a.pageToPixel(l,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};i.canvas=a.pixelToCanvas(l,i.image);var c={page:f.default.cornerstoneMath.point.subtract(i.page,d.page),image:f.default.cornerstoneMath.point.subtract(i.image,d.image),client:f.default.cornerstoneMath.point.subtract(i.client,d.client),canvas:f.default.cornerstoneMath.point.subtract(i.canvas,d.canvas)},v={event:e,which:g,viewport:a.getViewport(l),image:n.image,element:l,startPoints:s,lastPoints:d,currentPoints:i,deltaPoints:c,type:r};(0,T.default)(v.element,r,v),f.default.$(document).off("mousemove",t),f.default.$(document).off("mouseup",o),f.default.$(v.element).on("mousemove",u),C=!0}}y=setTimeout(r,M);var a=f.default.cornerstone,l=e.currentTarget,i=a.getEnabledElement(l);if(i.image){f.default.$(l).off("mousemove",u);var s={page:f.default.cornerstoneMath.point.pageToPoint(e),image:a.pageToPixel(l,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};s.canvas=a.pixelToCanvas(l,s.image);var d=(0,v.default)(s),c={event:e,which:n(e),viewport:a.getViewport(l),image:i.image,element:l,startPoints:s,lastPoints:d,currentPoints:s,deltaPoints:{x:0,y:0},type:"CornerstoneToolsMouseDown"};(0,T.default)(c.element,"CornerstoneToolsMouseDown",c)&&(c.type="CornerstoneToolsMouseDownActivate",(0,T.default)(c.element,"CornerstoneToolsMouseDownActivate",c));var g=n(e);return f.default.$(document).on("mousemove",t),f.default.$(document).on("mouseup",o),(0,h.default)(e)}}function u(e){var t=f.default.cornerstone,o=e.currentTarget,a=t.getEnabledElement(o);if(a.image){var r={page:f.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(o,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};r.canvas=t.pixelToCanvas(o,r.image);var l=(0,v.default)(r),i=n(e),u={page:f.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(o,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};u.canvas=t.pixelToCanvas(o,u.image);var s={page:f.default.cornerstoneMath.point.subtract(u.page,l.page),image:f.default.cornerstoneMath.point.subtract(u.image,l.image),client:f.default.cornerstoneMath.point.subtract(u.client,l.client),canvas:f.default.cornerstoneMath.point.subtract(u.canvas,l.canvas)},d={which:i,viewport:t.getViewport(o),image:a.image,element:o,startPoints:r,lastPoints:l,currentPoints:u,deltaPoints:s,type:"CornerstoneToolsMouseMove"};(0,T.default)(o,"CornerstoneToolsMouseMove",d),l=(0,v.default)(u)}}function s(e){f.default.$(e).off("mousedown",i),f.default.$(e).off("mousemove",u),f.default.$(e).off("dblclick",l)}function d(e){s(e),f.default.$(e).on("mousedown",i),f.default.$(e).on("mousemove",u),f.default.$(e).on("dblclick",l)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),f=a(c),g=o(35),v=a(g),m=o(33),h=a(m),p=o(3),T=a(p),C=!0,y=void 0,M=200,b={enable:d,disable:s};t.default=b},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=u.default.cornerstone,o=e.currentTarget;if(t.getEnabledElement(o).image&&!("mousewheel"===e.originalEvent.type&&0===e.originalEvent.wheelDeltaY||"DOMMouseScroll"===e.originalEvent.type&&1===e.originalEvent.axis)){e.preventDefault();var a=void 0,n=void 0;void 0!==e.pageX&&void 0!==e.pageY?(a=e.pageX,n=e.pageY):e.originalEvent&&void 0!==e.originalEvent.pageX&&void 0!==e.originalEvent.pageY?(a=e.originalEvent.pageX,n=e.originalEvent.pageY):(a=e.x,n=e.y);var r=t.pageToPixel(o,a,n);e=window.event&&window.event.wheelDelta?window.event:e;var l=void 0;l=e.originalEvent&&e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:e.originalEvent&&e.originalEvent.deltaY?-e.originalEvent.deltaY:e.originalEvent&&e.originalEvent.detail?-e.originalEvent.detail:e.wheelDelta;var i=l<0?1:-1,s={element:o,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,direction:i,pageX:a,pageY:n,imageX:r.x,imageY:r.y};(0,d.default)(o,"CornerstoneToolsMouseWheel",s)}}function r(e){l(e),u.default.$(e).on(c,n)}function l(e){u.default.$(e).unbind(c,n)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=a(i),s=o(3),d=a(s),c="mousewheel DOMMouseScroll",f={enable:r,disable:l};t.default=f},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=u.default.cornerstone,o=e.currentTarget||e.srcEvent.currentTarget;if(t.getEnabledElement(o).image){var a=void 0,n=void 0,r=void 0,l=void 0,i=void 0;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length>1)&&(k=!1,clearTimeout(x)),e.type){case"tap":k=!1,clearTimeout(x),T={page:u.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(o,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},T.canvas=t.pixelToCanvas(o,T.image),a="CornerstoneToolsTap",M={event:e,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,currentPoints:T,type:a,isTouchEvent:!0},(0,h.default)(o,a,M);break;case"doubletap":k=!1,clearTimeout(x),T={page:u.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(o,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},T.canvas=t.pixelToCanvas(o,T.image),a="CornerstoneToolsDoubleTap",M={event:e,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,currentPoints:T,type:a,isTouchEvent:!0},(0,h.default)(o,a,M);break;case"pinchstart":k=!1,clearTimeout(x),w=1;break;case"pinchmove":if(k=!1,clearTimeout(x),!0===I){w=e.scale,I=!1;break}n=(e.scale-w)/w,p={page:e.center,image:t.pageToPixel(o,e.center.x,e.center.y)},p.canvas=t.pixelToCanvas(o,p.image),a="CornerstoneToolsTouchPinch",M={event:e,startPoints:p,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,direction:e.scale<1?1:-1,scaleChange:n,type:a,isTouchEvent:!0},(0,h.default)(o,a,M),w=e.scale;break;case"touchstart":w=1,clearTimeout(x),clearTimeout(b),b=setTimeout(function(){p={page:u.default.cornerstoneMath.point.pageToPoint(e.originalEvent.touches[0]),image:t.pageToPixel(o,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}},p.canvas=t.pixelToCanvas(o,p.image),a="CornerstoneToolsTouchStart",e.originalEvent.touches.length>1&&(a="CornerstoneToolsMultiTouchStart"),M={event:e,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,startPoints:p,currentPoints:p,type:a,isTouchEvent:!0},!0===(0,h.default)(o,a,M)&&(a="CornerstoneToolsTouchStartActive",e.originalEvent.touches.length>1&&(a="CornerstoneToolsMultiTouchStartActive"),M.type=a,(0,h.default)(o,a,M)),C=(0,d.default)(p)},50),k=!0,P=0,x=setTimeout(function(){k&&(T={page:u.default.cornerstoneMath.point.pageToPoint(e.originalEvent.touches[0]),image:t.pageToPixel(o,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}},T.canvas=t.pixelToCanvas(o,p.image),a="CornerstoneToolsTouchPress",M={event:e,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,currentPoints:T,type:a,isTouchEvent:!0},(0,h.default)(o,a,M))},_);break;case"touchend":w=1,k=!1,clearTimeout(x),setTimeout(function(){p={page:u.default.cornerstoneMath.point.pageToPoint(e.originalEvent.changedTouches[0]),image:t.pageToPixel(o,e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY),client:{x:e.originalEvent.changedTouches[0].clientX,y:e.originalEvent.changedTouches[0].clientY}},p.canvas=t.pixelToCanvas(o,p.image),a="CornerstoneToolsTouchEnd",M={event:e,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,startPoints:p,currentPoints:p,type:a,isTouchEvent:!0},(0,h.default)(o,a,M)},50);break;case"panmove":r={x:e.deltaX-$.x,y:e.deltaY-$.y},$={x:e.deltaX,y:e.deltaY},T={page:{x:C.page.x+r.x,y:C.page.y+r.y},image:t.pageToPixel(o,C.page.x+r.x,C.page.y+r.y),client:{x:C.client.x+r.x,y:C.client.y+r.y}},T.canvas=t.pixelToCanvas(o,T.image),y={page:u.default.cornerstoneMath.point.subtract(T.page,C.page),image:u.default.cornerstoneMath.point.subtract(T.image,C.image),client:u.default.cornerstoneMath.point.subtract(T.client,C.client),canvas:u.default.cornerstoneMath.point.subtract(T.canvas,C.canvas)},P+=Math.sqrt(y.page.x*y.page.x+y.page.y*y.page.y),P>O&&(k=!1,clearTimeout(x)),a="CornerstoneToolsTouchDrag",e.pointers.length>1&&(a="CornerstoneToolsMultiTouchDrag"),M={viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,startPoints:p,lastPoints:C,currentPoints:T,deltaPoints:y,numPointers:e.pointers.length,type:a,isTouchEvent:!0},(0,h.default)(o,a,M),C=(0,d.default)(T);break;case"panstart":$={x:e.deltaX,y:e.deltaY},T={page:u.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(o,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},T.canvas=t.pixelToCanvas(o,T.image),C=(0,d.default)(T);break;case"panend":return k=!1,clearTimeout(x),!!C&&(T={page:u.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(o,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},T.canvas=t.pixelToCanvas(o,T.image),y={page:u.default.cornerstoneMath.point.subtract(T.page,C.page),image:u.default.cornerstoneMath.point.subtract(T.image,C.image),client:u.default.cornerstoneMath.point.subtract(T.client,C.client),canvas:u.default.cornerstoneMath.point.subtract(T.canvas,C.canvas)},a="CornerstoneToolsDragEnd",M={event:e.srcEvent,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,startPoints:p,lastPoints:C,currentPoints:T,deltaPoints:y,type:a,isTouchEvent:!0},(0,h.default)(o,a,M),l=e.pointers.length-e.changedPointers.length,2===l&&(I=!0),(0,f.default)(e));case"rotatemove":k=!1,clearTimeout(x),i=e.rotation-S,S=e.rotation,a="CornerstoneToolsTouchRotate",M={event:e.srcEvent,viewport:t.getViewport(o),image:t.getEnabledElement(o).image,element:o,rotation:i,type:a},(0,h.default)(o,a,M)}return!1}}function r(e){l(e);var t=u.default.Hammer,o={inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput},a=new t.Manager(e,o),r={pointers:0,direction:t.DIRECTION_ALL,threshold:0},i=new t.Pan(r),s=new t.Pinch({threshold:0}),d=new t.Rotate({threshold:0});s.recognizeWith(i),s.recognizeWith(d),d.recognizeWith(i);var c=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});c.recognizeWith(i),a.add([c,i,d,s]),a.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",n),v.default.enable(e),u.default.$(e).on("touchstart touchend",n),u.default.$(e).data("hammer",a)}function l(e){v.default.disable(e),u.default.$(e).off("touchstart touchend",n);var t=u.default.$(e).data("hammer");t&&t.off("tap doubletap panstart panmove panend pinchmove rotatemove",n)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=a(i),s=o(35),d=a(s),c=o(33),f=a(c),g=o(58),v=a(g),m=o(3),h=a(m),p=void 0,T=void 0,C=void 0,y=void 0,M=void 0,b=void 0,x=void 0,P=void 0,w=1,S=0,I=!1,k=!1,$=void 0,_=700,O=5,D={enable:r,disable:l};t.default=D},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1}}}}function r(e,t,o){var a=s.default.cornerstone,n={start:a.pixelToCanvas(e,t.handles.start),end:a.pixelToCanvas(e,t.handles.end)},r=s.default.cornerstoneMath.lineSegment.distanceToPoint(n,o);return r<5||(n.start=a.pixelToCanvas(e,t.handles.start2),n.end=a.pixelToCanvas(e,t.handles.end2),(r=s.default.cornerstoneMath.lineSegment.distanceToPoint(n,o))<5)}function l(e,t){var o=(0,S.getToolState)(e.currentTarget,O);if(void 0!==o){var a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var n=void 0,r=C.default.getToolWidth(),l=M.default.getFont(),i=D.getConfiguration(),u=s.default.cornerstone,d=0;d<o.data.length;d++){a.save(),i&&i.shadow&&(a.shadowColor=i.shadowColor||"#000000",a.shadowOffsetX=i.shadowOffsetX||1,a.shadowOffsetY=i.shadowOffsetY||1);var c=o.data[d];n=c.active?x.default.getActiveColor():x.default.getToolColor(),a.beginPath(),a.strokeStyle=n,a.lineWidth=r;var f=u.pixelToCanvas(t.element,c.handles.start),g=u.pixelToCanvas(t.element,c.handles.end);a.moveTo(f.x,f.y),a.lineTo(g.x,g.y),f=u.pixelToCanvas(t.element,c.handles.start2),g=u.pixelToCanvas(t.element,c.handles.end2),a.moveTo(f.x,f.y),a.lineTo(g.x,g.y),a.stroke(),(0,w.default)(a,t,c.handles),a.fillStyle=n;var v=(Math.ceil(c.handles.start.x)-Math.ceil(c.handles.end.x))*t.image.columnPixelSpacing,h=(Math.ceil(c.handles.start.y)-Math.ceil(c.handles.end.y))*t.image.rowPixelSpacing,T=(Math.ceil(c.handles.start2.x)-Math.ceil(c.handles.end2.x))*t.image.columnPixelSpacing,y=(Math.ceil(c.handles.start2.y)-Math.ceil(c.handles.end2.y))*t.image.rowPixelSpacing,b=Math.acos(Math.abs((v*T+h*y)/(Math.sqrt(v*v+h*h)*Math.sqrt(T*T+y*y))));b*=180/Math.PI;var P=(0,p.default)(b,2),I=P.toString()+String.fromCharCode(parseInt("00B0",16)),k=(f.x+g.x)/2,$=(f.y+g.y)/2;a.font=l,(0,m.default)(a,I,k,$,n),a.restore()}}}function i(e,t){var o=t.element,a=s.default.cornerstone,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,k.default)(t.which,e.data.mouseButtonMask)){var l=t.currentPoints.canvas,i=(0,S.getToolState)(o,O);if(i)for(var u=0;u<i.data.length;u++)if(n=i.data[u],r(o,n,l)||(0,_.default)(n.handles.textBox,l))return(0,S.removeToolState)(o,O,n),a.updateImage(o),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.angleTouch=t.angle=void 0;var u=o(0),s=a(u),d=o(8),c=a(d),f=o(11),g=a(f),v=o(5),m=a(v),h=o(31),p=a(h),T=o(6),C=a(T),y=o(16),M=a(y),b=o(4),x=a(b),P=o(9),w=a(P),S=o(1),I=o(2),k=a(I),$=o(10),_=a($),O="angle",D=(0,c.default)({mouseDoubleClickCallback:i,createNewMeasurement:n,onImageRendered:l,pointNearTool:r,toolType:O}),E=(0,g.default)({createNewMeasurement:n,onImageRendered:l,pointNearTool:r,toolType:O});t.angle=D,t.angleTouch=E},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){e(prompt("Enter your annotation:"))}function r(e,t,o){o(prompt("Change your annotation:"))}function l(e){function t(t){null===t?(0,V.removeToolState)(e.element,W,o):o.text=t,o.active=!1,a.updateImage(e.element),v.default.$(e.element).on("CornerstoneToolsMouseMove",n,z.mouseMoveCallback),v.default.$(e.element).on("CornerstoneToolsMouseDown",n,z.mouseDownCallback),v.default.$(e.element).on("CornerstoneToolsMouseDownActivate",n,z.mouseDownActivateCallback),v.default.$(e.element).on("CornerstoneToolsMouseDoubleClick",n,z.mouseDoubleClickCallback)}var o=i(e),a=v.default.cornerstone,n={mouseButtonMask:e.which};(0,V.addToolState)(e.element,W,o),v.default.$(e.element).off("CornerstoneToolsMouseMove",z.mouseMoveCallback),v.default.$(e.element).off("CornerstoneToolsMouseDown",z.mouseDownCallback),v.default.$(e.element).off("CornerstoneToolsMouseDownActivate",z.mouseDownActivateCallback),v.default.$(e.element).off("CornerstoneToolsMouseDoubleClick",z.mouseDoubleClickCallback),a.updateImage(e.element),(0,D.default)(e,W,o,o.handles.end,function(){(0,L.default)(e,o.handles)&&(0,V.removeToolState)(e.element,W,o);var n=z.getConfiguration();void 0===o.text&&n.getTextCallback(t),a.updateImage(e.element)})}function i(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function u(e,t,o){var a=v.default.cornerstone,n={start:a.pixelToCanvas(e,t.handles.start),end:a.pixelToCanvas(e,t.handles.end)};return v.default.cornerstoneMath.lineSegment.distanceToPoint(n,o)<25}function s(e,t){var o=(0,V.getToolState)(e.currentTarget,W);if(o){var a=t.enabledElement,n=v.default.cornerstone,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var l=void 0,i=b.default.getToolWidth(),u=P.default.getFont(),s=z.getConfiguration(),d=0;d<o.data.length;d++){r.save(),s&&s.shadow&&(r.shadowColor=s.shadowColor||"#000000",r.shadowOffsetX=s.shadowOffsetX||1,r.shadowOffsetY=s.shadowOffsetY||1);var c=o.data[d];l=c.active?S.default.getActiveColor():S.default.getToolColor();var f=n.pixelToCanvas(t.element,c.handles.start),g=n.pixelToCanvas(t.element,c.handles.end);s.arrowFirst?(0,_.default)(r,g,f,l,i):(0,_.default)(r,f,g,l,i);var m={drawHandlesIfActive:s&&s.drawHandlesOnHover};if(s.drawHandles&&(0,k.default)(r,t,c.handles,l,m),c.text&&""!==c.text){r.font=u;var h=r.measureText(c.text).width+10,p=P.default.getFontSize()+10,T=Math.max(h,p)/2+5;g.x<f.x&&(T=-T);var C=void 0;if(!c.handles.textBox.hasMoved){C=s.arrowFirst?{x:g.x-h/2+T,y:g.y-p/2}:{x:f.x-h/2-T,y:f.y-p/2};var M=n.internal.getTransform(a);M.invert();var x=M.transformPoint(C.x,C.y);c.handles.textBox.x=x.x,c.handles.textBox.y=x.y}C=n.pixelToCanvas(t.element,c.handles.textBox);var w=(0,y.default)(r,c.text,C.x,C.y,l);if(c.handles.textBox.boundingBox=w,c.handles.textBox.hasMoved){var I={start:{},end:{}},$={x:(f.x+g.x)/2,y:(f.y+g.y)/2},O=[f,g,$];I.end.x=C.x,I.end.y=C.y,I.start=v.default.cornerstoneMath.point.findClosestPoint(O,I.end);var D=[{x:w.left+w.width/2,y:w.top},{x:w.left,y:w.top+w.height/2},{x:w.left+w.width/2,y:w.top+w.height},{x:w.left+w.width,y:w.top+w.height/2}];I.end=v.default.cornerstoneMath.point.findClosestPoint(D,I.start),r.beginPath(),r.strokeStyle=l,r.lineWidth=i,r.setLineDash([2,3]),r.moveTo(I.start.x,I.start.y),r.lineTo(I.end.x,I.end.y),r.stroke()}}r.restore()}}}function d(e){function t(e){null===e?(0,V.removeToolState)(o,W,a):a.text=e,a.active=!1,n.updateImage(o),v.default.$(o).on("CornerstoneToolsTouchPress",F.pressCallback),v.default.$(o).on("CornerstoneToolsTouchStartActive",F.touchDownActivateCallback),v.default.$(o).on("CornerstoneToolsTap",F.tapCallback)}var o=e.element,a=i(e),n=v.default.cornerstone;(0,V.addToolState)(o,W,a),v.default.$(o).off("CornerstoneToolsTouchPress",F.pressCallback),v.default.$(o).off("CornerstoneToolsTouchStartActive",F.touchDownActivateCallback),v.default.$(o).off("CornerstoneToolsTap",F.tapCallback),n.updateImage(o),(0,j.default)(e,W,a,a.handles.end,function(){n.updateImage(o),(0,L.default)(e,a.handles)&&(0,V.removeToolState)(o,W,a);var r=z.getConfiguration();void 0===a.text&&r.getTextCallback(t)})}function c(e,t){function o(e,t,o){!0===o?(0,V.removeToolState)(a,W,e):e.text=t,e.active=!1,n.updateImage(a)}var a=t.element,n=v.default.cornerstone,r=void 0;if(!(e.data&&e.data.mouseButtonMask&&(0,R.default)(t.which,e.data.mouseButtonMask))){var l=z.getConfiguration(),i=t.currentPoints.canvas,s=(0,V.getToolState)(a,W);if(s)for(var d=0;d<s.data.length;d++)if(r=s.data[d],u(a,r,i)||(0,N.default)(r.handles.textBox,i))return r.active=!0,n.updateImage(a),l.changeTextCallback(r,t,o),e.stopImmediatePropagation(),!1}}function f(e,t){function o(e,t,o){console.log("pressCallback doneChangingTextCallback"),!0===o?(0,V.removeToolState)(a,W,e):e.text=t,e.active=!1,n.updateImage(a),v.default.$(a).on("CornerstoneToolsTouchStart",F.touchStartCallback),v.default.$(a).on("CornerstoneToolsTouchStartActive",F.touchDownActivateCallback),v.default.$(a).on("CornerstoneToolsTap",F.tapCallback)}var a=t.element,n=v.default.cornerstone,r=void 0;if(!e.data||!e.data.mouseButtonMask||(0,R.default)(t.which,e.data.mouseButtonMask)){var l=z.getConfiguration(),i=t.currentPoints.canvas,s=(0,V.getToolState)(a,W);if(s){if(t.handlePressed)return v.default.$(a).off("CornerstoneToolsTouchStart",F.touchStartCallback),v.default.$(a).off("CornerstoneToolsTouchStartActive",F.touchDownActivateCallback),v.default.$(a).off("CornerstoneToolsTap",F.tapCallback),l.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var d=0;d<s.data.length;d++)if(r=s.data[d],u(a,r,i)||(0,N.default)(r.handles.textBox,i))return r.active=!0,n.updateImage(a),v.default.$(a).off("CornerstoneToolsTouchStart",F.touchStartCallback),v.default.$(a).off("CornerstoneToolsTouchStartActive",F.touchDownActivateCallback),v.default.$(a).off("CornerstoneToolsTap",F.tapCallback),l.changeTextCallback(r,t,o),e.stopImmediatePropagation(),!1;return!1}}}Object.defineProperty(t,"__esModule",{value:!0}),t.arrowAnnotateTouch=t.arrowAnnotate=void 0;var g=o(0),v=a(g),m=o(8),h=a(m),p=o(11),T=a(p),C=o(5),y=a(C),M=o(6),b=a(M),x=o(16),P=a(x),w=o(4),S=a(w),I=o(9),k=a(I),$=o(53),_=a($),O=o(25),D=a(O),E=o(27),j=a(E),A=o(14),L=a(A),B=o(2),R=a(B),H=o(10),N=a(H),V=o(1),W="arrowAnnotate",Y={getTextCallback:n,changeTextCallback:r,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},z=(0,h.default)({addNewMeasurement:l,createNewMeasurement:i,onImageRendered:s,pointNearTool:u,toolType:W,mouseDoubleClickCallback:c});z.setConfiguration(Y);var F=(0,T.default)({addNewMeasurement:d,createNewMeasurement:i,onImageRendered:s,pointNearTool:u,toolType:W,pressCallback:f});t.arrowAnnotate=z,t.arrowAnnotateTouch=F},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){e.stopImmediatePropagation();var o=(0,C.getToolState)(e.currentTarget,w);if(o){var a=h.default.cornerstone,n=e.currentTarget,r=a.getEnabledElement(n),l=r.image.imageId,i=a.metaData.get("imagePlaneModule",l),u=t.currentPoints.image,s=(0,b.imagePointToPatientPoint)(u,i);o.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==n){var t=Number.MAX_VALUE,o=-1,r=(0,C.getToolState)(e,"stack");if(void 0!==r){var l=r.data[0];if(l.imageIds.forEach(function(e,n){var r=a.metaData.get("imagePlaneModule",e),l=(0,P.default)(r.imagePositionPatient),i=(0,P.default)(r.rowCosines),u=(0,P.default)(r.columnCosines),d=u.clone().cross(i.clone()),c=Math.abs(d.clone().dot(l)-d.clone().dot(s));c<t&&(t=c,o=n)}),o!==l.currentImageIdIndex&&-1!==o&&void 0!==l.imageIds[o]){var i=T.default.getStartLoadHandler(),u=T.default.getEndLoadHandler(),d=T.default.getErrorLoadingHandler();i&&i(e);var c=void 0;c=!0===l.preventCache?a.loadImage(l.imageIds[o]):a.loadAndCacheImage(l.imageIds[o]),c.then(function(t){var n=a.getViewport(e);l.currentImageIdIndex=o,a.displayImage(e,t,n),u&&u(e,t)},function(t){var a=l.imageIds[o];d&&d(e,a,t)})}}}})}}function r(e,t){h.default.$(t.element).off("CornerstoneToolsMouseDrag",i),h.default.$(t.element).off("CornerstoneToolsMouseUp",r)}function l(e,t){if((0,M.default)(t.which,e.data.mouseButtonMask))return h.default.$(t.element).on("CornerstoneToolsMouseDrag",i),h.default.$(t.element).on("CornerstoneToolsMouseUp",r),n(e,t),!1}function i(e,t){return n(e,t),!1}function u(e,t,o){var a={mouseButtonMask:t};(0,C.clearToolState)(e,w),(0,C.addToolState)(e,w,{synchronizationContext:o}),h.default.$(e).off("CornerstoneToolsMouseDown",l),h.default.$(e).on("CornerstoneToolsMouseDown",a,l)}function s(e){h.default.$(e).off("CornerstoneToolsMouseDown",l)}function d(e,t){h.default.$(t.element).off("CornerstoneToolsTouchDrag",f),h.default.$(t.element).off("CornerstoneToolsDragEnd",d)}function c(e,t){return h.default.$(t.element).on("CornerstoneToolsTouchDrag",f),h.default.$(t.element).on("CornerstoneToolsDragEnd",d),n(e,t),!1}function f(e,t){return n(e,t),!1}function g(e,t){(0,C.clearToolState)(e,w),(0,C.addToolState)(e,w,{synchronizationContext:t}),h.default.$(e).off("CornerstoneToolsTouchStart",c),h.default.$(e).on("CornerstoneToolsTouchStart",c)}function v(e){h.default.$(e).off("CornerstoneToolsTouchStart",c)}Object.defineProperty(t,"__esModule",{value:!0}),t.crosshairsTouch=t.crosshairs=void 0;var m=o(0),h=a(m),p=o(7),T=a(p),C=o(1),y=o(2),M=a(y),b=o(28),x=o(15),P=a(x),w="crosshairs",S={activate:u,deactivate:s,enable:u,disable:s},I={activate:g,deactivate:v,enable:g,disable:v};t.crosshairs=S,t.crosshairsTouch=I},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){i.default.cornerstone.fitToWindow(e.element)}function r(e,t){return d.strategy(t),!1}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),i=a(l),u=o(59),s=a(u),d=(0,s.default)(r);d.strategies={default:n},d.strategy=n,t.default=d},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=c.default.cornerstone,o=t.getEnabledElement(e.element),a=o.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);var n=C.default.getActiveColor(),r=p.default.getFont(),l=p.default.getFontSize(),i=$.getConfiguration();a.save(),i&&i.shadow&&(a.shadowColor=i.shadowColor||"#000000",a.shadowOffsetX=i.shadowOffsetX||1,a.shadowOffsetY=i.shadowOffsetY||1);var u=Math.round(e.currentPoints.image.x),s=Math.round(e.currentPoints.image.y),d=void 0,f=void 0,g=void 0;if(!(u<0||s<0||u>=e.image.columns||s>=e.image.rows)){if(e.image.color)d=(0,x.default)(e.element,u,s,1,1),f=u+", "+s,g="R: "+d[0]+" G: "+d[1]+" B: "+d[2]+" A: "+d[3];else{d=t.getStoredPixels(e.element,u,s,1,1);var v=d[0],m=v*e.image.slope+e.image.intercept,h=(0,w.default)(e.image,v);f=u+", "+s,g="SP: "+v+" MO: "+parseFloat(m.toFixed(3)),h&&(g+=" SUV: "+parseFloat(h.toFixed(3)))}var T={x:e.currentPoints.image.x+3,y:e.currentPoints.image.y-3},y=t.pixelToCanvas(e.element,T);a.font=r,a.fillStyle=n,(0,M.default)(a,g,y.x,y.y+l+5,n),(0,M.default)(a,f,y.x,y.y,n),a.restore()}}function r(e){var t=c.default.cornerstone,o=e.element,a=t.getEnabledElement(o),n=a.image,r=a.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);var l=C.default.getActiveColor(),i=p.default.getFont(),u=$.getConfiguration();r.save(),u&&u.shadow&&(r.shadowColor=u.shadowColor||"#000000",r.shadowOffsetX=u.shadowOffsetX||1,r.shadowOffsetY=u.shadowOffsetY||1);var s=t.metaData.get("generalSeriesModule",n.imageId),d=void 0;s&&(d=s.modality);var f=void 0;f=!0===e.isTouchEvent?t.pageToPixel(o,e.currentPoints.page.x,e.currentPoints.page.y-4*p.default.getFontSize()):t.pageToPixel(o,e.currentPoints.page.x,e.currentPoints.page.y-p.default.getFontSize()/2);var g=void 0,v="";if(!(f.x<0||f.y<0||f.x>=n.columns||f.y>=n.rows)){if(n.color)g=(0,x.default)(o,f.x,f.y,1,1),v="R: "+g[0]+" G: "+g[1]+" B: "+g[2];else{g=t.getStoredPixels(o,f.x,f.y,1,1);var m=g[0],h=m*e.image.slope+e.image.intercept,T=parseFloat(h.toFixed(2));if("CT"===d)v+="HU: "+T;else if("PT"===d){v+=T;var y=(0,w.default)(e.image,m);y&&(v+=" SUV: "+parseFloat(y.toFixed(2)))}else v+=T}var b=t.pixelToCanvas(o,f);r.font=i,r.fillStyle=l;var P=void 0,S=r.measureText(v).width;P=!0===e.isTouchEvent?{x:-S/2-5,y:-p.default.getFontSize()-10-12}:{x:12,y:-(p.default.getFontSize()+10)/2},r.beginPath(),r.strokeStyle=l,r.arc(b.x,b.y,6,0,2*Math.PI),r.stroke(),(0,M.default)(r,v,b.x+P.x,b.y+P.y,l),r.restore()}}function l(e,t){var o=t.element;o.removeEventListener("cornerstoneimagerendered",u),c.default.$(o).off("CornerstoneToolsMouseDrag",s),c.default.$(o).off("CornerstoneToolsMouseUp",l),c.default.$(o).off("CornerstoneToolsMouseClick",l),c.default.cornerstone.updateImage(t.element)}function i(e,t){var o=t.element;if((0,I.default)(t.which,e.data.mouseButtonMask))return o.addEventListener("cornerstoneimagerendered",u),c.default.$(o).on("CornerstoneToolsMouseDrag",s),c.default.$(o).on("CornerstoneToolsMouseUp",l),c.default.$(o).on("CornerstoneToolsMouseClick",l),$.strategy(t),!1}function u(){k&&($.strategy(k),k=null)}function s(e,t){var o=t.element;return k=t,c.default.cornerstone.updateImage(o),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.dragProbeTouch=t.dragProbe=void 0;var d=o(0),c=a(d),f=o(13),g=a(f),v=o(12),m=a(v),h=o(16),p=a(h),T=o(4),C=a(T),y=o(5),M=a(y),b=o(34),x=a(b),P=o(19),w=a(P),S=o(2),I=a(S),k=void 0,$=(0,g.default)(i);$.strategies={default:n,minimal:r},$.strategy=n;var _={fireOnTouchStart:!0},O=(0,m.default)(s,_);t.dragProbe=$,t.dragProbeTouch=O},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function r(e,t,o,a){var n=f.default.cornerstone,r=n.pixelToCanvas(e,t.handles.start),l=n.pixelToCanvas(e,t.handles.end),i={left:Math.min(r.x,l.x)+a/2,top:Math.min(r.y,l.y)+a/2,width:Math.abs(r.x-l.x)-a,height:Math.abs(r.y-l.y)-a},u={left:Math.min(r.x,l.x)-a/2,top:Math.min(r.y,l.y)-a/2,width:Math.abs(r.x-l.x)+a,height:Math.abs(r.y-l.y)+a},s=(0,k.default)(i,o);return!(!(0,k.default)(u,o)||s)}function l(e,t,o){return r(e,t,o,15)}function i(e,t,o){return r(e,t,o,25)}function u(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function s(e,t){var o=(0,E.getToolState)(e.currentTarget,R);if(o){var a=f.default.cornerstone,n=t.image,r=t.element,l=T.default.getToolWidth(),i=H.getConfiguration(),s=t.canvasContext.canvas.getContext("2d"),d=a.metaData.get("generalSeriesModule",n.imageId),c=void 0;d&&(c=d.modality),s.setTransform(1,0,0,1,0,0);for(var g=0;g<o.data.length;g++){s.save();var v=o.data[g];i&&i.shadow&&(s.shadowColor=i.shadowColor||"#000000",s.shadowOffsetX=i.shadowOffsetX||1,s.shadowOffsetY=i.shadowOffsetY||1);var m=y.default.getColorIfActive(v.active),h=a.pixelToCanvas(r,v.handles.start),p=a.pixelToCanvas(r,v.handles.end),C=Math.min(h.x,p.x),M=Math.min(h.y,p.y),x=Math.abs(h.x-p.x),w=Math.abs(h.y-p.y);if(s.beginPath(),s.strokeStyle=m,s.lineWidth=l,(0,S.default)(s,C,M,x,w),s.closePath(),i&&i.drawHandlesOnHover)if(!0===v.active)(0,b.default)(s,t,v.handles,m);else{var I={drawHandlesIfActive:!0};(0,b.default)(s,t,v.handles,m,I)}else(0,b.default)(s,t,v.handles,m);var k=void 0,$=void 0,O=void 0;if(!1===v.invalidated)$=v.meanStdDev,O=v.meanStdDevSUV,k=v.area;else{var j={left:Math.round(Math.min(v.handles.start.x,v.handles.end.x)),top:Math.round(Math.min(v.handles.start.y,v.handles.end.y)),width:Math.round(Math.abs(v.handles.start.x-v.handles.end.x)),height:Math.round(Math.abs(v.handles.start.y-v.handles.end.y))};if(!n.color){var A=a.getPixels(r,j.left,j.top,j.width,j.height);$=(0,_.default)(A,j),"PT"===c&&(O={mean:(0,D.default)(n,($.mean-n.intercept)/n.slope),stdDev:(0,D.default)(n,($.stdDev-n.intercept)/n.slope)}),$&&!isNaN($.mean)&&(v.meanStdDev=$,v.meanStdDevSUV=O)}var L=n.columnPixelSpacing||1,B=n.rowPixelSpacing||1;k=Math.PI*(j.width*L/2)*(j.height*B/2),isNaN(k)||(v.area=k),v.invalidated=!1}var N=[];if($&&void 0!==$.mean){var V="";"CT"===c&&(V=" HU");var W=": "+u($.mean.toFixed(2))+V,Y=": "+u($.stdDev.toFixed(2))+V;if(O&&void 0!==O.mean){W+=" SUV: "+u(O.mean.toFixed(2)),Y+=" SUV: "+u(O.stdDev.toFixed(2))}N.push(W),N.push(Y)}if(k){var z=" mm"+String.fromCharCode(178);n.rowPixelSpacing&&n.columnPixelSpacing||(z=" pixels"+String.fromCharCode(178));var F=": "+u(k.toFixed(2))+z;N.push(F)}v.handles.textBox.hasMoved||(v.handles.textBox.x=Math.max(v.handles.start.x,v.handles.end.x),v.handles.textBox.y=(v.handles.start.y+v.handles.end.y)/2);var U=a.pixelToCanvas(r,v.handles.textBox),X={centering:{x:!1,y:!0}},q=(0,P.default)(s,N,U.x,U.y,m,X);if(v.handles.textBox.boundingBox=q,v.handles.textBox.hasMoved){var K={start:{},end:{x:U.x,y:U.y}},G=[{x:C+x/2,y:M},{x:C,y:M+w/2},{x:C+x/2,y:M+w},{x:C+x,y:M+w/2}];K.start=f.default.cornerstoneMath.point.findClosestPoint(G,K.end);var Z=[{x:q.left+q.width/2,y:q.top},{x:q.left,y:q.top+q.height/2},{x:q.left+q.width/2,y:q.top+q.height},{x:q.left+q.width,y:q.top+q.height/2}];K.end=f.default.cornerstoneMath.point.findClosestPoint(Z,K.start),s.beginPath(),s.strokeStyle=m,s.lineWidth=l,s.setLineDash([2,3]),s.moveTo(K.start.x,K.start.y),s.lineTo(K.end.x,K.end.y),s.stroke()}s.restore()}}}function d(e,t){var o=t.element,a=f.default.cornerstone,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,A.default)(t.which,e.data.mouseButtonMask)){var r=t.currentPoints.canvas,i=(0,E.getToolState)(o,R);if(i)for(var u=0;u<i.data.length;u++)if(n=i.data[u],l(o,n,r)||(0,B.default)(n.handles.textBox,r))return(0,E.removeToolState)(o,R,n),a.updateImage(o),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.ellipticalRoiTouch=t.ellipticalRoi=void 0;var c=o(0),f=a(c),g=o(8),v=a(g),m=o(11),h=a(m),p=o(6),T=a(p),C=o(4),y=a(C),M=o(9),b=a(M),x=o(5),P=a(x),w=o(51),S=a(w),I=o(32),k=a(I),$=o(54),_=a($),O=o(19),D=a(O),E=o(1),j=o(2),A=a(j),L=o(10),B=a(L),R="ellipticalRoi",H=(0,v.default)({mouseDoubleClickCallback:d,createNewMeasurement:n,onImageRendered:s,pointNearTool:l,toolType:R}),N=(0,h.default)({createNewMeasurement:n,onImageRendered:s,pointNearTool:i,toolType:R});t.ellipticalRoi=H,t.ellipticalRoiTouch=N},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=(0,$.getToolState)(e.element,_);if(void 0!==t){var o=D.getConfiguration(),a=t.data[o.currentTool],n={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,lines:[]};a.handles.length&&a.handles[o.currentHandle-1].lines.push(e.currentPoints.image),a.handles.push(n),o.currentHandle+=1,o.freehand=!1,y.default.cornerstone.updateImage(e.element)}}function r(e,t){var o=(0,$.getToolState)(e.element,_);if(void 0!==o){var a=o.data[t];if(void 0!==a.handles)for(var n=e.currentPoints.canvas,r=0;r<a.handles.length;r++){var l=y.default.cornerstone.pixelToCanvas(e.element,a.handles[r]);if(y.default.cornerstoneMath.point.distance(l,n)<5)return r}}}function l(e){var t=(0,$.getToolState)(e.element,_);if(t)for(var o=void 0,a=0;a<t.data.length;a++)if(void 0!==(o=r(e,a)))return{handleNearby:o,toolIndex:a}}function i(e,t){if(y.default.$(t.element).off("CornerstoneToolsMouseUp",i),void 0!==(0,$.getToolState)(t.element,_)){var o=D.getConfiguration();t.event.shiftKey||(o.freehand=!1),y.default.cornerstone.updateImage(t.element)}}function u(e,t){var o=(0,$.getToolState)(t.element,_);if(o){var a=D.getConfiguration(),n=o.data[a.currentTool],l=Math.max(t.currentPoints.image.x,0);l=Math.min(l,t.image.width),a.mouseLocation.handles.start.x=l;var i=Math.max(t.currentPoints.image.y,0);i=Math.min(i,t.image.height),a.mouseLocation.handles.start.y=i;var u=a.currentHandle;if(a.modifying&&(n.active=!0,n.highlight=!0,n.handles[u].x=a.mouseLocation.handles.start.x,n.handles[u].y=a.mouseLocation.handles.start.y,u)){var s=n.handles[u-1].lines.length-1,d=n.handles[u-1].lines[s];d.x=a.mouseLocation.handles.start.x,d.y=a.mouseLocation.handles.start.y}if(a.freehand)n.handles[u-1].lines.push(t.currentPoints.image);else{var c=r(t,a.currentTool);void 0!==c&&c<n.handles.length-1&&(a.mouseLocation.handles.start.x=n.handles[c].x,a.mouseLocation.handles.start.y=n.handles[c].y)}y.default.cornerstone.updateImage(t.element)}}function s(e){y.default.$(e.element).on("CornerstoneToolsMouseMove",u),y.default.$(e.element).on("CornerstoneToolsMouseUp",i);var t={visible:!0,active:!0,handles:[]},o=D.getConfiguration();o.mouseLocation.handles.start.x=e.currentPoints.image.x,o.mouseLocation.handles.start.y=e.currentPoints.image.y,(0,$.addToolState)(e.element,_,t);var a=(0,$.getToolState)(e.element,_);o.currentTool=a.data.length-1}function d(e,t){var o=(0,$.getToolState)(e.element,_);if(o){var a=D.getConfiguration(),n=o.data[a.currentTool];n.active=!1,n.highlight=!1,void 0!==t&&n.handles[a.currentHandle-1].lines.push({x:n.handles[t].x,y:n.handles[t].y}),a.modifying&&(a.modifying=!1),a.currentHandle=0,a.currentTool=-1,y.default.$(e.element).off("CornerstoneToolsMouseMove",u),y.default.cornerstone.updateImage(e.element)}}function c(e,t){if((0,k.default)(t.which,e.data.mouseButtonMask)){var o=(0,$.getToolState)(t.element,_),a=void 0,c=void 0,f=D.getConfiguration(),g=f.currentTool;if(f.modifying)return void d(t);if(g<0){var v=l(t);v?(a=v.handleNearby,c=v.toolIndex,void 0!==a&&(y.default.$(t.element).on("CornerstoneToolsMouseMove",u),y.default.$(t.element).on("CornerstoneToolsMouseUp",i),f.modifying=!0,f.currentHandle=a,f.currentTool=c)):(s(t),n(t))}else g>=0&&o.data[g].active&&(a=r(t,g),void 0!==a?d(t,a):t.event.shiftKey?f.freehand=!0:n(t));return!1}}function f(e){var t=e.detail,o=(0,$.getToolState)(e.currentTarget,_);if(void 0!==o){var a=y.default.cornerstone,n=D.getConfiguration(),r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var l=void 0,i=b.default.getToolWidth(),u=P.default.getFillColor(),s=0;s<o.data.length;s++){r.save();var d=o.data[s];d.active?(l=P.default.getActiveColor(),u=P.default.getFillColor()):(l=P.default.getToolColor(),u=P.default.getToolColor());var c=void 0;if(d.handles.length)for(var f=0;f<d.handles.length;f++){c=d.handles[f];var g=a.pixelToCanvas(t.element,c);r.beginPath(),r.strokeStyle=l,r.lineWidth=i,r.moveTo(g.x,g.y);for(var v=0;v<d.handles[f].lines.length;v++){var m=a.pixelToCanvas(t.element,d.handles[f].lines[v]);r.lineTo(m.x,m.y),r.stroke()}var h=a.pixelToCanvas(t.element,n.mouseLocation.handles.start);f===d.handles.length-1&&(!d.active||n.freehand||n.modifying||(r.lineTo(h.x,h.y),r.stroke()))}var p={fill:u};d.active&&(0,S.default)(r,t,n.mouseLocation.handles,l,p),(0,S.default)(r,t,d.handles,l,p),r.restore()}}}function g(e){y.default.$(e).off("CornerstoneToolsMouseDown",c),y.default.$(e).off("CornerstoneToolsMouseUp",i),y.default.$(e).off("CornerstoneToolsMouseMove",u),e.removeEventListener("cornerstoneimagerendered",f),e.addEventListener("cornerstoneimagerendered",f),y.default.cornerstone.updateImage(e)}function v(e){y.default.$(e).off("CornerstoneToolsMouseDown",c),y.default.$(e).off("CornerstoneToolsMouseUp",i),y.default.$(e).off("CornerstoneToolsMouseMove",u),e.removeEventListener("cornerstoneimagerendered",f),y.default.cornerstone.updateImage(e)}function m(e,t){var o={mouseButtonMask:t};y.default.$(e).off("CornerstoneToolsMouseDown",o,c),y.default.$(e).off("CornerstoneToolsMouseUp",i),y.default.$(e).off("CornerstoneToolsMouseMove",u),e.removeEventListener("cornerstoneimagerendered",f),e.addEventListener("cornerstoneimagerendered",f),y.default.$(e).on("CornerstoneToolsMouseDown",o,c),y.default.cornerstone.updateImage(e)}function h(e){y.default.$(e).off("CornerstoneToolsMouseDown",c),y.default.$(e).off("CornerstoneToolsMouseUp",i),y.default.$(e).off("CornerstoneToolsMouseMove",u),e.removeEventListener("cornerstoneimagerendered",f),e.addEventListener("cornerstoneimagerendered",f),y.default.cornerstone.updateImage(e)}function p(){return O}function T(e){O=e}Object.defineProperty(t,"__esModule",{value:!0}),t.freehand=void 0;var C=o(0),y=a(C),M=o(6),b=a(M),x=o(4),P=a(x),w=o(9),S=a(w),I=o(2),k=a(I),$=o(1),_="freehand",O={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},freehand:!1,modifying:!1,currentHandle:0,currentTool:-1},D={enable:g,disable:v,activate:m,deactivate:h,getConfiguration:p,setConfiguration:T};t.freehand=D},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=(0,y.getToolState)(e.event.currentTarget,M);if(!(t&&t.data&&t.data.length>0)){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}}function r(e,t,o){var a=s.default.cornerstone,n=a.pixelToCanvas(e,t.handles.start),r=a.pixelToCanvas(e,t.handles.end),l={left:Math.min(n.x,r.x),top:Math.min(n.y,r.y),width:Math.abs(n.x-r.x),height:Math.abs(n.y-r.y)},i=!1;return o.x>=l.left&&o.x<=l.left+l.width&&o.y>=l.top&&o.y<=l.top+l.height&&(i=!0),i}function l(e,t,o){var a=s.default.cornerstone,n=a.pixelToCanvas(e,t.handles.start),r=a.pixelToCanvas(e,t.handles.end),l={left:Math.min(n.x,r.x),top:Math.min(n.y,r.y),width:Math.abs(n.x-r.x),height:Math.abs(n.y-r.y)};return s.default.cornerstoneMath.rect.distanceToPoint(l,o)<5}function i(e,t){var o=(0,y.getToolState)(e.currentTarget,M);if(void 0!==o){var a=s.default.cornerstone,n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);var r=void 0,l=m.default.getToolWidth();n.save();var i=o.data[0];if(i){r=i.active?p.default.getActiveColor():p.default.getToolColor();var u=a.pixelToCanvas(t.element,i.handles.start),d=a.pixelToCanvas(t.element,i.handles.end),c={left:Math.min(u.x,d.x),top:Math.min(u.y,d.y),width:Math.abs(u.x-d.x),height:Math.abs(u.y-d.y)};n.beginPath(),n.strokeStyle="transparent",n.rect(0,0,n.canvas.clientWidth,n.canvas.clientHeight),n.rect(c.width+c.left,c.top,-c.width,c.height),n.stroke(),n.fillStyle="rgba(0,0,0,0.7)",n.fill(),n.closePath(),n.beginPath(),n.strokeStyle=r,n.lineWidth=l,n.setLineDash([4]),n.strokeRect(c.left,c.top,c.width,c.height),n.setLineDash([]),(0,C.default)(n,t,i.handles,r),n.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.highlightTouch=t.highlight=void 0;var u=o(0),s=a(u),d=o(60),c=a(d),f=o(11),g=a(f),v=o(6),m=a(v),h=o(4),p=a(h),T=o(9),C=a(T),y=o(1),M="highlight",b=(0,c.default)({createNewMeasurement:n,onImageRendered:i,pointNearTool:l,pointInsideRect:r,toolType:M},!0),x=(0,g.default)({createNewMeasurement:n,onImageRendered:i,pointNearTool:l,pointInsideRect:r,toolType:M},!0);t.highlight=b,t.highlightTouch=x},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=t.image,a=o.stats,n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);var r=[];Object.keys(a).forEach(function(e){var t=e+" : "+a[e];r.push(t)}),(0,u.default)(n,r,0,0,"orange"),r.forEach(function(e){console.log(e)})}Object.defineProperty(t,"__esModule",{value:!0});var r=o(26),l=a(r),i=o(5),u=a(i),s=(0,l.default)(n);t.default=s},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function r(e,t,o){var a=s.default.cornerstone,n={start:a.pixelToCanvas(e,t.handles.start),end:a.pixelToCanvas(e,t.handles.end)};return s.default.cornerstoneMath.lineSegment.distanceToPoint(n,o)<25}function l(e,t){var o=(0,b.getToolState)(e.currentTarget,I);if(o){var a=s.default.cornerstone,n=t.canvasContext.canvas.getContext("2d"),r=t.image,l=t.element;n.setTransform(1,0,0,1,0,0);var i=p.default.getToolWidth(),u=k.getConfiguration(),d=a.metaData.get("imagePlaneModule",r.imageId),c=void 0,f=void 0;d?(c=d.rowPixelSpacing||d.rowImagePixelSpacing,f=d.columnPixelSpacing||d.colImagePixelSpacing):(c=r.rowPixelSpacing,f=r.columnPixelSpacing);for(var g=0;g<o.data.length;g++){n.save(),u&&u.shadow&&(n.shadowColor=u.shadowColor||"#000000",n.shadowOffsetX=u.shadowOffsetX||1,n.shadowOffsetY=u.shadowOffsetY||1);var v=o.data[g],h=C.default.getColorIfActive(v.active),T=a.pixelToCanvas(l,v.handles.start),y=a.pixelToCanvas(l,v.handles.end);n.beginPath(),n.strokeStyle=h,n.lineWidth=i,n.moveTo(T.x,T.y),n.lineTo(y.x,y.y),n.stroke();var x={drawHandlesIfActive:u&&u.drawHandlesOnHover};(0,M.default)(n,t,v.handles,h,x),n.fillStyle=h;var P=(v.handles.end.x-v.handles.start.x)*(c||1),w=(v.handles.end.y-v.handles.start.y)*(f||1),S=Math.sqrt(P*P+w*w);v.length=S;var $=" mm";c&&f||($=" pixels");var _=""+S.toFixed(2)+$;if(!v.handles.textBox.hasMoved){var O={x:Math.max(v.handles.start.x,v.handles.end.x)};O.x===v.handles.start.x?O.y=v.handles.start.y:O.y=v.handles.end.y,v.handles.textBox.x=O.x,v.handles.textBox.y=O.y}var D=a.pixelToCanvas(t.element,v.handles.textBox);D.x+=10;var E={centering:{x:!1,y:!0}},j=(0,m.default)(n,_,D.x,D.y,h,E);if(v.handles.textBox.boundingBox=j,v.handles.textBox.hasMoved){var A={start:{},end:{}},L={x:(T.x+y.x)/2,y:(T.y+y.y)/2},B=[T,y,L];A.end.x=D.x,A.end.y=D.y,A.start=s.default.cornerstoneMath.point.findClosestPoint(B,A.end);var R=[{x:j.left+j.width/2,y:j.top},{x:j.left,y:j.top+j.height/2},{x:j.left+j.width/2,y:j.top+j.height},{x:j.left+j.width,y:j.top+j.height/2}];A.end=s.default.cornerstoneMath.point.findClosestPoint(R,A.start),n.beginPath(),n.strokeStyle=h,n.lineWidth=i,n.setLineDash([2,3]),n.moveTo(A.start.x,A.start.y),n.lineTo(A.end.x,A.end.y),n.stroke()}n.restore()}}}function i(e,t){var o=t.element,a=s.default.cornerstone,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,P.default)(t.which,e.data.mouseButtonMask)){var l=t.currentPoints.canvas,i=(0,b.getToolState)(o,I);if(i)for(var u=0;u<i.data.length;u++)if(n=i.data[u],r(o,n,l)||(0,S.default)(n.handles.textBox,l))return(0,b.removeToolState)(o,I,n),a.updateImage(o),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthTouch=t.length=void 0;var u=o(0),s=a(u),d=o(8),c=a(d),f=o(11),g=a(f),v=o(5),m=a(v),h=o(6),p=a(h),T=o(4),C=a(T),y=o(9),M=a(y),b=o(1),x=o(2),P=a(x),w=o(10),S=a(w),I="length",k=(0,c.default)({mouseDoubleClickCallback:i,createNewMeasurement:n,onImageRendered:l,pointNearTool:r,toolType:I}),$=(0,g.default)({createNewMeasurement:n,onImageRendered:l,pointNearTool:r,toolType:I});t.length=k,t.lengthTouch=$},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=t.element;C.default.$(o).off("CornerstoneToolsMouseDrag",s),C.default.$(o).off("CornerstoneToolsMouseUp",n),C.default.$(o).off("CornerstoneToolsMouseClick",n),o.removeEventListener("cornerstonenewimage",i),r(t)}function r(e){C.default.$(e.element).find(".magnifyTool").hide(),document.body.style.cursor="default"}function l(e,t){var o=t.element;if((0,P.default)(t.which,e.data.mouseButtonMask))return C.default.$(o).on("CornerstoneToolsMouseDrag",t,s),C.default.$(o).on("CornerstoneToolsMouseUp",t,n),C.default.$(o).on("CornerstoneToolsMouseClick",t,n),I=t.currentPoints,o.addEventListener("cornerstonenewimage",i),d(t),!1}function i(e){var t=e.detail;t.currentPoints=I,d(t)}function u(e,t){var o=t.element;C.default.$(t.element).off("CornerstoneToolsDragEnd",u),C.default.$(t.element).off("CornerstoneToolsTouchEnd",u),o.removeEventListener("cornerstonenewimage",i),r(t)}function s(e,t){return I=t.currentPoints,d(t),!0===t.isTouchEvent&&(C.default.$(t.element).on("CornerstoneToolsDragEnd",u),C.default.$(t.element).on("CornerstoneToolsTouchEnd",u)),!1}function d(e){var t=C.default.$(e.element).find(".magnifyTool").get(0);t||c(e.element);var o=k.getConfiguration(),a=o.magnifySize,n=o.magnificationLevel,r=C.default.$(e.element).find("canvas").not(".magnifyTool").get(0);r.getContext("2d").setTransform(1,0,0,1,0,0);var l=t.getContext("2d");l.setTransform(1,0,0,1,0,0);var i=a/n,u=C.default.cornerstone.pixelToCanvas(e.element,e.currentPoints.image);!0===e.isTouchEvent&&(u.y-=1.25*i),u.x=Math.max(u.x,0),u.x=Math.min(u.x,r.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,r.height),l.clearRect(0,0,a,a),l.fillStyle="transparent",l.fillRect(0,0,a,a);var s={x:u.x-.5*i,y:u.y-.5*i};"Safari"===S&&(s.x=Math.max(s.x,0),s.y=Math.max(s.y,0)),s.x=Math.min(s.x,r.width),s.y=Math.min(s.y,r.height);var d={x:(r.width-s.x)*n,y:(r.height-s.y)*n};l.drawImage(r,s.x,s.y,r.width-s.x,r.height-s.y,0,0,d.x,d.y),t.style.top=u.y-.5*a+"px",t.style.left=u.x-.5*a+"px",t.style.display="block",document.body.style.cursor="none"}function c(e){if(0===C.default.$(e).find(".magnifyTool").length){var t=document.createElement("canvas");t.classList.add("magnifyTool");var o=k.getConfiguration();t.width=o.magnifySize,t.height=o.magnifySize,t.style.position="absolute",e.appendChild(t)}}function f(e){C.default.$(e).find(".magnifyTool").remove()}function g(e){C.default.$(e).off("CornerstoneToolsMouseDown",l),f(e)}function v(e){if(!S){var t=(0,b.getBrowserInfo)(),o=t.split(" ");S=o[0]}c(e)}function m(e,t){var o={mouseButtonMask:t};C.default.$(e).off("CornerstoneToolsMouseDown",l),C.default.$(e).on("CornerstoneToolsMouseDown",o,l),c(e)}function h(){return w}function p(e){w=e}Object.defineProperty(t,"__esModule",{value:!0}),t.magnifyTouchDrag=t.magnify=void 0;var T=o(0),C=a(T),y=o(12),M=a(y),b=o(22),x=o(2),P=a(x),w={magnifySize:100,magnificationLevel:2},S=void 0,I=void 0,k={enable:v,activate:m,deactivate:g,disable:g,getConfiguration:h,setConfiguration:p},$={fireOnTouchStart:!0,activateCallback:c,disableCallback:f},_=(0,M.default)(s,$);t.magnify=k,t.magnifyTouchDrag=_},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=u.default.cornerstone,o=t.getEnabledElement(e),a=t.metaData.get("imagePlaneModule",o.image.imageId);if(a&&a.rowCosines&&a.columnCosines){var n=d.default.getOrientationString(a.rowCosines),r=d.default.getOrientationString(a.columnCosines),l=d.default.invertOrientationString(n);return{top:d.default.invertOrientationString(r),bottom:r,left:l,right:n}}}function r(e){var t=u.default.cornerstone,o=t.getEnabledElement(e),a=void 0;a={x:o.image.width/2,y:5};var n=t.pixelToCanvas(e,a);a={x:o.image.width/2,y:o.image.height-5};var r=t.pixelToCanvas(e,a);a={x:5,y:o.image.height/2};var l=t.pixelToCanvas(e,a);return a={x:o.image.width-10,y:o.image.height/2},{top:n,bottom:r,left:l,right:t.pixelToCanvas(e,a)}}function l(e,t){var o=t.element,a=n(o);if(a){var l=r(o,a),i=t.canvasContext.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0);var u=v.default.getToolColor(),s={top:i.measureText(a.top).width,left:i.measureText(a.left).width,right:i.measureText(a.right).width,bottom:i.measureText(a.bottom).width};(0,h.default)(i,a.top,l.top.x-s.top/2,l.top.y,u),(0,h.default)(i,a.left,l.left.x-s.left/2,l.left.y,u);var d=p.getConfiguration();d&&d.drawAllMarkers&&((0,h.default)(i,a.right,l.right.x-s.right/2,l.right.y,u),(0,h.default)(i,a.bottom,l.bottom.x-s.bottom/2,l.bottom.y,u))}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=a(i),s=o(41),d=a(s),c=o(26),f=a(c),g=o(4),v=a(g),m=o(5),h=a(m),p=(0,f.default)(l);t.default=p},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){u.default.$(t.element).off("CornerstoneToolsMouseDrag",l),u.default.$(t.element).off("CornerstoneToolsMouseUp",n),u.default.$(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,v.default)(t.which,e.data.mouseButtonMask))return u.default.$(t.element).on("CornerstoneToolsMouseDrag",l),u.default.$(t.element).on("CornerstoneToolsMouseUp",n),u.default.$(t.element).on("CornerstoneToolsMouseClick",n),!1}function l(e,t){var o=t.viewport.scale,a=t.viewport.scale;return t.image.rowPixelSpacing<t.image.columnPixelSpacing?o*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(a*=t.image.rowPixelSpacing/t.image.columnPixelSpacing),t.viewport.translation.x+=t.deltaPoints.page.x/o,t.viewport.translation.y+=t.deltaPoints.page.y/a,u.default.cornerstone.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.panTouchDrag=t.pan=void 0;var i=o(0),u=a(i),s=o(13),d=a(s),c=o(12),f=a(c),g=o(2),v=a(g),m=(0,d.default)(r),h=(0,f.default)(l);t.pan=m,t.panTouchDrag=h},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=d.getConfiguration();if(o&&o.testPointers(t))return t.viewport.translation.x+=t.deltaPoints.page.x/t.viewport.scale,t.viewport.translation.y+=t.deltaPoints.page.y/t.viewport.scale,l.default.cornerstone.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),l=a(r),i=o(23),u=a(i),s={testPointers:function(e){return e.numPointers>=2}},d=(0,u.default)(n);d.setConfiguration(s),t.default=d},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function r(e,t,o){var a=s.default.cornerstone.pixelToCanvas(e,t.handles.end);return s.default.cornerstoneMath.point.distance(a,o)<5}function l(e,t){var o=(0,S.getToolState)(e.currentTarget,O);if(o){var a=s.default.cornerstone,n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var r=void 0,l=p.default.getFont(),i=p.default.getFontSize(),u=0;u<o.data.length;u++){n.save();var d=o.data[u];r=d.active?m.default.getActiveColor():m.default.getToolColor(),(0,C.default)(n,t,d.handles,r);var c=Math.round(d.handles.end.x),f=Math.round(d.handles.end.y),g=void 0,v=void 0,h=void 0;if(c<0||f<0||c>=t.image.columns||f>=t.image.rows)return;if(t.image.color)v=c+", "+f,g=(0,x.default)(t.element,c,f,1,1),h="R: "+g[0]+" G: "+g[1]+" B: "+g[2];else{g=a.getStoredPixels(t.element,c,f,1,1);var T=g[0],y=T*t.image.slope+t.image.intercept,b=(0,w.default)(t.image,T);v=c+", "+f,h="SP: "+T+" MO: "+parseFloat(y.toFixed(3)),b&&(h+=" SUV: "+parseFloat(b.toFixed(3)))}var P={x:d.handles.end.x+3,y:d.handles.end.y-3},I=a.pixelToCanvas(t.element,P);n.font=l,n.fillStyle=r,(0,M.default)(n,h,I.x,I.y+i+5,r),(0,M.default)(n,v,I.x,I.y,r),n.restore()}}}function i(e,t){var o=t.element,a=s.default.cornerstone,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,k.default)(t.which,e.data.mouseButtonMask)){var l=t.currentPoints.canvas,i=(0,S.getToolState)(o,O);if(i)for(var u=0;u<i.data.length;u++)if(n=i.data[u],r(o,n,l)||(0,_.default)(n.handles.textBox,l))return(0,S.removeToolState)(o,O,n),a.updateImage(o),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.probeTouch=t.probe=void 0;var u=o(0),s=a(u),d=o(8),c=a(d),f=o(11),g=a(f),v=o(4),m=a(v),h=o(16),p=a(h),T=o(9),C=a(T),y=o(5),M=a(y),b=o(34),x=a(b),P=o(19),w=a(P),S=o(1),I=o(2),k=a(I),$=o(10),_=a($),O="probe",D=(0,c.default)({mouseDoubleClickCallback:i,createNewMeasurement:n,onImageRendered:l,pointNearTool:r,toolType:O}),E=(0,g.default)({createNewMeasurement:n,onImageRendered:l,pointNearTool:r,toolType:O});t.probe=D,t.probeTouch=E},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function r(e,t,o){var a=c.default.cornerstone,n=a.pixelToCanvas(e,t.handles.start),r=a.pixelToCanvas(e,t.handles.end),l={left:Math.min(n.x,r.x),top:Math.min(n.y,r.y),width:Math.abs(n.x-r.x),height:Math.abs(n.y-r.y)};return c.default.cornerstoneMath.rect.distanceToPoint(l,o)<5}function l(e,t){for(var o=0,a=0,n=0,r=0,l=t.top;l<t.top+t.height;l++)for(var i=t.left;i<t.left+t.width;i++)o+=e[r],a+=e[r]*e[r],n++,r++;if(0===n)return{count:n,mean:0,variance:0,stdDev:0};var u=o/n,s=a/n-u*u;return{count:n,mean:u,variance:s,stdDev:Math.sqrt(s)}}function i(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function u(e,t){var o=(0,S.getToolState)(e.currentTarget,O);if(o){var a=c.default.cornerstone,n=t.image,r=t.element,u=p.default.getToolWidth(),s=D.getConfiguration(),d=t.canvasContext.canvas.getContext("2d"),f=a.metaData.get("generalSeriesModule",n.imageId),g=void 0;f&&(g=f.modality),d.setTransform(1,0,0,1,0,0);for(var v=0;v<o.data.length;v++){d.save();var m=o.data[v];s&&s.shadow&&(d.shadowColor=s.shadowColor||"#000000",d.shadowOffsetX=s.shadowOffsetX||1,d.shadowOffsetY=s.shadowOffsetY||1);var h=C.default.getColorIfActive(m.active),T=a.pixelToCanvas(r,m.handles.start),y=a.pixelToCanvas(r,m.handles.end),b=Math.min(T.x,y.x),P=Math.min(T.y,y.y),I=Math.abs(T.x-y.x),k=Math.abs(T.y-y.y);if(d.beginPath(),d.strokeStyle=h,d.lineWidth=u,d.rect(b,P,I,k),d.stroke(),s&&s.drawHandlesOnHover)if(!0===m.active)(0,M.default)(d,t,m.handles,h);else{var $={drawHandlesIfActive:!0};(0,M.default)(d,t,m.handles,h,$)}else(0,M.default)(d,t,m.handles,h);var _=void 0,E=void 0,j=void 0;if(!1===m.invalidated)E=m.meanStdDev,j=m.meanStdDevSUV,_=m.area;else{var A={left:Math.min(m.handles.start.x,m.handles.end.x),top:Math.min(m.handles.start.y,m.handles.end.y),width:Math.abs(m.handles.start.x-m.handles.end.x),height:Math.abs(m.handles.start.y-m.handles.end.y)};if(!n.color){E=l(a.getPixels(r,A.left,A.top,A.width,A.height),A),"PT"===g&&(j={mean:(0,w.default)(n,(E.mean-n.intercept)/n.slope),stdDev:(0,w.default)(n,(E.stdDev-n.intercept)/n.slope)}),E&&!isNaN(E.mean)&&(m.meanStdDev=E,m.meanStdDevSUV=j)}_=A.width*(n.columnPixelSpacing||1)*(A.height*(n.rowPixelSpacing||1)),isNaN(_)||(m.area=_),m.invalidated=!1}var L=[];if(E&&E.mean){var B="";"CT"===g&&(B=" HU");var R=": "+i(E.mean.toFixed(2))+B,H=": "+i(E.stdDev.toFixed(2))+B;if(j&&void 0!==j.mean){R+=" SUV: "+i(j.mean.toFixed(2)),H+=" SUV: "+i(j.stdDev.toFixed(2))}L.push(R),L.push(H)}if(_){var N=" mm"+String.fromCharCode(178);n.rowPixelSpacing&&n.columnPixelSpacing||(N=" pixels"+String.fromCharCode(178));var V=": "+i(_.toFixed(2))+N;L.push(V)}m.handles.textBox.hasMoved||(m.handles.textBox.x=Math.max(m.handles.start.x,m.handles.end.x),m.handles.textBox.y=(m.handles.start.y+m.handles.end.y)/2);var W=a.pixelToCanvas(r,m.handles.textBox),Y={centering:{x:!1,y:!0}},z=(0,x.default)(d,L,W.x,W.y,h,Y);if(m.handles.textBox.boundingBox=z,m.handles.textBox.hasMoved){var F={start:{},end:{x:W.x,y:W.y}},U=[{x:b+I/2,y:P},{x:b,y:P+k/2},{x:b+I/2,y:P+k},{x:b+I,y:P+k/2}];F.start=c.default.cornerstoneMath.point.findClosestPoint(U,F.end);var X=[{x:z.left+z.width/2,y:z.top},{x:z.left,y:z.top+z.height/2},{x:z.left+z.width/2,y:z.top+z.height},{x:z.left+z.width,y:z.top+z.height/2}];F.end=c.default.cornerstoneMath.point.findClosestPoint(X,F.start),d.beginPath(),d.strokeStyle=h,d.lineWidth=u,d.setLineDash([2,3]),d.moveTo(F.start.x,F.start.y),d.lineTo(F.end.x,F.end.y),d.stroke()}d.restore()}}}function s(e,t){var o=t.element,a=c.default.cornerstone,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,k.default)(t.which,e.data.mouseButtonMask)){var l=t.currentPoints.canvas,i=(0,S.getToolState)(o,O);if(i)for(var u=0;u<i.data.length;u++)if(n=i.data[u],r(o,n,l)||(0,_.default)(n.handles.textBox,l))return(0,S.removeToolState)(o,O,n),a.updateImage(o),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleRoiTouch=t.rectangleRoi=void 0;var d=o(0),c=a(d),f=o(8),g=a(f),v=o(11),m=a(v),h=o(6),p=a(h),T=o(4),C=a(T),y=o(9),M=a(y),b=o(5),x=a(b),P=o(19),w=a(P),S=o(1),I=o(2),k=a(I),$=o(10),_=a($),O="rectangleRoi",D=(0,g.default)({mouseDoubleClickCallback:s,createNewMeasurement:n,onImageRendered:u,pointNearTool:r,toolType:O}),E=(0,m.default)({createNewMeasurement:n,onImageRendered:u,pointNearTool:r,toolType:O});t.rectangleRoi=D,t.rectangleRoiTouch=E},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=e.element.getBoundingClientRect(e.element),o={x:e.currentPoints.client.x,y:e.currentPoints.client.y},a=e.element.clientWidth,n=e.element.clientHeight,r={x:o.x-t.left-a/2,y:-1*(o.y-t.top-n/2)},l=Math.atan2(r.y,r.x),i=l*(180/Math.PI),u=-1*i+90;e.viewport.rotation=u,c.default.cornerstone.setViewport(e.element,e.viewport)}function r(e){e.viewport.rotation+=e.deltaPoints.page.x/e.viewport.scale,c.default.cornerstone.setViewport(e.element,e.viewport)}function l(e){e.viewport.rotation+=e.deltaPoints.page.y/e.viewport.scale,c.default.cornerstone.setViewport(e.element,e.viewport)}function i(e,t){c.default.$(t.element).off("CornerstoneToolsMouseDrag",s),c.default.$(t.element).off("CornerstoneToolsMouseUp",i),c.default.$(t.element).off("CornerstoneToolsMouseClick",i)}function u(e,t){if((0,p.default)(t.which,e.data.mouseButtonMask))return c.default.$(t.element).on("CornerstoneToolsMouseDrag",s),c.default.$(t.element).on("CornerstoneToolsMouseUp",i),c.default.$(t.element).on("CornerstoneToolsMouseClick",i),!1}function s(e,t){return T.strategy(t),c.default.cornerstone.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.rotateTouchDrag=t.rotate=void 0;var d=o(0),c=a(d),f=o(13),g=a(f),v=o(12),m=a(v),h=o(2),p=a(h),T=(0,g.default)(u);T.strategies={default:n,horizontal:r,vertical:l},T.strategy=n;var C=(0,m.default)(s);t.rotate=T,t.rotateTouchDrag=C},function(e,t,o){"use strict";function a(e,t){return t.viewport.rotation+=t.rotation,i.default.cornerstone.setViewport(t.element,t.viewport),!1}function n(e){i.default.$(e).off("CornerstoneToolsTouchRotate",a)}function r(e){i.default.$(e).off("CornerstoneToolsTouchRotate",a),i.default.$(e).on("CornerstoneToolsTouchRotate",a)}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),i=function(e){return e&&e.__esModule?e:{default:e}}(l),u={activate:r,disable:n};t.default=u},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){o=o||"image/png";var a=n.default.$(e).find("canvas").get(0),r=document.createElement("a");if(r.download=t,r.href=a.toDataURL(o,1),document.createEvent){var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(l)}else r.fireEvent&&r.fireEvent("onclick")};var a=o(0),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){e(prompt("Enter your annotation:"))}function r(e,t,o){o(prompt("Change your annotation:"))}function l(e){function t(e){null===e?(0,H.removeToolState)(a,N,r):r.text=e,r.active=!1,o.updateImage(a)}var o=v.default.cornerstone,a=e.element,n=W.getConfiguration(),r=i(e);(0,H.addToolState)(a,N,r),o.updateImage(a),(0,_.default)(e,N,r,r.handles.end,function(){(0,k.default)(e,r.handles)&&(0,H.removeToolState)(a,N,r),void 0===r.text&&n.getTextCallback(t),o.updateImage(a)})}function i(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function u(e,t,o){if(t.handles.end){var a=v.default.cornerstone.pixelToCanvas(e,t.handles.end);return v.default.cornerstoneMath.point.distance(a,o)<25}}function s(e,t){var o=(0,H.getToolState)(e.currentTarget,N);if(o){var a=v.default.cornerstone,n=t.enabledElement,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var l=t.canvasContext.canvas.width,i=void 0,u=P.default.getToolWidth(),s=b.default.getFont(),d=W.getConfiguration(),c=0;c<o.data.length;c++){r.save(),d&&d.shadow&&(r.shadowColor=d.shadowColor||"#000000",r.shadowOffsetX=d.shadowOffsetX||1,r.shadowOffsetY=d.shadowOffsetY||1);var f=o.data[c];i=f.active?S.default.getActiveColor():S.default.getToolColor();var g=a.pixelToCanvas(t.element,f.handles.end);(0,j.default)(r,g,i,u);var m={drawHandlesIfActive:d&&d.drawHandlesOnHover};if(d.drawHandles&&(0,D.default)(r,t,g,i,m),f.text&&""!==f.text){r.font=s;var h="";h=d.showCoordinates?f.text+" x: "+Math.round(f.handles.end.x)+" y: "+Math.round(f.handles.end.y):f.text;var p=r.measureText(h).width+10,T=b.default.getFontSize()+10,C=Math.max(p,T)/2+5;g.x>l/2&&(C=-C);var M=void 0;if(!f.handles.textBox.hasMoved){M={x:g.x-p/2+C,y:g.y-T/2};var x=a.internal.getTransform(n);x.invert();var w=x.transformPoint(M.x,M.y);f.handles.textBox.x=w.x,f.handles.textBox.y=w.y}M=a.pixelToCanvas(t.element,f.handles.textBox);var I=(0,y.default)(r,h,M.x,M.y,i);if(f.handles.textBox.boundingBox=I,f.handles.textBox.hasMoved){var k={start:{},end:{}};k.end.x=M.x,k.end.y=M.y,k.start=g;var $=[{x:I.left+I.width/2,y:I.top},{x:I.left,y:I.top+I.height/2},{x:I.left+I.width/2,y:I.top+I.height},{x:I.left+I.width,y:I.top+I.height/2}];k.end=v.default.cornerstoneMath.point.findClosestPoint($,k.start),r.beginPath(),r.strokeStyle=i,r.lineWidth=u,r.setLineDash([2,3]),r.moveTo(k.start.x,k.start.y),r.lineTo(k.end.x,k.end.y),r.stroke()}}r.restore()}}}function d(e){function t(e){null===e?(0,H.removeToolState)(a,N,r):r.text=e,r.active=!1,o.updateImage(a)}var o=v.default.cornerstone,a=e.element,n=W.getConfiguration(),r=i(e);(0,H.addToolState)(a,N,r),o.updateImage(a),(0,_.default)(e,N,r,r.handles.end,function(){(0,k.default)(e,r.handles)&&(0,H.removeToolState)(a,N,r),void 0===r.text&&n.getTextCallback(t),o.updateImage(a)})}function c(e,t){function o(e,t,o){!0===o?(0,H.removeToolState)(n,N,e):e.text=t,e.active=!1,a.updateImage(n)}var a=v.default.cornerstone,n=t.element,r=void 0;if(!e.data||!e.data.mouseButtonMask||(0,L.default)(t.which,e.data.mouseButtonMask)){var l=W.getConfiguration(),i=t.currentPoints.canvas,s=(0,H.getToolState)(n,N);if(s){for(var d=0;d<s.data.length;d++)if(r=s.data[d],u(n,r,i)||(0,R.default)(r.handles.textBox,i))return r.active=!0,a.updateImage(n),l.changeTextCallback(r,t,o),e.stopImmediatePropagation(),!1;return!1}}}function f(e,t){function o(e,t,o){console.log("pressCallback doneChangingTextCallback"),!0===o?(0,H.removeToolState)(n,N,e):e.text=t,e.active=!1,a.updateImage(n),v.default.$(n).on("CornerstoneToolsTouchStart",Y.touchStartCallback),v.default.$(n).on("CornerstoneToolsTouchStartActive",Y.touchDownActivateCallback),v.default.$(n).on("CornerstoneToolsTap",Y.tapCallback)}var a=v.default.cornerstone,n=t.element,r=void 0;if(e.data&&e.data.mouseButtonMask&&!(0,L.default)(t.which,e.data.mouseButtonMask))return!1;var l=W.getConfiguration(),i=t.currentPoints.canvas,s=(0,H.getToolState)(n,N);if(!s)return!1;if(t.handlePressed)return v.default.$(n).off("CornerstoneToolsTouchStart",Y.touchStartCallback),v.default.$(n).off("CornerstoneToolsTouchStartActive",Y.touchDownActivateCallback),v.default.$(n).off("CornerstoneToolsTap",Y.tapCallback),l.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var d=0;d<s.data.length;d++)if(r=s.data[d],u(n,r,i)||(0,R.default)(r.handles.textBox,i))return r.active=!0,a.updateImage(n),v.default.$(n).off("CornerstoneToolsTouchStart",Y.touchStartCallback),v.default.$(n).off("CornerstoneToolsTouchStartActive",Y.touchDownActivateCallback),v.default.$(n).off("CornerstoneToolsTap",Y.tapCallback),l.changeTextCallback(r,t,o),e.stopImmediatePropagation(),!1;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.seedAnnotateTouch=t.seedAnnotate=void 0;var g=o(0),v=a(g),m=o(8),h=a(m),p=o(11),T=a(p),C=o(5),y=a(C),M=o(16),b=a(M),x=o(6),P=a(x),w=o(4),S=a(w),I=o(14),k=a(I),$=o(24),_=a($),O=o(9),D=a(O),E=o(52),j=a(E),A=o(2),L=a(A),B=o(10),R=a(B),H=o(1),N="seedAnnotate",V={getTextCallback:n,changeTextCallback:r,drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0},W=(0,h.default)({addNewMeasurement:l,createNewMeasurement:i,onImageRendered:s,pointNearTool:u,toolType:N,mouseDoubleClickCallback:c});W.setConfiguration(V);var Y=(0,T.default)({addNewMeasurement:d,createNewMeasurement:i,onImageRendered:s,pointNearTool:u,toolType:N,pressCallback:f});t.seedAnnotate=W,t.seedAnnotateTouch=Y},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function r(e,t,o){var a=f.default.cornerstone,n={start:a.pixelToCanvas(e,t.handles.start),end:a.pixelToCanvas(e,t.handles.middle)},r=f.default.cornerstoneMath.lineSegment.distanceToPoint(n,o);return r<25||(n.start=a.pixelToCanvas(e,t.handles.middle),n.end=a.pixelToCanvas(e,t.handles.end),(r=f.default.cornerstoneMath.lineSegment.distanceToPoint(n,o))<25)}function l(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function i(e,t){var o=(0,A.getToolState)(e.currentTarget,N);if(o){var a=f.default.cornerstone,n=t.enabledElement,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var i=void 0,u=b.default.getToolWidth(),s=y.default.getFont(),d=V.getConfiguration(),c=0;c<o.data.length;c++){r.save(),d&&d.shadow&&(r.shadowColor=d.shadowColor||"#000000",r.shadowOffsetX=d.shadowOffsetX||1,r.shadowOffsetY=d.shadowOffsetY||1);var g=o.data[c];i=g.active?P.default.getActiveColor():P.default.getToolColor();var v=a.pixelToCanvas(t.element,g.handles.start),m=a.pixelToCanvas(t.element,g.handles.middle),p=a.pixelToCanvas(t.element,g.handles.end);r.beginPath(),r.strokeStyle=i,r.lineWidth=u,r.moveTo(v.x,v.y),r.lineTo(m.x,m.y),r.lineTo(p.x,p.y),r.stroke();var C={drawHandlesIfActive:d&&d.drawHandlesOnHover};(0,D.default)(r,t,g.handles,i,C),r.fillStyle=i;var M=t.image.columnPixelSpacing||1,x=t.image.rowPixelSpacing||1,w="";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(w=" (isotropic)");var S={x:(Math.ceil(g.handles.middle.x)-Math.ceil(g.handles.start.x))*M,y:(Math.ceil(g.handles.middle.y)-Math.ceil(g.handles.start.y))*x},I={x:(Math.ceil(g.handles.end.x)-Math.ceil(g.handles.middle.x))*M,y:(Math.ceil(g.handles.end.y)-Math.ceil(g.handles.middle.y))*x},k={x:(Math.ceil(g.handles.end.x)-Math.ceil(g.handles.start.x))*M,y:(Math.ceil(g.handles.end.y)-Math.ceil(g.handles.start.y))*x},$=l(S),_=l(I),O=l(k),E=Math.acos((Math.pow($,2)+Math.pow(_,2)-Math.pow(O,2))/(2*$*_));E*=180/Math.PI;var j=(0,T.default)(E,2);if(j){var L=j.toString()+String.fromCharCode(parseInt("00B0",16))+w,B=void 0;if(g.handles.textBox.hasMoved)B=a.pixelToCanvas(t.element,g.handles.textBox);else{B={x:m.x,y:m.y},r.font=s;var R=r.measureText(L).width;m.x<v.x?B.x-=15+R+10:B.x+=15;var H=a.internal.getTransform(n);H.invert();var W=H.transformPoint(B.x,B.y);g.handles.textBox.x=W.x,g.handles.textBox.y=W.y}var Y={centering:{x:!1,y:!0}},z=(0,h.default)(r,L,B.x,B.y,i,Y);if(g.handles.textBox.boundingBox=z,g.handles.textBox.hasMoved){var F={start:{},end:{}},U=[v,p,m];F.end.x=B.x,F.end.y=B.y,F.start=f.default.cornerstoneMath.point.findClosestPoint(U,F.end);var X=[{x:z.left+z.width/2,y:z.top},{x:z.left,y:z.top+z.height/2},{x:z.left+z.width/2,y:z.top+z.height},{x:z.left+z.width,y:z.top+z.height/2}];F.end=f.default.cornerstoneMath.point.findClosestPoint(X,F.start),r.beginPath(),r.strokeStyle=i,r.lineWidth=u,r.setLineDash([2,3]),r.moveTo(F.start.x,F.start.y),r.lineTo(F.end.x,F.end.y),r.stroke()}}r.restore()}}}function u(e){var t=f.default.cornerstone,o=n(e),a=e.element,r={mouseButtonMask:e.which};(0,A.addToolState)(a,N,o),f.default.$(a).off("CornerstoneToolsMouseMove",V.mouseMoveCallback),f.default.$(a).off("CornerstoneToolsMouseDrag",V.mouseMoveCallback),f.default.$(a).off("CornerstoneToolsMouseDown",V.mouseDownCallback),f.default.$(a).off("CornerstoneToolsMouseDownActivate",V.mouseDownActivateCallback),t.updateImage(a),(0,k.default)(e,N,o,o.handles.middle,function(){if(o.active=!1,(0,S.default)(e,o.handles))return(0,A.removeToolState)(a,N,o),f.default.$(a).on("CornerstoneToolsMouseMove",V.mouseMoveCallback),f.default.$(a).on("CornerstoneToolsMouseDrag",V.mouseMoveCallback),f.default.$(a).on("CornerstoneToolsMouseDown",r,V.mouseDownCallback),f.default.$(a).on("CornerstoneToolsMouseDownActivate",r,V.mouseDownActivateCallback),void t.updateImage(a);o.handles.end.active=!0,t.updateImage(a),(0,k.default)(e,N,o,o.handles.end,function(){o.active=!1,(0,S.default)(e,o.handles)&&(0,A.removeToolState)(a,N,o),f.default.$(a).on("CornerstoneToolsMouseMove",V.mouseMoveCallback),f.default.$(a).on("CornerstoneToolsMouseDrag",V.mouseMoveCallback),f.default.$(a).on("CornerstoneToolsMouseDown",r,V.mouseDownCallback),f.default.$(a).on("CornerstoneToolsMouseDownActivate",r,V.mouseDownActivateCallback),t.updateImage(a)})})}function s(e){var t=f.default.cornerstone,o=n(e),a=e.element;(0,A.addToolState)(a,N,o),f.default.$(a).off("CornerstoneToolsTouchDrag",W.touchMoveCallback),f.default.$(a).off("CornerstoneToolsTouchStartActive",W.touchDownActivateCallback),f.default.$(a).off("CornerstoneToolsTouchStart",W.touchStartCallback),f.default.$(a).off("CornerstoneToolsTap",W.tapCallback),t.updateImage(a),(0,_.default)(e,N,o,o.handles.middle,function(){if((0,S.default)(e,o.handles))return(0,A.removeToolState)(a,N,o),f.default.$(a).on("CornerstoneToolsTouchDrag",W.touchMoveCallback),f.default.$(a).on("CornerstoneToolsTouchStart",W.touchStartCallback),f.default.$(a).on("CornerstoneToolsTouchStartActive",W.touchDownActivateCallback),f.default.$(a).on("CornerstoneToolsTap",W.tapCallback),void t.updateImage(a);(0,_.default)(e,N,o,o.handles.end,function(){(0,S.default)(e,o.handles)&&((0,A.removeToolState)(a,N,o),t.updateImage(a)),f.default.$(a).on("CornerstoneToolsTouchDrag",W.touchMoveCallback),f.default.$(a).on("CornerstoneToolsTouchStart",W.touchStartCallback),f.default.$(a).on("CornerstoneToolsTouchStartActive",W.touchDownActivateCallback),f.default.$(a).on("CornerstoneToolsTap",W.tapCallback)})})}function d(e,t){var o=t.element,a=f.default.cornerstone,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,B.default)(t.which,e.data.mouseButtonMask)){var l=t.currentPoints.canvas,i=(0,A.getToolState)(o,N);if(i)for(var u=0;u<i.data.length;u++)if(n=i.data[u],r(o,n,l)||(0,H.default)(n.handles.textBox,l))return(0,A.removeToolState)(o,N,n),a.updateImage(o),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAngleTouch=t.simpleAngle=void 0;var c=o(0),f=a(c),g=o(8),v=a(g),m=o(5),h=a(m),p=o(31),T=a(p),C=o(16),y=a(C),M=o(6),b=a(M),x=o(4),P=a(x),w=o(14),S=a(w),I=o(25),k=a(I),$=o(27),_=a($),O=o(9),D=a(O),E=o(11),j=a(E),A=o(1),L=o(2),B=a(L),R=o(10),H=a(R),N="simpleAngle",V=(0,v.default)({mouseDoubleClickCallback:d,createNewMeasurement:n,addNewMeasurement:u,onImageRendered:i,pointNearTool:r,toolType:N}),W=(0,j.default)({createNewMeasurement:n,addNewMeasurement:s,onImageRendered:i,pointNearTool:r,toolType:N});t.simpleAngle=V,t.simpleAngleTouch=W},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=w.getConfiguration();if(t.current){var o={visible:!0,active:!0,text:t.current,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},a={left:0,top:0,width:e.image.width,height:e.image.height};if(d.default.cornerstoneMath.point.insideRect(o.handles.end,a)){var n=t.markers.indexOf(t.current);return t.ascending?(n+=1)>=t.markers.length&&(t.loop?n-=t.markers.length:n=-1):(n-=1)<0&&(t.loop?n+=t.markers.length:n=-1),t.current=t.markers[n],o}}}function r(e,t,o){if(t.handles.end.boundingBox){var a=d.default.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,o),n=(0,h.default)(t.handles.end,o);return a<10||n}}function l(e,t){var o=(0,x.getToolState)(t.element,P);if(o){var a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var n=w.getConfiguration(),r=0;r<o.data.length;r++){var l=o.data[r],i=T.default.getToolColor();l.active&&(i=T.default.getActiveColor()),a.save(),n&&n.shadow&&(a.shadowColor=n.shadowColor||"#000000",a.shadowOffsetX=n.shadowOffsetX||1,a.shadowOffsetY=n.shadowOffsetY||1),a.fillStyle=i;var u=a.measureText(l.text);l.textWidth=u.width+10;var s=d.default.cornerstone.pixelToCanvas(t.element,l.handles.end),c={centering:{x:!0,y:!0}},f=(0,b.default)(a,l.text,s.x,s.y-10,i,c);l.handles.end.boundingBox=f,a.restore()}}}function i(e,t){function o(t,o,r){!0===r?(0,x.removeToolState)(n,P,t):t.text=o,t.active=!1,a.updateImage(n);var l={mouseButtonMask:e.data.mouseButtonMask};d.default.$(n).on("CornerstoneToolsMouseMove",l,w.mouseMoveCallback),d.default.$(n).on("CornerstoneToolsMouseDown",l,w.mouseDownCallback),d.default.$(n).on("CornerstoneToolsMouseDownActivate",l,w.mouseDownActivateCallback),d.default.$(n).on("CornerstoneToolsMouseDoubleClick",l,w.mouseDoubleClickCallback)}var a=d.default.cornerstone,n=t.element,l=void 0;if(!e.data||!e.data.mouseButtonMask||(0,y.default)(t.which,e.data.mouseButtonMask)){var i=w.getConfiguration(),u=t.currentPoints.canvas,s=(0,x.getToolState)(n,P);if(s){for(var c=0;c<s.data.length;c++)if(l=s.data[c],r(n,l,u))return l.active=!0,a.updateImage(n),d.default.$(n).off("CornerstoneToolsMouseMove",w.mouseMoveCallback),d.default.$(n).off("CornerstoneToolsMouseDown",w.mouseDownCallback),d.default.$(n).off("CornerstoneToolsMouseDownActivate",w.mouseDownActivateCallback),d.default.$(n).off("CornerstoneToolsMouseDoubleClick",w.mouseDoubleClickCallback),i.changeTextCallback(l,t,o),e.stopImmediatePropagation(),!1;return!1}}}function u(e,t){function o(e,t,o){!0===o?(0,x.removeToolState)(n,P,e):e.text=t,e.active=!1,a.updateImage(n),d.default.$(n).on("CornerstoneToolsTouchDrag",S.touchMoveCallback),d.default.$(n).on("CornerstoneToolsTouchStartActive",S.touchDownActivateCallback),d.default.$(n).on("CornerstoneToolsTouchStart",S.touchStartCallback),d.default.$(n).on("CornerstoneToolsTap",S.tapCallback),d.default.$(n).on("CornerstoneToolsTouchPress",S.pressCallback)}var a=d.default.cornerstone,n=t.element,l=void 0,i=w.getConfiguration(),u=t.currentPoints.canvas,s=(0,x.getToolState)(n,P);if(!s)return!1;if(t.handlePressed)return t.handlePressed.active=!0,a.updateImage(n),d.default.$(n).off("CornerstoneToolsTouchDrag",S.touchMoveCallback),d.default.$(n).off("CornerstoneToolsTouchStartActive",S.touchDownActivateCallback),d.default.$(n).off("CornerstoneToolsTouchStart",S.touchStartCallback),d.default.$(n).off("CornerstoneToolsTap",S.tapCallback),d.default.$(n).off("CornerstoneToolsTouchPress",S.pressCallback),i.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var c=0;c<s.data.length;c++)if(l=s.data[c],r(n,l,u))return l.active=!0,a.updateImage(n),d.default.$(n).off("CornerstoneToolsTouchDrag",S.touchMoveCallback),d.default.$(n).off("CornerstoneToolsTouchStartActive",S.touchDownActivateCallback),d.default.$(n).off("CornerstoneToolsTouchStart",S.touchStartCallback),d.default.$(n).off("CornerstoneToolsTap",S.tapCallback),d.default.$(n).off("CornerstoneToolsTouchPress",S.pressCallback),i.changeTextCallback(l,t,o),e.stopImmediatePropagation(),!1;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.textMarkerTouch=t.textMarker=void 0;var s=o(0),d=a(s),c=o(8),f=a(c),g=o(11),v=a(g),m=o(10),h=a(m),p=o(4),T=a(p),C=o(2),y=a(C),M=o(5),b=a(M),x=o(1),P="textMarker",w=(0,f.default)({createNewMeasurement:n,onImageRendered:l,pointNearTool:r,toolType:P,mouseDoubleClickCallback:i}),S=(0,v.default)({createNewMeasurement:n,onImageRendered:l,pointNearTool:r,toolType:P,pressCallback:u});t.textMarker=w,t.textMarkerTouch=S},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){d.default.$(t.element).off("CornerstoneToolsMouseDrag",i),d.default.$(t.element).off("CornerstoneToolsMouseUp",n),d.default.$(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,h.default)(t.which,e.data.mouseButtonMask))return d.default.$(t.element).on("CornerstoneToolsMouseDrag",i),d.default.$(t.element).on("CornerstoneToolsMouseUp",n),d.default.$(t.element).on("CornerstoneToolsMouseClick",n),!1}function l(e){var t=e.image.maxPixelValue*e.image.slope+e.image.intercept,o=e.image.minPixelValue*e.image.slope+e.image.intercept,a=t-o,n=a/1024,r=e.deltaPoints.page.x*n,l=e.deltaPoints.page.y*n;e.viewport.voi.windowWidth+=r,e.viewport.voi.windowCenter+=l}function i(e,t){return p.strategy(t),d.default.cornerstone.setViewport(t.element,t.viewport),!1}function u(e,t){e.stopImmediatePropagation();var o=t,a=o.image.maxPixelValue*o.image.slope+o.image.intercept,n=o.image.minPixelValue*o.image.slope+o.image.intercept,r=a-n,l=r/1024,i=o.deltaPoints.page.x*l,u=o.deltaPoints.page.y*l,s=p.getConfiguration();s.orientation?0===s.orientation?(o.viewport.voi.windowWidth+=i,o.viewport.voi.windowCenter+=u):(o.viewport.voi.windowWidth+=u,o.viewport.voi.windowCenter+=i):(o.viewport.voi.windowWidth+=i,o.viewport.voi.windowCenter+=u),d.default.cornerstone.setViewport(o.element,o.viewport)}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcTouchDrag=t.wwwc=void 0;var s=o(0),d=a(s),c=o(13),f=a(c),g=o(12),v=a(g),m=o(2),h=a(m),p=(0,f.default)(r);p.strategies={default:l},p.strategy=l;var T=(0,v.default)(u);t.wwwc=p,t.wwwcTouchDrag=T},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){var a=e.length;if(a<2)return{min:t,max:o,mean:(t+o)/2};for(var n=o,r=t,l=0,i=0;i<a;i++){var u=e[i];n=Math.min(n,u),r=Math.max(r,u),l+=u}return{min:n,max:r,mean:l/a}}function r(e){var t=e.detail,o=(0,w.getToolState)(t.element,_);o&&o.data&&(o.data=[]),y.default.$(t.element).off("CornerstoneToolsMouseMove",c),y.default.$(t.element).off("CornerstoneToolsMouseDrag",c),y.default.$(t.element).off("CornerstoneToolsMouseUp",l),y.default.$(t.element).off("CornerstoneToolsMouseClick",l);var a={mouseButtonMask:D};y.default.$(t.element).on("CornerstoneToolsMouseDown",a,s)}function l(e,t){y.default.$(t.element).off("CornerstoneToolsMouseMove",c),y.default.$(t.element).off("CornerstoneToolsMouseDrag",c),y.default.$(t.element).off("CornerstoneToolsMouseUp",l),y.default.$(t.element).off("CornerstoneToolsMouseClick",l);var o={mouseButtonMask:D};y.default.$(t.element).on("CornerstoneToolsMouseDown",o,s);var a=(0,w.getToolState)(t.element,_);a&&a.data&&a.data.length&&(a.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},i(t))}function i(e){var t=y.default.cornerstone,o=(0,w.getToolState)(e.element,_);if(o&&o.data&&o.data.length){var a=o.data[0].startPoint,r=o.data[0].endPoint,l=Math.abs(a.x-r.x),i=Math.abs(a.y-r.y),u=Math.min(a.x,r.x),s=Math.min(a.y,r.y);u=Math.max(u,0),u=Math.min(u,e.image.width),s=Math.max(s,0),s=Math.min(s,e.image.height),l=Math.floor(Math.min(l,Math.abs(e.image.width-u))),i=Math.floor(Math.min(i,Math.abs(e.image.height-s)));var d=(0,I.default)(e.element,u,s,l,i),c=n(d,e.image.minPixelValue,e.image.maxPixelValue),f=E.getConfiguration(),g=t.getViewport(e.element);void 0===f.minWindowWidth&&(f.minWindowWidth=10),g.voi.windowWidth=Math.max(Math.abs(c.max-c.min),f.minWindowWidth),g.voi.windowCenter=c.mean,t.setViewport(e.element,g),o.data=[],t.updateImage(e.element)}}function u(e,t){var o=t.element;y.default.$(o).off("CornerstoneToolsMouseMove"),y.default.$(o).off("CornerstoneToolsMouseDrag"),y.default.$(o).on("CornerstoneToolsMouseMove",c),y.default.$(o).on("CornerstoneToolsMouseDrag",c),y.default.$(o).on("CornerstoneToolsMouseClick",l),"CornerstoneToolsMouseDrag"===e.type&&y.default.$(o).on("CornerstoneToolsMouseUp",l)}function s(e,t){if((0,$.default)(t.which,e.data.mouseButtonMask))return y.default.$(t.element).on("CornerstoneToolsMouseDrag",t,u),y.default.$(t.element).on("CornerstoneToolsMouseMove",t,u),y.default.$(t.element).off("CornerstoneToolsMouseDown",s),d(t),!1}function d(e){var t=(0,w.getToolState)(e.element,_);t&&t.data&&(t.data=[]);var o={startPoint:{x:e.currentPoints.image.x,y:e.currentPoints.image.y}};(0,w.addToolState)(e.element,_,o)}function c(e,t){var o=(0,w.getToolState)(t.element,_);if(o&&o.data&&o.data.length){var a={x:t.currentPoints.image.x,y:t.currentPoints.image.y};o.data[0].endPoint=a,y.default.cornerstone.updateImage(t.element)}}function f(e){var t=e.detail,o=y.default.cornerstone,a=(0,w.getToolState)(t.element,_);if(a&&a.data&&a.data.length){var n=a.data[0].startPoint,r=a.data[0].endPoint;if(n&&r){var l=y.default.$(t.element).find("canvas").get(0),i=l.getContext("2d");i.setTransform(1,0,0,1,0,0);var u=P.default.getActiveColor(),s=o.pixelToCanvas(t.element,n),d=o.pixelToCanvas(t.element,r),c=Math.min(s.x,d.x),f=Math.min(s.y,d.y),g=Math.abs(s.x-d.x),v=Math.abs(s.y-d.y),m=b.default.getToolWidth(),h=E.getConfiguration();i.save(),h&&h.shadow&&(i.shadowColor=h.shadowColor||"#000000",i.shadowOffsetX=h.shadowOffsetX||1,i.shadowOffsetY=h.shadowOffsetY||1),i.beginPath(),i.strokeStyle=u,i.lineWidth=m,i.rect(c,f,g,v),i.stroke(),i.restore()}}}function g(e){y.default.$(e).off("CornerstoneToolsMouseDown",s),y.default.$(e).off("CornerstoneToolsMouseUp",l),y.default.$(e).off("CornerstoneToolsMouseClick",l),y.default.$(e).off("CornerstoneToolsMouseDrag",c),y.default.$(e).off("CornerstoneToolsMouseMove",c),e.removeEventListener("cornerstoneimagerendered",f),e.removeEventListener("cornerstonenewimage",r),y.default.cornerstone.updateImage(e)}function v(e,t){var o={mouseButtonMask:t};if(D=t,!(0,w.getToolState)(e,_)){var a=[];(0,w.addToolState)(e,_,a)}y.default.$(e).off("CornerstoneToolsMouseDown",s),y.default.$(e).off("CornerstoneToolsMouseUp",l),y.default.$(e).off("CornerstoneToolsMouseClick",l),y.default.$(e).off("CornerstoneToolsMouseDrag",c),y.default.$(e).off("CornerstoneToolsMouseMove",c),e.removeEventListener("cornerstoneimagerendered",f),e.removeEventListener("cornerstonenewimage",r),y.default.$(e).on("CornerstoneToolsMouseDown",o,s),e.addEventListener("cornerstoneimagerendered",f),e.addEventListener("cornerstonenewimage",r),y.default.cornerstone.updateImage(e)}function m(e){y.default.$(e).off("CornerstoneToolsTouchDrag",c),y.default.$(e).off("CornerstoneToolsTouchStart",d),y.default.$(e).off("CornerstoneToolsDragEnd",i),e.removeEventListener("cornerstoneimagerendered",f)}function h(e){if(!(0,w.getToolState)(e,_)){var t=[];(0,w.addToolState)(e,_,t)}y.default.$(e).off("CornerstoneToolsTouchDrag",c),y.default.$(e).off("CornerstoneToolsTouchStart",d),y.default.$(e).off("CornerstoneToolsDragEnd",i),e.removeEventListener("cornerstoneimagerendered",f),y.default.$(e).on("CornerstoneToolsTouchDrag",c),y.default.$(e).on("CornerstoneToolsTouchStart",d),y.default.$(e).on("CornerstoneToolsDragEnd",i),e.addEventListener("cornerstoneimagerendered",f)}function p(){return O}function T(e){O=e}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcRegionTouch=t.wwwcRegion=void 0;var C=o(0),y=a(C),M=o(6),b=a(M),x=o(4),P=a(x),w=o(1),S=o(50),I=a(S),k=o(2),$=a(k),_="wwwcRegion",O={minWindowWidth:10},D=void 0,E={activate:v,deactivate:g,disable:g,setConfiguration:T,getConfiguration:p},j={activate:h,deactivate:m,disable:m};t.wwwcRegion=E,t.wwwcRegionTouch=j},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=k.getConfiguration(),a=Math.log(e.scale)/Math.log(1.7),n=a+t,r=Math.pow(1.7,n);return o.maxScale&&r>o.maxScale?e.scale=o.maxScale:o.minScale&&r<o.minScale?e.scale=o.minScale:e.scale=r,e}function r(e,t,o){return e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),e.x=Math.min(e.x,t),e.y=Math.min(e.y,o),e}function l(e,t){if(t.hflip&&(e.x*=-1),t.vflip&&(e.y*=-1),0!==t.rotation){var o=t.rotation*Math.PI/180,a=Math.cos(o),n=Math.sin(o),r=e.x*a-e.y*n,l=e.x*n+e.y*a;e.x=r,e.y=l}return e}function i(e,t){var o=h.default.cornerstone,a=e.element,r=n(e.viewport,t);o.setViewport(a,r);var i=o.pageToPixel(a,e.startPoints.page.x,e.startPoints.page.y),u={x:e.startPoints.image.x-i.x,y:e.startPoints.image.y-i.y};u=l(u,r),r.translation.x-=u.x,r.translation.y-=u.y,o.setViewport(a,r)}function u(e,t){var o=e.element,a=e.image,i=k.getConfiguration(),u=n(e.viewport,t),s={x:0,y:0};if(t<0)u.scale<3&&(Math.abs(u.translation.x)<.01?u.translation.x=0:s.x=u.translation.x/8,Math.abs(u.translation.y)<.01?u.translation.y=0:s.y=u.translation.y/8);else{i&&i.preventZoomOutsideImage&&(I.image=r(I.image,a.width,a.height));var d={x:a.width/2-I.image.x,y:a.height/2-I.image.y};d=l(d,u);var c={x:u.translation.x-d.x,y:u.translation.y-d.y};Math.abs(c.x)<.01?u.translation.x=d.x:s.x=c.x/8,Math.abs(c.y)<.01?u.translation.y=d.y:s.y=c.y/8}u.translation.x-=s.x,u.translation.y-=s.y,h.default.cornerstone.setViewport(o,u)}function s(e,t){var o=e.element,a=n(e.viewport,t);h.default.cornerstone.setViewport(o,a)}function d(e,t){h.default.$(t.element).off("CornerstoneToolsMouseDrag",f),h.default.$(t.element).off("CornerstoneToolsMouseUp",d),h.default.$(t.element).off("CornerstoneToolsMouseClick",d)}function c(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask))return I=t.startPoints,h.default.$(t.element).on("CornerstoneToolsMouseDrag",f),h.default.$(t.element).on("CornerstoneToolsMouseUp",d),h.default.$(t.element).on("CornerstoneToolsMouseClick",d),!1}function f(e,t){if(!t.deltaPoints.page.y)return!1;var o=t.deltaPoints.page.y/100;return k.strategy(t,o),!1}function g(e,t){var o=-t.direction/4,a=k.getConfiguration();a&&a.invert&&(o*=-1);var r=n(t.viewport,o);h.default.cornerstone.setViewport(t.element,r)}function v(e,t){var o=h.default.cornerstone,a=k.getConfiguration(),n=t.viewport,r=t.element;n.scale+=t.scaleChange*n.scale,a.maxScale&&n.scale>a.maxScale?n.scale=a.maxScale:a.minScale&&n.scale<a.minScale&&(n.scale=a.minScale),o.setViewport(r,n);var i=o.pageToPixel(r,t.startPoints.page.x,t.startPoints.page.y),u={x:t.startPoints.image.x-i.x,y:t.startPoints.image.y-i.y};u=l(u,n),n.translation.x-=u.x,n.translation.y-=u.y,o.setViewport(r,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=void 0;var m=o(0),h=a(m),p=o(13),T=a(p),C=o(2),y=a(C),M=o(18),b=a(M),x=o(61),P=a(x),w=o(12),S=a(w),I=void 0,k=(0,T.default)(c);k.strategies={default:i,translate:u,zoomToCenter:s},k.strategy=i;var $=(0,b.default)(g),_=(0,P.default)(v),O=(0,S.default)(f);t.zoom=k,t.zoomWheel=$,t.zoomTouchPinch=_,t.zoomTouchDrag=O},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=b.getConfiguration(),o=e.element,a=c.default.cornerstone.getLayer(o,t.brushLayerId),n=a.image,r=n.rows,l=n.columns,i=e.currentPoints.image,u=i.x,s=i.y,d=(0,f.getToolState)(o,T),g=d.data[0].pixelData,v=t.draw,m=t.radius;if(!(u<0||u>l||s<0||s>r)){var C=(0,h.default)(m,r,l,u,s);(0,p.drawBrushPixels)(C,g,v,l),a.invalid=!0,c.default.cornerstone.updateImage(o)}}function r(e,t){y=t.currentPoints.image,M=!1}function l(e,t){n(t),M=!0,y=t.currentPoints.image}function i(e,t){y=t.currentPoints.image,c.default.cornerstone.updateImage(t.element)}function u(e,t){n(t),M=!0,y=t.currentPoints.image}function s(e,t){if(y){var o=t.image,a=o.rows,n=o.columns,r=y,l=r.x,i=r.y;if(!(l<0||l>n||i<0||i>a)){var u=b.getConfiguration(),s=u.radius,d=t.canvasContext,c=M?u.dragColor:u.hoverColor,f=t.element;d.setTransform(1,0,0,1,0,0);var g=(0,h.default)(s,a,n,l,i);(0,p.drawBrushOnCanvas)(g,d,c,f)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.brush=void 0;var d=o(0),c=a(d),f=o(1),g=o(62),v=a(g),m=o(63),h=a(m),p=o(64),T="brush",C={draw:1,radius:3,hoverColor:"green",dragColor:"yellow"},y=void 0,M=!1,b=(0,v.default)({onMouseMove:i,onMouseDown:l,onMouseUp:r,onDrag:u,toolType:"brush",onImageRendered:s});b.setConfiguration(C),t.brush=b},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){var a=k.getConfiguration(),n=a.tolerance,r=Number.MAX_VALUE,l=-Number.MAX_VALUE;e.forEach(function(e){var a=e[1]*o+e[0],n=t[a];r=Math.min(n,r),l=Math.max(n,l)}),w=r-n,P=l+n}function r(e,t,o,a){for(var n=k.getConfiguration(),r=n.draw,l=Math.round(x.x),i=Math.round(x.y),u=null,s=[],d=n.radius;0!==u&&d>n.minRadius;){u=0,s=(0,C.default)(d,o,a,l,i);for(var c=0;c<s.length;c++){var f=s[c][0],g=s[c][1],v=g*a+f,m=e[v];if(m>P||m<w){u++;break}}d--}return 0===u&&(0,y.drawBrushPixels)(s,t,r,a),d}function l(e){var t=k.getConfiguration(),o=e.element,a=v.default.cornerstone.getLayer(o,t.brushLayerId),n=v.default.cornerstone.getLayers(o)[0],l=a.image,i=l.rows,u=l.columns,s=(0,m.getToolState)(o,M),d=s.data[0];S=r(n.image.getPixelData(),d.pixelData,i,u),a.invalid=!0,v.default.cornerstone.updateImage(o)}function i(e){var t=k.getConfiguration(),o=e.element,a=v.default.cornerstone.getLayer(o,t.brushLayerId),n=a.image,r=n.rows,l=n.columns,i=e.currentPoints.image,u=i.x,s=i.y,d=(0,m.getToolState)(o,M),c=d.data[0].pixelData,f=t.draw,g=t.radius;if(!(u<0||u>l||s<0||s>r)){var h=(0,C.default)(g,r,l,u,s);(0,y.drawBrushPixels)(h,c,f,l),a.invalid=!0,v.default.cornerstone.updateImage(o)}}function u(e,t){x=t.currentPoints.image;var o=k.getConfiguration();I=!1,S=o.radius,v.default.cornerstone.updateImage(t.element)}function s(e,t){var o=t.element,a=k.getConfiguration(),r=v.default.cornerstone.getLayer(o,a.brushLayerId),u=v.default.cornerstone.getLayers(o)[0],s=t.currentPoints.image,d=s.x,c=s.y,f=r.image,g=f.rows,m=f.columns,h=(0,C.default)(a.radius,g,m,d,c);0===a.draw?i(t):(n(h,u.image.getPixelData(),m),l(t)),I=!0,x=t.currentPoints.image}function d(e,t){x=t.currentPoints.image,v.default.cornerstone.updateImage(t.element)}function c(e,t){0===b.draw?i(t):l(t),I=!0,x=t.currentPoints.image}function f(e,t){if(x){var o=t.image,a=o.rows,n=o.columns,r=x,l=r.x,i=r.y;if(!(l<0||l>n||i<0||i>a)){var u=k.getConfiguration(),s=t.canvasContext,d=I?u.dragColor:u.hoverColor,c=t.element;S=S||u.radius,s.setTransform(1,0,0,1,0,0);var f=(0,C.default)(S,a,n,l,i);(0,y.drawBrushOnCanvas)(f,s,d,c)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.adaptiveBrush=void 0;var g=o(0),v=a(g),m=o(1),h=o(62),p=a(h),T=o(63),C=a(T),y=o(64),M="brush",b={draw:1,radius:3,tolerance:5,minRadius:1,hoverColor:"green",dragColor:"yellow"},x=void 0,P=void 0,w=void 0,S=void 0,I=void 0,k=(0,p.default)({onMouseMove:d,onMouseDown:s,onMouseUp:u,onDrag:c,toolType:"adaptiveBrush",onImageRendered:f});k.setConfiguration(b),t.adaptiveBrush=k},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="1.1.3"}])});
//# sourceMappingURL=cornerstoneTools.min.js.map